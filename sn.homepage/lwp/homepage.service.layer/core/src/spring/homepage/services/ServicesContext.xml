<?xml version="1.0" encoding="UTF-8"?>
<!-- *****************************************************************
-->
<!--                                                                   -->
<!-- IBM Confidential                                                  -->
<!--                                                                   -->
<!-- OCO Source Materials                                              -->
<!--                                                                   -->
<!-- Copyright IBM Corp. 2002, 2015                                    -->
<!--                                                                   -->
<!-- The source code for this program is not published or otherwise    -->
<!-- divested of its trade secrets, irrespective of what has been      -->
<!-- deposited with the U.S. Copyright Office.                         -->
<!--                                                                   -->
<!-- *****************************************************************
-->
<beans xmlns="http://www.springframework.org/schema/beans"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xmlns:aop="http://www.springframework.org/schema/aop"
 xmlns:tx="http://www.springframework.org/schema/tx"
 xmlns:context="http://www.springframework.org/schema/context"
 xsi:schemaLocation="
 	http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.2.xsd 
 	http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.2.xsd 
 	http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.2.xsd 
 	http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.2.xsd">
    
    <import resource="classpath:spring/home-news/service/ServiceContext.xml"/>
    
    <!-- Transaction management. Allows to use @Transactional in our classes -->
    <!-- transactionManager is defined in the DAO layer (DatabaseIBatis.xml) -->
    <tx:annotation-driven transaction-manager="transactionManager"/>
    
    <!-- Permit @Autowiring -->
    <context:annotation-config /> 
    
    <!-- News EJB Factory -->
    <bean id="newsBeanFactory" class="com.ibm.lconn.homepage.services.utils.NewsBeanFactory" />    
    
    <!-- Model Converter -->
    <bean id="modelConverter" class="com.ibm.lconn.homepage.services.utils.impl.ModelConverterImpl">
        <property name="catalogServiceUIResourceBundle" ref="catalogServiceUIResourceBundle"/><!-- ref defined in ResourceBundleContext.xml in homepage.common/utils  -->
        <property name="serviceResourceBundle" ref="serviceResourceBundle"/><!-- ref defined in ResourceBundleContext.xml in homepage.common/utils  -->
        <!--  <property name="configurationService" ref="configurationService"/> -->
    </bean>

    <bean id="componentConfigurationCachingService" class="com.ibm.lconn.homepage.services.configuration.caching.impl.ComponentConfigurationCachingServiceImpl"/>
    
    <bean id="configurationService" class="com.ibm.lconn.homepage.services.impl.ConfigurationServiceImpl">
    	<property name="componentConfigurationCachingService" ref="componentConfigurationCachingService"/>
    </bean>
    
     <bean id="homepageMetricsService" class="com.ibm.lconn.homepage.services.mbean.admin.impl.HomepageMetricsService">
        <property name="systemMetrics" ref="systemMetrics"/>
        <property name="widgetCatalogService" ref="widgetCatalogServices" />
    </bean>

    <bean id="serverMetricsServices" class="com.ibm.lconn.homepage.services.impl.ServerMetricsServicesImpl">
        <property name="serviceResourceBundle" ref="serviceResourceBundle"/><!-- ref defined in ResourceBundleContext.xml in homepage.common/utils  -->
        <property name="serverMetricsCachingService" ref="serverMetricsCachingService"/>
		<property name="statisticsDao" ref="metricStatDao"/><!-- ref defined in DatabaseDao.xml in homepage.dao.layer/core  -->
		<property name="systemMetrics" ref="systemMetricsDao"/><!-- ref defined in DatabaseDao.xml in homepage.dao.layer/core  -->
    </bean>
    
      <!-- Waltz Sync Service -->
    
    <bean id="waltzSyncService" class="com.ibm.lconn.hpnews.service.waltz.impl.WaltzSyncService" parent="HPNEWS-SERVICE:waltzSyncService">
        <property name="personDao" ref="HPNEWS-DATABASE:personDao"/><!-- ref defined in DatabaseDao.xml in homepage.dao.layer/core  -->
        <property name="loginNameDao" ref="HPNEWS-DATABASE:loginNameDao"/><!-- ref defined in DatabaseDao.xml in homepage.dao.layer/core  -->
        <property name="dsProvider" ref="HPNEWS-SERVICE:dsProvider"/>
    </bean>
    
    <!-- User services -->
    <bean id="userServices" class="com.ibm.lconn.homepage.services.impl.UserServicesImpl">
        <property name="webResourceBundle" ref="webResourceBundle"/><!-- ref defined in ResourceBundleContext.xml in homepage.common/utils  -->
        <property name="serviceResourceBundle" ref="serviceResourceBundle"/><!-- ref defined in ResourceBundleContext.xml in homepage.common/utils  -->
        <property name="uiDao" ref="uiDao"/><!-- ref defined in DatabaseDao.xml in homepage.dao.layer/core  -->
        <property name="personDao" ref="HPNEWS-DATABASE:personDao"/><!-- ref defined in DatabaseDao.xml in homepage.dao.layer/core  -->
        <property name="waltzSyncService" ref="waltzSyncService"/>
        <property name="personService" ref="HPNEWS-SERVICE:personService"/>
        <property name="modelConverter" ref="modelConverter"/>
        <property name="tabInstDao" ref="tabInstDao"/>
        <property name="widgetInstDao" ref="widgetInstDao"/>
    </bean>
    
    <!-- Tab Services -->
    <bean id="tabServices" class="com.ibm.lconn.homepage.services.impl.TabServicesImpl">
        <property name="serviceResourceBundle" ref="serviceResourceBundle"/><!-- ref defined in ResourceBundleContext.xml in homepage.common/utils  -->
        <property name="uiServicesUtils" ref="uiServicesUtils"/><!-- ref defined in ResourceBundleContext.xml in homepage.common/utils  -->
        <property name="widgetLayoutServices" ref="widgetLayoutServices"/><!-- ref defined in ServicesContext.xml -->
        <property name="tabInstDao" ref="tabInstDao"/><!-- ref defined in DatabaseDao.xml in homepage.dao.layer/core  -->
        <property name="userServices" ref="userServices"/><!-- ref defined in DatabaseDao.xml in homepage.dao.layer/core  -->
        <property name="modelConverter" ref="modelConverter"/>
    </bean>
    
    <!-- Widget Services -->
    
    <!-- Get instance of REjb -->
    <bean id="widgetCatalogServices" 
    	  class="com.ibm.lconn.homepage.services.widget.WidgetServicesRemoteFactory" 
    	  factory-method="getWidgetCatalogService"/>
    <bean id="widgetLayoutServices" 
    	  class="com.ibm.lconn.homepage.services.widget.WidgetServicesRemoteFactory"
    	  factory-method="getWidgetLayoutService" />
    <!-- Get instance of REjb -->
    
    <bean id="deletedWidgetChecker" class="com.ibm.lconn.homepage.services.widget.impl.DeletedWidgetCheckerImpl">
    	<property name="widgetCatalogServices" ref="widgetCatalogServices"/>
    </bean> 
 
    <bean id="widgetServices" class="com.ibm.lconn.homepage.services.widget.impl.WidgetServicesImpl">
        <property name="catalogServiceUIResourceBundle" ref="catalogServiceUIResourceBundle"/><!-- ref defined in ResourceBundleContext.xml in homepage.common/utils  -->
        <property name="webResourceBundle" ref="webResourceBundle"/><!-- ref defined in ResourceBundleContext.xml in homepage.common/utils  -->
        <property name="tabServices" ref="tabServices"/><!-- ref defined in DatabaseDao.xml in homepage.dao.layer/core  -->
        <property name="widgetInstDao" ref="widgetInstDao"/><!-- ref defined in DatabaseDao.xml in homepage.dao.layer/core  -->
        <property name="modelConverter" ref="modelConverter"/>
        <property name="catalogService" ref="widgetCatalogServices"/>
    </bean>
        
    <!-- UI Services -->
    
    <!-- TODO: no transaction in UI Service in 2.5 - Was it itended? -->
    
    <bean id="uiServices" class="com.ibm.lconn.homepage.services.impl.UIServicesImpl">
        <property name="serviceResourceBundle" ref="serviceResourceBundle"/><!-- ref defined in ResourceBundleContext.xml in homepage.common/utils  -->
        <property name="personDao" ref="HPNEWS-DATABASE:personDao"/><!-- ref defined in DatabaseDao.xml in homepage.dao.layer/core  -->
        <property name="widgetInstDao" ref="widgetInstDao"/><!-- ref defined in DatabaseDao.xml in homepage.dao.layer/core  -->
        <property name="modelConverter" ref="modelConverter"/>
        <property name="configurationService" ref="configurationService" />
        <property name="catalogServiceUIResourceBundle" ref="catalogServiceUIResourceBundle" />
    </bean>
    
    <!-- Person Service MBEAN -->
    
    <bean id="homepagePersonService" class="com.ibm.lconn.homepage.services.mbean.admin.impl.HomepagePersonService">
        <property name="serviceResourceBundle" ref="serviceResourceBundle"/><!-- ref defined in ResourceBundleContext.xml in homepage.common/utils  -->
        <property name="personDao" ref="HPNEWS-DATABASE:personDao"/><!-- ref defined in DatabaseDao.xml in homepage.dao.layer/core  -->
        <property name="waltzSyncService" ref="HPNEWS-SERVICE:waltzSyncService"/>
        <property name="modelConverter" ref="modelConverter"/>
        <property name="uiDao" ref="uiDao"/><!-- ref defined in DatabaseDao.xml in homepage.dao.layer/core  -->
    </bean>
    
    <!-- MBean Facade -->    
    <bean id="homepageMBeanFacade" class="com.ibm.lconn.homepage.services.mbean.admin.impl.HomepageMBeanFacade">
        <property name="serviceResourceBundle" ref="serviceResourceBundle"/><!-- ref defined in ResourceBundleContext.xml in homepage.common/utils  -->
        <property name="mbeanExporter" ref="mbeanExporter"/>
    </bean>
    
    <!-- WAS Admin Service -->
    
    <bean id="wasAdminService" class="com.ibm.lconn.homepage.services.utils.impl.WASAdminServiceImpl"/>
    
    <bean id="systemMetrics" class="com.ibm.lconn.homepage.services.impl.SystemMetricsImpl">
        <property name="serverMetricsServices" ref="serverMetricsServices"/>
    </bean>
    
    <!-- Security Services -->
    <!-- No transaction in 2.5, might want to add some -->
    
    <bean id="securityServices" class="com.ibm.lconn.homepage.services.impl.SecurityServicesImpl">
        <property name="tabInstDao" ref="tabInstDao"/>
        <property name="widgetInstDao" ref="widgetInstDao"/>
        <property name="tabServices" ref="tabServices"/>
    </bean>
    
    <bean id="serverMetricsCachingService" class="com.ibm.lconn.homepage.services.impl.ServerMetricsCachingServiceImpl">
    </bean>
    
    <bean id="newsService" class="com.ibm.lconn.homepage.services.impl.NewsServiceImpl">
    	<property name="jspResourceBundle" ref="jspResourceBundle"/><!-- ref defined in ResourceBundleContext.xml in homepage.common/utils  -->
    	<property name="newsBeanFactory" ref="newsBeanFactory" />
    </bean>

  
    
    <!-- Helper for JSPs to access the users preference for "Show Getting Started..." -->
    <bean id="gettingStartedPreferenceHelper" class="com.ibm.lconn.homepage.services.helper.GettingStartedPreferenceHelper">
    	<property name="userServices" ref="userServices"/>
    </bean>
    
    <!-- Activity Stream Config Service -->
    <bean id="activityStreamConfigService" class="com.ibm.lconn.homepage.services.activitystream.config.impl.ConfigServiceImpl">
    	<property name="newsService" ref="newsService"/>
    	<property name="activityStreamConfigResourceBundle" ref="activityStreamConfigResourceBundle"/><!-- ref defined in ResourceBundleContext.xml in homepage.common/utils  -->
    </bean>
    
    <!-- Homepage ActionRequired Service -->
    <bean id="homepageActionRequiredService" class="com.ibm.lconn.homepage.services.impl.HomepageActionRequiredServiceImpl">
    	<property name="homepageActionRequiredDao" ref="homepageActionRequiredDao"/>
    </bean>
</beans>
