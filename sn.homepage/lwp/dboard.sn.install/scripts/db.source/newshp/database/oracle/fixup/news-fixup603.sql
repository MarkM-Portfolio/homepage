-- ***************************************************************** 
--                                                                   
-- IBM Confidential                                                  
--                                                                   
-- OCO Source Materials                                              
--                                                                   
-- Copyright IBM Corp. 2015                                   
--                                                                   
-- The source code for this program is not published or otherwise    
-- divested of its trade secrets, irrespective of what has been      
-- deposited with the U.S. Copyright Office.                         
--                                                                   
-- ***************************************************************** 

-- {COPYRIGHT}

-- SCEE

-----------------------------------------------------------------------
-- HOMEPAGE.L3T_ORGANIZATION table
-----------------------------------------------------------------------

CREATE TABLE HOMEPAGE.L3T_ORGANIZATION (
	ORGANIZATION_ID VARCHAR2(36) NOT NULL,
	ORGANIZATION_EXID VARCHAR2(36) NOT NULL
)TABLESPACE "NEWSREGTABSPACE";

ALTER TABLE HOMEPAGE.L3T_ORGANIZATION ADD (CONSTRAINT "PK_L3T_ORGANIZATION_ID" PRIMARY KEY("ORGANIZATION_ID") USING INDEX TABLESPACE "NEWSINDEXTABSPACE");
CREATE UNIQUE INDEX HOMEPAGE.UNQ_L3T_ORG_EXID ON HOMEPAGE.L3T_ORGANIZATION (ORGANIZATION_EXID) TABLESPACE "HOMEPAGEINDEXTABSPACE";

COMMIT;
-------------------------------------------------
-- HOMEPAGE.L3T_COMPANIES
-------------------------------------------------

CREATE TABLE HOMEPAGE.L3T_COMPANIES (
		COMPANY_ID VARCHAR2(36) NOT NULL,
		NAME VARCHAR2(128) NOT NULL,
		OPENID_ORG VARCHAR2(128) NOT NULL,
		LOTUSLIVE_INSTANCE VARCHAR2(5) NOT NULL,
		PACKAGEPREF_DEFAULT VARCHAR2(11) NOT NULL,
		CREATED TIMESTAMP NOT NULL,
		MODIFIED TIMESTAMP NOT NULL,
		ORGANIZATION_ID VARCHAR2(36) NOT NULL
)TABLESPACE "NEWSREGTABSPACE";

ALTER TABLE HOMEPAGE.L3T_COMPANIES ADD CONSTRAINT PK_COMPANY_ID PRIMARY KEY (COMPANY_ID);
ALTER TABLE HOMEPAGE.L3T_COMPANIES ADD CONSTRAINT FK_COM_ORG_ID FOREIGN KEY (ORGANIZATION_ID) REFERENCES HOMEPAGE.L3T_ORGANIZATION (ORGANIZATION_ID);
CREATE UNIQUE INDEX HOMEPAGE.UNQ_OPENID_ORG_IDX  ON HOMEPAGE.L3T_COMPANIES (OPENID_ORG) TABLESPACE "HOMEPAGEINDEXTABSPACE";

COMMIT;

-------------------------------------------------
-- HOMEPAGE.L3T_USERS
-------------------------------------------------
CREATE TABLE HOMEPAGE.L3T_USERS (
		USER_ID VARCHAR2(36) NOT NULL,
		NAME VARCHAR2(256) NOT NULL,
		OPENID_IDENTITY VARCHAR2(256) NOT NULL,
		EMAIL VARCHAR2(256) NOT NULL,
		COMPANY_ID VARCHAR2(36) NOT NULL,
		LOGGED_IN NUMBER(5,0) NOT NULL,
		LOGGED_IN_TIME TIMESTAMP NOT NULL,
		LANG VARCHAR2(6) NOT NULL,
		PACKAGEPREF_DEFAULT VARCHAR2(6) NOT NULL,
		LAST_AGREEMENT INTEGER DEFAULT 0 NOT NULL,
		CREATED TIMESTAMP NOT NULL,
		MODIFIED TIMESTAMP NOT NULL,
		ORGANIZATION_ID VARCHAR2(36) NOT NULL
)TABLESPACE "NEWSREGTABSPACE";

ALTER TABLE HOMEPAGE.L3T_USERS ADD CONSTRAINT PK_USERS_ID PRIMARY KEY (USER_ID);
CREATE UNIQUE INDEX HOMEPAGE.UNQ_OPENID_IDENTITY_IDX ON HOMEPAGE.L3T_USERS (OPENID_IDENTITY) TABLESPACE "HOMEPAGEINDEXTABSPACE";
ALTER TABLE HOMEPAGE.L3T_USERS ADD CONSTRAINT FK_USERS_COMPANY_ID FOREIGN KEY (COMPANY_ID) REFERENCES HOMEPAGE.L3T_COMPANIES (COMPANY_ID);
ALTER TABLE HOMEPAGE.L3T_USERS ADD CONSTRAINT FK_USERS_ORG_ID FOREIGN KEY (ORGANIZATION_ID) REFERENCES HOMEPAGE.L3T_ORGANIZATION (ORGANIZATION_ID);
CREATE INDEX HOMEPAGE.USERS_COMP_IDX ON HOMEPAGE.L3T_USERS (COMPANY_ID) TABLESPACE "HOMEPAGEINDEXTABSPACE";
CREATE INDEX HOMEPAGE.USERS_ORG_IDX ON HOMEPAGE.L3T_USERS (ORGANIZATION_ID) TABLESPACE "HOMEPAGEINDEXTABSPACE";

COMMIT;

-------------------------------------------------
-- HOMEPAGE.L3T_PACKAGES
-------------------------------------------------
CREATE TABLE HOMEPAGE.L3T_PACKAGES (
		PACKAGE_ID VARCHAR2(36) NOT NULL,
		NAME VARCHAR2(40) NOT NULL,
		ENTITLE_EVERYONE NUMBER(5,0) NOT NULL,
		OWNER_ID VARCHAR2(36) NOT NULL,
		TOKEN VARCHAR2(12),
		MAINT_MODE NUMBER(5,0) DEFAULT 1 NOT NULL ,
		CREATED TIMESTAMP NOT NULL,
		MODIFIED TIMESTAMP NOT NULL,
		ORGANIZATION_ID VARCHAR2(36) NOT NULL
)TABLESPACE "NEWSREGTABSPACE";

ALTER TABLE HOMEPAGE.L3T_PACKAGES ADD CONSTRAINT PK_PACKAGES_ID PRIMARY KEY (PACKAGE_ID);
ALTER TABLE HOMEPAGE.L3T_PACKAGES ADD CONSTRAINT FK_PACKAGES_OWNER_ID FOREIGN KEY (OWNER_ID) REFERENCES HOMEPAGE.L3T_USERS 	(USER_ID);
ALTER TABLE HOMEPAGE.L3T_PACKAGES ADD CONSTRAINT FK_PACKAGES_ORG_ID FOREIGN KEY (ORGANIZATION_ID) REFERENCES HOMEPAGE.L3T_ORGANIZATION (ORGANIZATION_ID);
CREATE INDEX HOMEPAGE.PKG_OWNER_IDX ON HOMEPAGE.L3T_PACKAGES (OWNER_ID) TABLESPACE "HOMEPAGEINDEXTABSPACE";
CREATE INDEX HOMEPAGE.PKG_ORG_IDX ON HOMEPAGE.L3T_PACKAGES (ORGANIZATION_ID) TABLESPACE "HOMEPAGEINDEXTABSPACE";

COMMIT;

-------------------------------------------------
-- HOMEPAGE.L3T_COMPANY_ENTITLEMENTS
-------------------------------------------------
CREATE TABLE HOMEPAGE.L3T_COMPANY_ENTITLEMENTS (
		COMPANY_ENTITLEMENTS_ID VARCHAR2(36) NOT NULL,
		COMPANY_ID VARCHAR2(36) NOT NULL,
		PACKAGE_ID VARCHAR2(36) NOT NULL,
		CREATED TIMESTAMP NOT NULL,
		MODIFIED TIMESTAMP NOT NULL,
		ORGANIZATION_ID VARCHAR2(36) NOT NULL
)TABLESPACE "NEWSREGTABSPACE";

ALTER TABLE HOMEPAGE.L3T_COMPANY_ENTITLEMENTS ADD CONSTRAINT PK_COMPANY_ENT_ID PRIMARY KEY (COMPANY_ENTITLEMENTS_ID);
CREATE UNIQUE INDEX HOMEPAGE.UNQ_COM_ENT_COM_PKG_IDX ON  HOMEPAGE.L3T_COMPANY_ENTITLEMENTS (COMPANY_ID, PACKAGE_ID) TABLESPACE "HOMEPAGEINDEXTABSPACE";
ALTER TABLE HOMEPAGE.L3T_COMPANY_ENTITLEMENTS ADD CONSTRAINT FK_COM_ENT_PKG_ID FOREIGN KEY (PACKAGE_ID) REFERENCES HOMEPAGE.L3T_PACKAGES (PACKAGE_ID);
ALTER TABLE HOMEPAGE.L3T_COMPANY_ENTITLEMENTS ADD CONSTRAINT FK_COM_ENT_COM_ID FOREIGN KEY (COMPANY_ID) REFERENCES HOMEPAGE.L3T_COMPANIES (COMPANY_ID);
ALTER TABLE HOMEPAGE.L3T_COMPANY_ENTITLEMENTS ADD CONSTRAINT FK_COM_ENT_ORG_ID FOREIGN KEY (ORGANIZATION_ID) REFERENCES HOMEPAGE.L3T_ORGANIZATION (ORGANIZATION_ID);
CREATE INDEX HOMEPAGE.COM_ENT_PKG_IDX ON HOMEPAGE.L3T_COMPANY_ENTITLEMENTS (PACKAGE_ID) TABLESPACE "HOMEPAGEINDEXTABSPACE";
CREATE INDEX HOMEPAGE.COM_ENT_COMP_IDX ON HOMEPAGE.L3T_COMPANY_ENTITLEMENTS (COMPANY_ID) TABLESPACE "HOMEPAGEINDEXTABSPACE";
CREATE INDEX HOMEPAGE.COM_ENT_ORG_IDX ON HOMEPAGE.L3T_COMPANY_ENTITLEMENTS (ORGANIZATION_ID) TABLESPACE "HOMEPAGEINDEXTABSPACE";


COMMIT;

-------------------------------------------------
-- HOMEPAGE.L3T_COMPANY_PKG_PREFS
-------------------------------------------------
CREATE TABLE HOMEPAGE.L3T_COMPANY_PKG_PREFS (
		COMPANY_PKG_PREFS_ID VARCHAR2(36) NOT NULL,
		COMPANY_ID VARCHAR2(36) NOT NULL,
		PACKAGE_ID VARCHAR2(36) NOT NULL,
		PREFERENCE VARCHAR2(11) NOT NULL,
		CREATED TIMESTAMP NOT NULL,
		MODIFIED TIMESTAMP NOT NULL,
		ORGANIZATION_ID VARCHAR2(36) NOT NULL
)TABLESPACE "NEWSREGTABSPACE";

ALTER TABLE HOMEPAGE.L3T_COMPANY_PKG_PREFS ADD CONSTRAINT PK_COMPANY_PKG_PREFS_ID PRIMARY KEY (COMPANY_PKG_PREFS_ID);
CREATE UNIQUE INDEX HOMEPAGE.UNQ_COM_PKG_PREF_IDX ON HOMEPAGE.L3T_COMPANY_PKG_PREFS  (COMPANY_ID, PACKAGE_ID) TABLESPACE "HOMEPAGEINDEXTABSPACE";
ALTER TABLE HOMEPAGE.L3T_COMPANY_PKG_PREFS ADD CONSTRAINT FK_COM_PKG_PREF_COM_ID FOREIGN KEY (COMPANY_ID) REFERENCES HOMEPAGE.L3T_COMPANIES (COMPANY_ID);
ALTER TABLE HOMEPAGE.L3T_COMPANY_PKG_PREFS ADD CONSTRAINT FK_COM_PKG_PREF_PKG_ID FOREIGN KEY (PACKAGE_ID) REFERENCES HOMEPAGE.L3T_PACKAGES (PACKAGE_ID);
ALTER TABLE HOMEPAGE.L3T_COMPANY_PKG_PREFS ADD CONSTRAINT FK_COM_PKG_PREF_ORG_ID FOREIGN KEY (ORGANIZATION_ID) REFERENCES HOMEPAGE.L3T_ORGANIZATION (ORGANIZATION_ID);
CREATE INDEX HOMEPAGE.COMP_PRF_PKG_IDX ON HOMEPAGE.L3T_COMPANY_PKG_PREFS (PACKAGE_ID) TABLESPACE "HOMEPAGEINDEXTABSPACE";
CREATE INDEX HOMEPAGE.COMP_PRF_COMP_IDX ON HOMEPAGE.L3T_COMPANY_PKG_PREFS (COMPANY_ID) TABLESPACE "HOMEPAGEINDEXTABSPACE";
CREATE INDEX HOMEPAGE.COMP_PRF_ORG_IDX ON HOMEPAGE.L3T_COMPANY_PKG_PREFS (ORGANIZATION_ID) TABLESPACE "HOMEPAGEINDEXTABSPACE";

COMMIT;

-------------------------------------------------
-- HOMEPAGE.L3T_EXT_META2
-------------------------------------------------
CREATE TABLE HOMEPAGE.L3T_EXT_META2 (
		EXT_META2_ID VARCHAR2(36) NOT NULL,
		UNID VARCHAR2(512) NOT NULL,
		OPENID_ORG VARCHAR2(512) NOT NULL,
		TYPE VARCHAR2(512) NOT NULL,
		PARENT VARCHAR2(36) NOT NULL,
		NODE_KEY VARCHAR2(256),
		NODE_VALUE VARCHAR2(512),
		ORGANIZATION_ID VARCHAR2(36) NOT NULL
)TABLESPACE "NEWSREGTABSPACE";

ALTER TABLE HOMEPAGE.L3T_EXT_META2 ADD CONSTRAINT PK_EXT_META2_ID PRIMARY KEY (EXT_META2_ID);
ALTER TABLE HOMEPAGE.L3T_EXT_META2 ADD CONSTRAINT FK_EXT_META2_ORG_ID FOREIGN KEY (ORGANIZATION_ID) REFERENCES HOMEPAGE.L3T_ORGANIZATION (ORGANIZATION_ID);
CREATE INDEX HOMEPAGE.EXT_META2_ORG_IDX ON HOMEPAGE.L3T_EXT_META2 (ORGANIZATION_ID) TABLESPACE "HOMEPAGEINDEXTABSPACE";

COMMIT;

-------------------------------------------------
-- HOMEPAGE.L3T_PACKAGE_DETAILS
-------------------------------------------------
CREATE TABLE HOMEPAGE.L3T_PACKAGE_DETAILS (
		PACKAGE_DETAILS_ID VARCHAR2(36) NOT NULL,
		PACKAGE_ID VARCHAR2(36) NOT NULL,
		POSITION_ID VARCHAR2(512) NOT NULL,
		WIDGET VARCHAR2(512) NOT NULL,
		LABS_ID VARCHAR2(512) NOT NULL,
		POSITION_TYPE VARCHAR2(10) NOT NULL,
		POSITION_INDEX INTEGER DEFAULT 0 NOT NULL,
		ORGANIZATION_ID VARCHAR2(36) NOT NULL
)TABLESPACE "NEWSREGTABSPACE";

ALTER TABLE HOMEPAGE.L3T_PACKAGE_DETAILS ADD CONSTRAINT PK_PACKAGE_DETAILS_ID PRIMARY KEY (PACKAGE_DETAILS_ID);
ALTER TABLE HOMEPAGE.L3T_PACKAGE_DETAILS ADD CONSTRAINT FK_PKG_DET_PKG_IDFOREIGN FOREIGN KEY (PACKAGE_ID) REFERENCES HOMEPAGE.L3T_PACKAGES (PACKAGE_ID);
ALTER TABLE HOMEPAGE.L3T_PACKAGE_DETAILS ADD CONSTRAINT FK_PKG_DET_PKG_ORG_ID FOREIGN KEY (ORGANIZATION_ID) REFERENCES HOMEPAGE.L3T_ORGANIZATION (ORGANIZATION_ID);
CREATE INDEX HOMEPAGE.PKG_DET_PKG_IDX ON HOMEPAGE.L3T_PACKAGE_DETAILS (PACKAGE_ID) TABLESPACE "HOMEPAGEINDEXTABSPACE";
CREATE INDEX HOMEPAGE.PKG_DET_ORG_IDX ON HOMEPAGE.L3T_PACKAGE_DETAILS (ORGANIZATION_ID) TABLESPACE "HOMEPAGEINDEXTABSPACE";

COMMIT;

-------------------------------------------------
-- HOMEPAGE.L3T_PACKAGE_LOCATION
-------------------------------------------------
CREATE TABLE HOMEPAGE.L3T_PACKAGE_LOCATION (
		PACKAGE_LOCATION_ID VARCHAR2(36) NOT NULL,
		POSITION_URL VARCHAR2(512) NOT NULL,
		LABS_ID VARCHAR2(512) NOT NULL,
		ORGANIZATION_ID VARCHAR2(36) NOT NULL
)TABLESPACE "NEWSREGTABSPACE";

ALTER TABLE HOMEPAGE.L3T_PACKAGE_LOCATION ADD CONSTRAINT PK_PACKAGE_LOCATION_ID PRIMARY KEY (PACKAGE_LOCATION_ID);
ALTER TABLE HOMEPAGE.L3T_PACKAGE_LOCATION ADD CONSTRAINT FK_PACKAGE_LOCATION_ORG_ID FOREIGN KEY (ORGANIZATION_ID) REFERENCES HOMEPAGE.L3T_ORGANIZATION (ORGANIZATION_ID);
CREATE INDEX HOMEPAGE.PKG_LOC_ORG_IDX ON HOMEPAGE.L3T_PACKAGE_LOCATION (ORGANIZATION_ID) TABLESPACE "HOMEPAGEINDEXTABSPACE";

COMMIT;

-------------------------------------------------
-- HOMEPAGE.L3T_USER_ENTITLEMENTS
-------------------------------------------------
CREATE TABLE HOMEPAGE.L3T_USER_ENTITLEMENTS (
		USER_ENTITLEMENTS_ID VARCHAR2(36) NOT NULL,
		PACKAGE_ID VARCHAR2(36) NOT NULL,
		USER_ID VARCHAR2(36) NOT NULL,
		CREATED TIMESTAMP NOT NULL,
		MODIFIED TIMESTAMP NOT NULL,
		ORGANIZATION_ID VARCHAR2(36) NOT NULL		
)TABLESPACE "NEWSREGTABSPACE";

ALTER TABLE HOMEPAGE.L3T_USER_ENTITLEMENTS ADD CONSTRAINT PK_USER_ENTITLEMENTS_ID PRIMARY KEY (USER_ENTITLEMENTS_ID);
CREATE UNIQUE INDEX HOMEPAGE.UNQ_USR_ENT_PKG_USR_IDX ON HOMEPAGE.L3T_USER_ENTITLEMENTS  (PACKAGE_ID,  USER_ID) TABLESPACE "HOMEPAGEINDEXTABSPACE";
ALTER TABLE HOMEPAGE.L3T_USER_ENTITLEMENTS ADD CONSTRAINT FK_USR_ENT_PGK_ID FOREIGN KEY (PACKAGE_ID) REFERENCES HOMEPAGE.L3T_PACKAGES 	(PACKAGE_ID);

COMMIT;
-------------------------------------------------
-- HOMEPAGE.L3T_USER_PKG_PREFS
-------------------------------------------------
CREATE TABLE HOMEPAGE.L3T_USER_PKG_PREFS (
		USER_PKG_PREFS_ID VARCHAR2(36) NOT NULL, 
		PACKAGE_ID VARCHAR2(36) NOT NULL,
		USER_ID VARCHAR2(36) NOT NULL,
		PREFERENCE VARCHAR2(9) NOT NULL,
		CREATED TIMESTAMP NOT NULL,
		MODIFIED TIMESTAMP NOT NULL,
		ORGANIZATION_ID VARCHAR2(36) NOT NULL
)TABLESPACE "NEWSREGTABSPACE";

ALTER TABLE HOMEPAGE.L3T_USER_PKG_PREFS ADD CONSTRAINT PK_USER_PKG_PREFS_ID PRIMARY KEY (USER_PKG_PREFS_ID);
CREATE UNIQUE INDEX  HOMEPAGE.USER_PKG_PREF_PKG_USR_IDX ON HOMEPAGE.L3T_USER_PKG_PREFS  (PACKAGE_ID, USER_ID) TABLESPACE "HOMEPAGEINDEXTABSPACE";
ALTER TABLE HOMEPAGE.L3T_USER_PKG_PREFS ADD CONSTRAINT FK_USR_PKG_PRF_PKG_ID FOREIGN KEY (PACKAGE_ID) REFERENCES HOMEPAGE.L3T_PACKAGES (PACKAGE_ID);
ALTER TABLE HOMEPAGE.L3T_USER_PKG_PREFS ADD CONSTRAINT FK_USR_PKG_PRF_ORG_ID FOREIGN KEY (ORGANIZATION_ID) REFERENCES HOMEPAGE.L3T_ORGANIZATION (ORGANIZATION_ID);
CREATE INDEX HOMEPAGE.USR_PGK_PFR_PKG_IDX ON HOMEPAGE.L3T_USER_PKG_PREFS (PACKAGE_ID) TABLESPACE "HOMEPAGEINDEXTABSPACE";
CREATE INDEX HOMEPAGE.USR_PKG_PRF_ORG_IDX ON HOMEPAGE.L3T_USER_PKG_PREFS (ORGANIZATION_ID) TABLESPACE "HOMEPAGEINDEXTABSPACE";

COMMIT;

