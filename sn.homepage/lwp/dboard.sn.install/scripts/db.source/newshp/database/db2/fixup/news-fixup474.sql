-- ***************************************************************** 
--                                                                   
-- IBM Confidential                                                  
--                                                                   
-- OCO Source Materials                                              
--                                                                   
-- Copyright IBM Corp. 2007, 2015                                    
--                                                                   
-- The source code for this program is not published or otherwise    
-- divested of its trade secrets, irrespective of what has been      
-- deposited with the U.S. Copyright Office.                         
--                                                                   
-- ***************************************************************** 

-- {COPYRIGHT}

CREATE INDEX HOMEPAGE.SRC_TYPE_ORG_ID
    ON HOMEPAGE.NR_SOURCE_TYPE (ORGANIZATION_ID, SOURCE_TYPE ASC)@
COMMIT@


DROP VIEW HOMEPAGE.NR_CATEGORIES_READERS@

--138576: Sev: 3 - PMR: 13339,999,000 - Days Opened: 8 - Dev Days Opened: 3 - Oracle DB issue
CREATE VIEW HOMEPAGE.NR_CATEGORIES_READERS AS (                         
    SELECT 
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, ROLLUP_ENTRY_ID, RESOURCE_TYPE, 
		CREATION_DATE, STORY_ID,  USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST, 
		ORGANIZATION_ID, ACTOR_UUID, IS_VISIBLE, ROLLUP_AUTHOR_ID, COMMUNITY_ID
    FROM HOMEPAGE.NR_RESPONSES_READERS                         
        UNION ALL                                                       
    SELECT 
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, ROLLUP_ENTRY_ID, RESOURCE_TYPE, 
		CREATION_DATE, STORY_ID,  USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST, 
		ORGANIZATION_ID, ACTOR_UUID, IS_VISIBLE, ROLLUP_AUTHOR_ID, COMMUNITY_ID
    FROM HOMEPAGE.NR_PROFILES_READERS                          
        UNION ALL                                                       
    SELECT 
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, ROLLUP_ENTRY_ID, RESOURCE_TYPE, 
		CREATION_DATE, STORY_ID,  USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST, 
		ORGANIZATION_ID, ACTOR_UUID, IS_VISIBLE, ROLLUP_AUTHOR_ID, COMMUNITY_ID
    FROM HOMEPAGE.NR_COMMUNITIES_READERS                       
        UNION ALL                                                       
    SELECT 
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, ROLLUP_ENTRY_ID, RESOURCE_TYPE, 
		CREATION_DATE, STORY_ID,  USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST, 
		ORGANIZATION_ID, ACTOR_UUID, IS_VISIBLE, ROLLUP_AUTHOR_ID, COMMUNITY_ID
    FROM HOMEPAGE.NR_ACTIVITIES_READERS                        
        UNION ALL                                                       
    SELECT 
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, ROLLUP_ENTRY_ID, RESOURCE_TYPE, 
		CREATION_DATE, STORY_ID,  USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST, 
		ORGANIZATION_ID, ACTOR_UUID, IS_VISIBLE, ROLLUP_AUTHOR_ID, COMMUNITY_ID
    FROM HOMEPAGE.NR_BLOGS_READERS                             
        UNION ALL                                                       
    SELECT 
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, ROLLUP_ENTRY_ID, RESOURCE_TYPE, 
		CREATION_DATE, STORY_ID,  USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST, 
		ORGANIZATION_ID, ACTOR_UUID, IS_VISIBLE, ROLLUP_AUTHOR_ID, COMMUNITY_ID
    FROM HOMEPAGE.NR_BOOKMARKS_READERS                         
        UNION ALL                                                       
    SELECT 
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, ROLLUP_ENTRY_ID, RESOURCE_TYPE, 
		CREATION_DATE, STORY_ID,  USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST, 
		ORGANIZATION_ID, ACTOR_UUID, IS_VISIBLE, ROLLUP_AUTHOR_ID, COMMUNITY_ID
    FROM HOMEPAGE.NR_FILES_READERS                             
        UNION ALL                                                       
    SELECT 
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, ROLLUP_ENTRY_ID, RESOURCE_TYPE, 
		CREATION_DATE, STORY_ID,  USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST, 
		ORGANIZATION_ID, ACTOR_UUID, IS_VISIBLE, ROLLUP_AUTHOR_ID, COMMUNITY_ID
    FROM HOMEPAGE.NR_FORUMS_READERS                            
        UNION ALL                                                       
    SELECT 
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, ROLLUP_ENTRY_ID, RESOURCE_TYPE, 
		CREATION_DATE, STORY_ID,  USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST, 
		ORGANIZATION_ID, ACTOR_UUID, IS_VISIBLE, ROLLUP_AUTHOR_ID, COMMUNITY_ID
    FROM HOMEPAGE.NR_WIKIS_READERS                             
        UNION ALL                                                       
    SELECT 
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, ROLLUP_ENTRY_ID, RESOURCE_TYPE, 
		CREATION_DATE, STORY_ID,  USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST, 
		ORGANIZATION_ID, ACTOR_UUID, IS_VISIBLE, ROLLUP_AUTHOR_ID, COMMUNITY_ID
    FROM HOMEPAGE.NR_TAGS_READERS                              
        UNION ALL                                                       
    SELECT 
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, ROLLUP_ENTRY_ID, RESOURCE_TYPE, 
		CREATION_DATE, STORY_ID,  USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST, 
		ORGANIZATION_ID, ACTOR_UUID, IS_VISIBLE, ROLLUP_AUTHOR_ID, COMMUNITY_ID
    FROM HOMEPAGE.NR_STATUS_UPDATE_READERS                     
        UNION ALL                                                       
    SELECT 
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, ROLLUP_ENTRY_ID, RESOURCE_TYPE, 
		CREATION_DATE, STORY_ID,  USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST, 
		ORGANIZATION_ID, ACTOR_UUID, IS_VISIBLE, ROLLUP_AUTHOR_ID, COMMUNITY_ID
    FROM HOMEPAGE.NR_EXTERNAL_READERS                          
)@

-- 121185: [fixup474.sql & fixup474s.sql ] Index refactoring for use of HOMEPAGE.NR_STORIES
DROP INDEX HOMEPAGE.STORIES_ITEM_CORR_ID@
COMMIT@

DROP INDEX HOMEPAGE.STORIES_ITEM_ENTRY_CORR_ID@
COMMIT@

CREATE INDEX HOMEPAGE.STORIES_ITEM_CORR_ID
    ON HOMEPAGE.NR_STORIES (ITEM_CORRELATION_ID, ORGANIZATION_ID)@
COMMIT@
    
CREATE INDEX HOMEPAGE.STORIES_ITEM_ENTRY_CORR_ID
    ON HOMEPAGE.NR_STORIES (ENTRY_CORRELATION_ID, ORGANIZATION_ID)@   
COMMIT@

