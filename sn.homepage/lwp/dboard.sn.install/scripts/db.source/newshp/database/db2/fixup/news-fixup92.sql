-- ***************************************************************** 
--                                                                   
-- IBM Confidential                                                  
--                                                                   
-- OCO Source Materials                                              
--                                                                   
-- Copyright IBM Corp. 2007, 2015                                    
--                                                                   
-- The source code for this program is not published or otherwise    
-- divested of its trade secrets, irrespective of what has been      
-- deposited with the U.S. Copyright Office.                         
--                                                                   
-- ***************************************************************** 

-- {COPYRIGHT}

----------------------------------------------------------------
-- [START] Changing definition for SOURCE_TYPE table
----------------------------------------------------------------
DROP TABLE HOMEPAGE.NR_SOURCE_TYPE;

CREATE TABLE HOMEPAGE.NR_SOURCE_TYPE (
	SOURCE_TYPE_ID VARCHAR(36) NOT NULL,
	SOURCE_TYPE SMALLINT NOT NULL, -- numeric that is 1,2,3 etc.. 100, 101..
	EXTERNAL_ID VARCHAR(256) NOT NULL,
	DISPLAY_NAME VARCHAR(4000),
	IMAGE_URL VARCHAR(2048),
	PUBLISHED TIMESTAMP,
	UPDATED VARCHAR(256),	
	IS_ENABLED SMALLINT,
	SUMMARY VARCHAR (4000)
)	
IN NEWS32TABSPACE;

ALTER TABLE HOMEPAGE.NR_SOURCE_TYPE 
  	ADD CONSTRAINT PK_SRC_TYPE_ID PRIMARY KEY(SOURCE_TYPE_ID);

ALTER TABLE HOMEPAGE.NR_SOURCE_TYPE 
	ADD CONSTRAINT SRC_TYPE_UNQ UNIQUE(SOURCE_TYPE);

ALTER TABLE HOMEPAGE.NR_SOURCE_TYPE 
	ADD CONSTRAINT SRC_EXT_ID_UNQ UNIQUE(EXTERNAL_ID);
	
COMMIT;	
	
-- Update also the init data 

INSERT INTO HOMEPAGE.NR_SOURCE_TYPE (SOURCE_TYPE_ID, SOURCE_TYPE, EXTERNAL_ID, DISPLAY_NAME, IMAGE_URL, PUBLISHED, UPDATED, IS_ENABLED, SUMMARY)
VALUES ('activities_c9cax4cc4x80bx51af2ddef2c', 1, 'int_activities_id', 'activities', null, null, null, 1, null);

INSERT INTO HOMEPAGE.NR_SOURCE_TYPE (SOURCE_TYPE_ID, SOURCE_TYPE, EXTERNAL_ID, DISPLAY_NAME, IMAGE_URL, PUBLISHED, UPDATED, IS_ENABLED, SUMMARY)
VALUES ('blogs_c9cax4cc4x80bx51af2ddef2c', 2, 'int_blogs_id', 'blogs', null, null, null, 1, null);

INSERT INTO HOMEPAGE.NR_SOURCE_TYPE (SOURCE_TYPE_ID, SOURCE_TYPE, EXTERNAL_ID, DISPLAY_NAME, IMAGE_URL, PUBLISHED, UPDATED, IS_ENABLED, SUMMARY)
VALUES ('communities_c9cax4cc4x80bx51af2d', 3, 'int_communities_id', 'communities', null, null, null, 1, null);

INSERT INTO HOMEPAGE.NR_SOURCE_TYPE (SOURCE_TYPE_ID, SOURCE_TYPE, EXTERNAL_ID, DISPLAY_NAME, IMAGE_URL, PUBLISHED, UPDATED, IS_ENABLED, SUMMARY)
VALUES ('wikis_c9cax4cc4x80bx51af2ddef2c', 4, 'int_wikis_id', 'wikis', null, null, null, 1, null);

INSERT INTO HOMEPAGE.NR_SOURCE_TYPE (SOURCE_TYPE_ID, SOURCE_TYPE, EXTERNAL_ID, DISPLAY_NAME, IMAGE_URL, PUBLISHED, UPDATED, IS_ENABLED, SUMMARY)
VALUES ('profiles_c9cax4cc4x80bx51af2ddef2c', 5, 'int_profiles_id', 'profiles', null, null, null, 1, null);

INSERT INTO HOMEPAGE.NR_SOURCE_TYPE (SOURCE_TYPE_ID, SOURCE_TYPE, EXTERNAL_ID, DISPLAY_NAME, IMAGE_URL, PUBLISHED, UPDATED, IS_ENABLED, SUMMARY)
VALUES ('homepage_c9cax4cc4x80bx51af2ddef2c', 6, 'int_homepage_id', 'homepage', null, null, null, 1, null);

INSERT INTO HOMEPAGE.NR_SOURCE_TYPE (SOURCE_TYPE_ID, SOURCE_TYPE, EXTERNAL_ID, DISPLAY_NAME, IMAGE_URL, PUBLISHED, UPDATED, IS_ENABLED, SUMMARY)
VALUES ('dogear_c9cax4cc4x80bx51af2ddef2c', 7, 'int_dogear_id', 'dogear', null, null, null, 1, null);

INSERT INTO HOMEPAGE.NR_SOURCE_TYPE (SOURCE_TYPE_ID, SOURCE_TYPE, EXTERNAL_ID, DISPLAY_NAME, IMAGE_URL, PUBLISHED, UPDATED, IS_ENABLED, SUMMARY)
VALUES ('files_c9cax4cc4x80bx51af2ddef2c', 8, 'int_files_id', 'files', null, null, null, 1, null);

INSERT INTO HOMEPAGE.NR_SOURCE_TYPE (SOURCE_TYPE_ID, SOURCE_TYPE, EXTERNAL_ID, DISPLAY_NAME, IMAGE_URL, PUBLISHED, UPDATED, IS_ENABLED, SUMMARY)
VALUES ('forums_c9cax4cc4x80bx51af2ddef2c', 9, 'int_forums_id', 'forums', null, null, null, 1, null);
	
COMMIT;

----------------------------------------------------------------
-- [END] Changing definition for SOURCE_TYPE table
----------------------------------------------------------------	

------------------------------------------------------
-- [START] Adding indexes to the readers tables
------------------------------------------------------

--DISCOVERY VIEW READERS:
CREATE INDEX HOMEPAGE.DISCOVERY_STORIES_SRC_IDX
    ON HOMEPAGE.NR_DISCOVERY_VIEW (READER_ID, CREATION_DATE DESC, SOURCE_TYPE);
COMMIT;

CREATE INDEX HOMEPAGE.DISCOVERY_STORIES_COM_IDX
    ON HOMEPAGE.NR_DISCOVERY_VIEW (READER_ID, CREATION_DATE DESC, IS_STORY_COMM);
COMMIT;

--EXTERNAL READERS
CREATE INDEX HOMEPAGE.EXT_STORIES_SRC_IDX
    ON HOMEPAGE.NR_EXTERNAL_READERS (READER_ID, CREATION_DATE DESC, SOURCE_TYPE);
COMMIT;

--RESPONSES READERS
CREATE INDEX HOMEPAGE.RESPONSES_STORIES_SRC_IDX
    ON HOMEPAGE.NR_RESPONSES_READERS (READER_ID, CREATION_DATE DESC, SOURCE_TYPE);
COMMIT;

--ACTIONABLE READERS
CREATE INDEX HOMEPAGE.ACTION_STORIES_SRC_IDX
    ON HOMEPAGE.NR_ACTIONABLE_READERS (READER_ID, CREATION_DATE DESC, SOURCE_TYPE);
COMMIT;

------------------------------------------------------
-- [END] Adding indexes to the readers tables
-----------------------------------------------------

------------------------------------------
-- Dropping HOMEPAGE.BOARD_READERS
-------------------------------------------
DROP TABLE HOMEPAGE.BOARD_READERS;
COMMIT;

----------------------------------------------------------------------------------------------
-- [START] This is a list of indexes to speed up seedlist performance and profiles API
----------------------------------------------------------------------------------------------

-----------------------
-- BOARD_ENTRIES
-----------------------
DROP INDEX HOMEPAGE.NEWS_BRD_UPDATE;
COMMIT;
DROP INDEX HOMEPAGE.NEWS_BRD_ITEM;
COMMIT;

CREATE UNIQUE INDEX HOMEPAGE.ITEM_ID_IDX
   ON HOMEPAGE.BOARD_ENTRIES (ITEM_ID ASC) INCLUDE (CONTAINER_ID);
COMMIT;

CREATE INDEX HOMEPAGE.CREATION_ITEM_IDX 
	ON HOMEPAGE.BOARD_ENTRIES (CREATION_DATE DESC, ITEM_ID DESC);
COMMIT;
   
---------------------
-- BOARD_COMMENTS
---------------------
CREATE INDEX HOMEPAGE.CREATION_DATE_IDX 
	ON HOMEPAGE.BOARD_COMMENTS (CREATION_DATE ASC);

COMMIT;

CREATE INDEX HOMEPAGE.ITEM_CORR_CREATION_IDX 
	ON HOMEPAGE.BOARD_COMMENTS (ITEM_CORRELATION_ID, CREATION_DATE ASC);

COMMIT;

CREATE INDEX HOMEPAGE.ITEM_ITEM_CORR_IDX
	ON HOMEPAGE.BOARD_COMMENTS (ITEM_ID ASC, ITEM_CORRELATION_ID ASC);
   
----------------------
-- NR_NETWORK
----------------------
CREATE INDEX HOMEPAGE.COLL_PERSON_IDX 
	ON HOMEPAGE.NR_NETWORK (COLLEAGUE_ID, PERSON_ID);

COMMIT;

----------------------------------------------------------------------------------------------
-- [END] This is a list of indexes to speed up seedlist performance and profiles API
----------------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------

-------------------------------------------------------
-- 1) HOMEPAGE.BOARD
-------------------------------------------------------
CREATE TABLE HOMEPAGE.BOARD  (
	BOARD_ID VARCHAR(256) NOT NULL,
	BOARD_CONTAINER_ID VARCHAR(256) NOT NULL,
	BOARD_TYPE VARCHAR(64) NOT NULL,
	BOARD_OWNER_ASSOC_ID VARCHAR(36) NOT NULL,
	BOARD_OWNER_ASSOC_TYPE VARCHAR(64) NOT NULL,
	CREATED TIMESTAMP NOT NULL,
	CREATED_BY VARCHAR(36) NOT NULL,
	LASTUPDATE TIMESTAMP NOT NULL,
	LASTUPDATE_BY VARCHAR(36) NOT NULL,
	IS_ENABLED SMALLINT DEFAULT 1 NOT NULL,
	VISIBILITY VARCHAR(36),
	EDITABILITY VARCHAR(36)	
)
IN BOARD16TABSPACE;

ALTER TABLE HOMEPAGE.BOARD 
	ADD CONSTRAINT BOARD_PK PRIMARY KEY (BOARD_ID); 

ALTER TABLE HOMEPAGE.BOARD 
	ADD CONSTRAINT FK_BRD_OWNER FOREIGN KEY (BOARD_OWNER_ASSOC_ID) 
	REFERENCES HOMEPAGE.PERSON (PERSON_ID);

ALTER TABLE HOMEPAGE.BOARD 
	ADD CONSTRAINT FK_BRD_CREATED FOREIGN KEY (CREATED_BY) 
	REFERENCES HOMEPAGE.PERSON (PERSON_ID);	

ALTER TABLE HOMEPAGE.BOARD 
	ADD CONSTRAINT FK_BRD_LASTUPDATE FOREIGN KEY (LASTUPDATE_BY) 
	REFERENCES HOMEPAGE.PERSON (PERSON_ID);

CREATE UNIQUE INDEX HOMEPAGE.BOARD_OWNER_ASSOC_UIDX 
	ON HOMEPAGE.BOARD (BOARD_OWNER_ASSOC_ID ASC, BOARD_TYPE ASC);

ALTER TABLE HOMEPAGE.BOARD
	ADD CONSTRAINT CONTAINER_ID_UNQ UNIQUE (BOARD_CONTAINER_ID);

--	prevent SQLSTATE 01550
--CREATE UNIQUE INDEX HOMEPAGE.BRD_CONTAINER_ID_UIDX 
--	ON HOMEPAGE.BOARD (BOARD_CONTAINER_ID);		

COMMIT;
-------------------------------------------------------
-- 2) Adding fk to the existing BOARD_ENTRIES
-------------------------------------------------------

--CLEAR BOARD_* tables before applying CONTAINER_ID FK
DELETE FROM HOMEPAGE.BOARD_OBJECT_REFERENCE;
DELETE FROM HOMEPAGE.BOARD_CURRENT_STATUS;
DELETE FROM HOMEPAGE.BOARD_RECOMMENDATIONS;
DELETE FROM HOMEPAGE.BOARD_COMMENTS;
DELETE FROM HOMEPAGE.BOARD_ENTRIES;
COMMIT;
	
ALTER TABLE HOMEPAGE.BOARD_ENTRIES
	ADD CONSTRAINT FK_CONTAINER_ID FOREIGN KEY (CONTAINER_ID) 
	REFERENCES HOMEPAGE.BOARD (BOARD_CONTAINER_ID);
	
CREATE INDEX HOMEPAGE.BRD_E_CONTAINER_ID_UIDX 
	ON HOMEPAGE.BOARD_ENTRIES (CONTAINER_ID);		

	
COMMIT;
--------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------


	
------------------------
-- BUG TYPO FIXING
------------------------
-- RENAME FROM:  N_RECCOMANDATIONS to the correct: N_RECOMMENDATIONS
ALTER TABLE HOMEPAGE.NR_ENTRIES_ACT ADD N_RECOMMANDATIONS SMALLINT DEFAULT 0 NOT NULL;
COMMIT;
--  [start] HOMEPAGE.NR_ENTRIES_ACT
UPDATE HOMEPAGE.NR_ENTRIES_ACT SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID < '0..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_ACT SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '0..f' AND ENTRY_ID < '1..f'; 
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_ACT SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '1..f' AND ENTRY_ID < '2..f'; 
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_ACT SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '2..f' AND ENTRY_ID < '3..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_ACT SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '3..f' AND ENTRY_ID < '4..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_ACT SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '4..f' AND ENTRY_ID < '5..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_ACT SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '5..f' AND ENTRY_ID < '6..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_ACT SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '6..f' AND ENTRY_ID < '7..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_ACT SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '7..f' AND ENTRY_ID < '8..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_ACT SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '8..f' AND ENTRY_ID < '9..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_ACT SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '9..f' AND ENTRY_ID < 'a..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_ACT SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'a..f' AND ENTRY_ID < 'b..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_ACT SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'b..f' AND ENTRY_ID < 'c..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_ACT SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'c..f' AND ENTRY_ID < 'd..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_ACT SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'd..f' AND ENTRY_ID < 'e..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_ACT SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'e..f' AND ENTRY_ID < 'f..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_ACT SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'f..f'; 
COMMIT;
--  [end] HOMEPAGE.NR_ENTRIES_ACT

COMMIT;
ALTER TABLE HOMEPAGE.NR_ENTRIES_ACT DROP COLUMN N_RECCOMANDATIONS;
COMMIT;


ALTER TABLE HOMEPAGE.NR_ENTRIES_BLG ADD N_RECOMMANDATIONS SMALLINT DEFAULT 0 NOT NULL;
COMMIT;
--  [start] HOMEPAGE.NR_ENTRIES_BLG
UPDATE HOMEPAGE.NR_ENTRIES_BLG SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID < '0..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_BLG SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '0..f' AND ENTRY_ID < '1..f'; 
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_BLG SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '1..f' AND ENTRY_ID < '2..f'; 
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_BLG SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '2..f' AND ENTRY_ID < '3..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_BLG SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '3..f' AND ENTRY_ID < '4..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_BLG SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '4..f' AND ENTRY_ID < '5..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_BLG SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '5..f' AND ENTRY_ID < '6..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_BLG SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '6..f' AND ENTRY_ID < '7..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_BLG SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '7..f' AND ENTRY_ID < '8..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_BLG SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '8..f' AND ENTRY_ID < '9..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_BLG SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '9..f' AND ENTRY_ID < 'a..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_BLG SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'a..f' AND ENTRY_ID < 'b..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_BLG SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'b..f' AND ENTRY_ID < 'c..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_BLG SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'c..f' AND ENTRY_ID < 'd..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_BLG SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'd..f' AND ENTRY_ID < 'e..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_BLG SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'e..f' AND ENTRY_ID < 'f..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_BLG SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'f..f'; 
COMMIT;
--  [end] HOMEPAGE.NR_ENTRIES_BLG
COMMIT;
ALTER TABLE HOMEPAGE.NR_ENTRIES_BLG DROP COLUMN N_RECCOMANDATIONS;
COMMIT;

ALTER TABLE HOMEPAGE.NR_ENTRIES_COM ADD N_RECOMMANDATIONS SMALLINT DEFAULT 0 NOT NULL;
COMMIT;
--  [start] HOMEPAGE.NR_ENTRIES_COM
UPDATE HOMEPAGE.NR_ENTRIES_COM SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID < '0..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_COM SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '0..f' AND ENTRY_ID < '1..f' ;
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_COM SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '1..f' AND ENTRY_ID < '2..f' ;
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_COM SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '2..f' AND ENTRY_ID < '3..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_COM SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '3..f' AND ENTRY_ID < '4..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_COM SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '4..f' AND ENTRY_ID < '5..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_COM SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '5..f' AND ENTRY_ID < '6..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_COM SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '6..f' AND ENTRY_ID < '7..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_COM SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '7..f' AND ENTRY_ID < '8..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_COM SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '8..f' AND ENTRY_ID < '9..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_COM SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '9..f' AND ENTRY_ID < 'a..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_COM SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'a..f' AND ENTRY_ID < 'b..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_COM SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'b..f' AND ENTRY_ID < 'c..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_COM SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'c..f' AND ENTRY_ID < 'd..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_COM SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'd..f' AND ENTRY_ID < 'e..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_COM SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'e..f' AND ENTRY_ID < 'f..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_COM SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'f..f';
COMMIT;
--  [end] HOMEPAGE.NR_ENTRIES_COM
COMMIT;
ALTER TABLE HOMEPAGE.NR_ENTRIES_COM DROP COLUMN N_RECCOMANDATIONS;
COMMIT;

ALTER TABLE HOMEPAGE.NR_ENTRIES_DGR ADD N_RECOMMANDATIONS SMALLINT DEFAULT 0 NOT NULL;
COMMIT;
--  [start] HOMEPAGE.NR_ENTRIES_DGR
UPDATE HOMEPAGE.NR_ENTRIES_DGR SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID < '0..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_DGR SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '0..f' AND ENTRY_ID < '1..f' ;
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_DGR SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '1..f' AND ENTRY_ID < '2..f' ;
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_DGR SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '2..f' AND ENTRY_ID < '3..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_DGR SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '3..f' AND ENTRY_ID < '4..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_DGR SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '4..f' AND ENTRY_ID < '5..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_DGR SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '5..f' AND ENTRY_ID < '6..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_DGR SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '6..f' AND ENTRY_ID < '7..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_DGR SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '7..f' AND ENTRY_ID < '8..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_DGR SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '8..f' AND ENTRY_ID < '9..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_DGR SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '9..f' AND ENTRY_ID < 'a..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_DGR SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'a..f' AND ENTRY_ID < 'b..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_DGR SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'b..f' AND ENTRY_ID < 'c..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_DGR SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'c..f' AND ENTRY_ID < 'd..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_DGR SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'd..f' AND ENTRY_ID < 'e..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_DGR SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'e..f' AND ENTRY_ID < 'f..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_DGR SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'f..f';
COMMIT;
--  [end] HOMEPAGE.NR_ENTRIES_DGR

COMMIT;
ALTER TABLE HOMEPAGE.NR_ENTRIES_DGR DROP COLUMN N_RECCOMANDATIONS;
COMMIT;

ALTER TABLE HOMEPAGE.NR_ENTRIES_EXTERNAL ADD N_RECOMMANDATIONS SMALLINT DEFAULT 0 NOT NULL;
COMMIT;
--  [start] HOMEPAGE.NR_ENTRIES_EXTERNAL
UPDATE HOMEPAGE.NR_ENTRIES_EXTERNAL SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID < '0..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_EXTERNAL SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '0..f' AND ENTRY_ID < '1..f' ;
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_EXTERNAL SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '1..f' AND ENTRY_ID < '2..f' ;
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_EXTERNAL SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '2..f' AND ENTRY_ID < '3..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_EXTERNAL SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '3..f' AND ENTRY_ID < '4..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_EXTERNAL SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '4..f' AND ENTRY_ID < '5..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_EXTERNAL SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '5..f' AND ENTRY_ID < '6..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_EXTERNAL SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '6..f' AND ENTRY_ID < '7..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_EXTERNAL SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '7..f' AND ENTRY_ID < '8..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_EXTERNAL SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '8..f' AND ENTRY_ID < '9..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_EXTERNAL SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '9..f' AND ENTRY_ID < 'a..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_EXTERNAL SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'a..f' AND ENTRY_ID < 'b..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_EXTERNAL SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'b..f' AND ENTRY_ID < 'c..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_EXTERNAL SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'c..f' AND ENTRY_ID < 'd..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_EXTERNAL SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'd..f' AND ENTRY_ID < 'e..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_EXTERNAL SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'e..f' AND ENTRY_ID < 'f..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_EXTERNAL SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'f..f';
COMMIT;
--  [end] HOMEPAGE.NR_ENTRIES_EXTERNAL
COMMIT;
ALTER TABLE HOMEPAGE.NR_ENTRIES_EXTERNAL DROP COLUMN N_RECCOMANDATIONS;
COMMIT;

ALTER TABLE HOMEPAGE.NR_ENTRIES_FILE ADD N_RECOMMANDATIONS SMALLINT DEFAULT 0 NOT NULL;
COMMIT;
--  [start] HOMEPAGE.NR_ENTRIES_FILE
UPDATE HOMEPAGE.NR_ENTRIES_FILE SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID < '0..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_FILE SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '0..f' AND ENTRY_ID < '1..f' ;
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_FILE SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '1..f' AND ENTRY_ID < '2..f' ;
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_FILE SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '2..f' AND ENTRY_ID < '3..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_FILE SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '3..f' AND ENTRY_ID < '4..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_FILE SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '4..f' AND ENTRY_ID < '5..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_FILE SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '5..f' AND ENTRY_ID < '6..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_FILE SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '6..f' AND ENTRY_ID < '7..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_FILE SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '7..f' AND ENTRY_ID < '8..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_FILE SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '8..f' AND ENTRY_ID < '9..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_FILE SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '9..f' AND ENTRY_ID < 'a..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_FILE SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'a..f' AND ENTRY_ID < 'b..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_FILE SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'b..f' AND ENTRY_ID < 'c..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_FILE SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'c..f' AND ENTRY_ID < 'd..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_FILE SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'd..f' AND ENTRY_ID < 'e..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_FILE SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'e..f' AND ENTRY_ID < 'f..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_FILE SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'f..f';
COMMIT;
--  [end] HOMEPAGE.NR_ENTRIES_FILE
COMMIT;
ALTER TABLE HOMEPAGE.NR_ENTRIES_FILE DROP COLUMN N_RECCOMANDATIONS;
COMMIT;

ALTER TABLE HOMEPAGE.NR_ENTRIES_FRM ADD N_RECOMMANDATIONS SMALLINT DEFAULT 0 NOT NULL;
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_FRM SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID < '0..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_FRM SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '0..f' AND ENTRY_ID < '1..f' ;
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_FRM SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '1..f' AND ENTRY_ID < '2..f' ;
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_FRM SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '2..f' AND ENTRY_ID < '3..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_FRM SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '3..f' AND ENTRY_ID < '4..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_FRM SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '4..f' AND ENTRY_ID < '5..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_FRM SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '5..f' AND ENTRY_ID < '6..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_FRM SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '6..f' AND ENTRY_ID < '7..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_FRM SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '7..f' AND ENTRY_ID < '8..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_FRM SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '8..f' AND ENTRY_ID < '9..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_FRM SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '9..f' AND ENTRY_ID < 'a..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_FRM SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'a..f' AND ENTRY_ID < 'b..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_FRM SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'b..f' AND ENTRY_ID < 'c..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_FRM SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'c..f' AND ENTRY_ID < 'd..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_FRM SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'd..f' AND ENTRY_ID < 'e..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_FRM SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'e..f' AND ENTRY_ID < 'f..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_FRM SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'f..f';
COMMIT;
--  [end] HOMEPAGE.NR_ENTRIES_FRM
COMMIT;
ALTER TABLE HOMEPAGE.NR_ENTRIES_FRM DROP COLUMN N_RECCOMANDATIONS;
COMMIT;

ALTER TABLE HOMEPAGE.NR_ENTRIES_HP ADD N_RECOMMANDATIONS SMALLINT DEFAULT 0 NOT NULL;
COMMIT;
--  [start] HOMEPAGE.NR_ENTRIES_HP
UPDATE HOMEPAGE.NR_ENTRIES_HP SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID < '0..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_HP SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '0..f' AND ENTRY_ID < '1..f' ;
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_HP SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '1..f' AND ENTRY_ID < '2..f' ;
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_HP SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '2..f' AND ENTRY_ID < '3..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_HP SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '3..f' AND ENTRY_ID < '4..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_HP SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '4..f' AND ENTRY_ID < '5..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_HP SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '5..f' AND ENTRY_ID < '6..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_HP SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '6..f' AND ENTRY_ID < '7..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_HP SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '7..f' AND ENTRY_ID < '8..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_HP SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '8..f' AND ENTRY_ID < '9..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_HP SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '9..f' AND ENTRY_ID < 'a..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_HP SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'a..f' AND ENTRY_ID < 'b..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_HP SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'b..f' AND ENTRY_ID < 'c..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_HP SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'c..f' AND ENTRY_ID < 'd..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_HP SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'd..f' AND ENTRY_ID < 'e..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_HP SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'e..f' AND ENTRY_ID < 'f..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_HP SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'f..f';
COMMIT;
--  [end] HOMEPAGE.NR_ENTRIES_HP
COMMIT;
ALTER TABLE HOMEPAGE.NR_ENTRIES_HP DROP COLUMN N_RECCOMANDATIONS;
COMMIT;

ALTER TABLE HOMEPAGE.NR_ENTRIES_PRF ADD N_RECOMMANDATIONS SMALLINT DEFAULT 0 NOT NULL;
COMMIT;
--  [start] HOMEPAGE.NR_ENTRIES_PRF
UPDATE HOMEPAGE.NR_ENTRIES_PRF SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID < '0..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_PRF SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '0..f' AND ENTRY_ID < '1..f' ;
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_PRF SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '1..f' AND ENTRY_ID < '2..f' ;
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_PRF SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '2..f' AND ENTRY_ID < '3..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_PRF SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '3..f' AND ENTRY_ID < '4..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_PRF SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '4..f' AND ENTRY_ID < '5..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_PRF SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '5..f' AND ENTRY_ID < '6..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_PRF SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '6..f' AND ENTRY_ID < '7..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_PRF SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '7..f' AND ENTRY_ID < '8..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_PRF SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '8..f' AND ENTRY_ID < '9..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_PRF SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '9..f' AND ENTRY_ID < 'a..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_PRF SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'a..f' AND ENTRY_ID < 'b..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_PRF SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'b..f' AND ENTRY_ID < 'c..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_PRF SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'c..f' AND ENTRY_ID < 'd..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_PRF SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'd..f' AND ENTRY_ID < 'e..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_PRF SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'e..f' AND ENTRY_ID < 'f..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_PRF SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'f..f';
COMMIT;
--  [end] HOMEPAGE.NR_ENTRIES_PRF
COMMIT;
ALTER TABLE HOMEPAGE.NR_ENTRIES_PRF DROP COLUMN N_RECCOMANDATIONS;
COMMIT;

ALTER TABLE HOMEPAGE.NR_ENTRIES_WIK ADD N_RECOMMANDATIONS SMALLINT DEFAULT 0 NOT NULL;
COMMIT;
--  [start] HOMEPAGE.NR_ENTRIES_WIK
UPDATE HOMEPAGE.NR_ENTRIES_WIK SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID < '0..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_WIK SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '0..f' AND ENTRY_ID < '1..f' ;
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_WIK SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '1..f' AND ENTRY_ID < '2..f' ;
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_WIK SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '2..f' AND ENTRY_ID < '3..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_WIK SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '3..f' AND ENTRY_ID < '4..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_WIK SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '4..f' AND ENTRY_ID < '5..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_WIK SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '5..f' AND ENTRY_ID < '6..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_WIK SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '6..f' AND ENTRY_ID < '7..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_WIK SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '7..f' AND ENTRY_ID < '8..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_WIK SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '8..f' AND ENTRY_ID < '9..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_WIK SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= '9..f' AND ENTRY_ID < 'a..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_WIK SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'a..f' AND ENTRY_ID < 'b..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_WIK SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'b..f' AND ENTRY_ID < 'c..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_WIK SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'c..f' AND ENTRY_ID < 'd..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_WIK SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'd..f' AND ENTRY_ID < 'e..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_WIK SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'e..f' AND ENTRY_ID < 'f..f';
COMMIT;
UPDATE HOMEPAGE.NR_ENTRIES_WIK SET N_RECOMMANDATIONS = N_RECCOMANDATIONS WHERE    ENTRY_ID >= 'f..f';
COMMIT;
--  [end] HOMEPAGE.NR_ENTRIES_WIK
COMMIT;
ALTER TABLE HOMEPAGE.NR_ENTRIES_WIK DROP COLUMN N_RECCOMANDATIONS;
COMMIT;

reorg table HOMEPAGE.NR_ENTRIES_ACT;
commit;
reorg table HOMEPAGE.NR_ENTRIES_BLG;
commit;
reorg table HOMEPAGE.NR_ENTRIES_COM;
commit;
reorg table HOMEPAGE.NR_ENTRIES_DGR;
commit;
reorg table HOMEPAGE.NR_ENTRIES_EXTERNAL;
commit;
reorg table HOMEPAGE.NR_ENTRIES_FILE;
commit;
reorg table HOMEPAGE.NR_ENTRIES_FRM;
commit;
reorg table HOMEPAGE.NR_ENTRIES_HP;
commit;
reorg table HOMEPAGE.NR_ENTRIES_PRF;
commit;
reorg table HOMEPAGE.NR_ENTRIES_WIK;
commit;

------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------
--	[START] DISCOVERY MIGRATION
------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------

-- 1 ACTIVITIES
CREATE VIEW HOMEPAGE.DISCOVERY AS (
	SELECT 	NR_NEWS_DISCOVERY.NEWS_RECORDS_ID 				CATEGORY_READER_ID,
		'00000000-0000-0000-0000-000000000001'			READER_ID,
		17										CATEGORY_TYPE,
		NR_NEWS_DISCOVERY.SOURCE						SOURCE,
		NR_NEWS_DISCOVERY.CONTAINER_ID				CONTAINER_ID,
		NR_NEWS_DISCOVERY.ITEM_ID					ITEM_ID,
		0										RESOURCE_TYPE,
		NR_NEWS_DISCOVERY.CREATION_DATE				CREATION_DATE,
		NR_NEWS_DISCOVERY.NEWS_STORY_ID				STORY_ID,
		NR_NEWS_DISCOVERY.SOURCE_TYPE					SOURCE_TYPE,
		0										USE_IN_ROLLUP,
		0										IS_NETWORK,
		0										IS_FOLLOWER,
		NR_NEWS_DISCOVERY.CREATION_DATE				EVENT_TIME,
		NR_NEWS_DISCOVERY.IS_COMMUNITY_STORY			IS_STORY_COMM,
		0										IS_BROADCAST				
	FROM 	HOMEPAGE.NR_NEWS_DISCOVERY NR_NEWS_DISCOVERY, 
			HOMEPAGE.NR_SRC_STORIES_ACT NR_SRC_STORIES_ACT
	WHERE 	NR_NEWS_DISCOVERY.NEWS_STORY_ID =  NR_SRC_STORIES_ACT.STORY_ID
);

COMMIT;

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE,     
		CREATION_DATE,  STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST
	)

SELECT * FROM HOMEPAGE.DISCOVERY;

IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE,     
		CREATION_DATE,  STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_DISCOVERY_VIEW 
	(	
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE,     
		CREATION_DATE,  STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST
	);
COMMIT;

DROP VIEW HOMEPAGE.DISCOVERY;

COMMIT;

-- 2 BLOGS
CREATE VIEW HOMEPAGE.DISCOVERY AS (
	SELECT 	NR_NEWS_DISCOVERY.NEWS_RECORDS_ID 				CATEGORY_READER_ID,
		'00000000-0000-0000-0000-000000000001'			READER_ID,
		17										CATEGORY_TYPE,
		NR_NEWS_DISCOVERY.SOURCE						SOURCE,
		NR_NEWS_DISCOVERY.CONTAINER_ID				CONTAINER_ID,
		NR_NEWS_DISCOVERY.ITEM_ID					ITEM_ID,
		0										RESOURCE_TYPE,
		NR_NEWS_DISCOVERY.CREATION_DATE				CREATION_DATE,
		NR_NEWS_DISCOVERY.NEWS_STORY_ID				STORY_ID,
		NR_NEWS_DISCOVERY.SOURCE_TYPE					SOURCE_TYPE,
		0										USE_IN_ROLLUP,
		0										IS_NETWORK,
		0										IS_FOLLOWER,
		NR_NEWS_DISCOVERY.CREATION_DATE				EVENT_TIME,
		NR_NEWS_DISCOVERY.IS_COMMUNITY_STORY			IS_STORY_COMM,
		0										IS_BROADCAST				
	FROM 	HOMEPAGE.NR_NEWS_DISCOVERY NR_NEWS_DISCOVERY, 
			HOMEPAGE.NR_SRC_STORIES_BLG NR_SRC_STORIES_BLG
	WHERE 	NR_NEWS_DISCOVERY.NEWS_STORY_ID =  NR_SRC_STORIES_BLG.STORY_ID
);

COMMIT;

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE,     
		CREATION_DATE,  STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST
	)

SELECT * FROM HOMEPAGE.DISCOVERY;

IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE,     
		CREATION_DATE,  STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_DISCOVERY_VIEW 
	(	
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE,     
		CREATION_DATE,  STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST
	);
COMMIT;

DROP VIEW HOMEPAGE.DISCOVERY;

COMMIT;

-- 3 COMMUNITIES
CREATE VIEW HOMEPAGE.DISCOVERY AS (
	SELECT 	NR_NEWS_DISCOVERY.NEWS_RECORDS_ID 				CATEGORY_READER_ID,
		'00000000-0000-0000-0000-000000000001'			READER_ID,
		17										CATEGORY_TYPE,
		NR_NEWS_DISCOVERY.SOURCE						SOURCE,
		NR_NEWS_DISCOVERY.CONTAINER_ID				CONTAINER_ID,
		NR_NEWS_DISCOVERY.ITEM_ID					ITEM_ID,
		0										RESOURCE_TYPE,
		NR_NEWS_DISCOVERY.CREATION_DATE				CREATION_DATE,
		NR_NEWS_DISCOVERY.NEWS_STORY_ID				STORY_ID,
		NR_NEWS_DISCOVERY.SOURCE_TYPE					SOURCE_TYPE,
		0										USE_IN_ROLLUP,
		0										IS_NETWORK,
		0										IS_FOLLOWER,
		NR_NEWS_DISCOVERY.CREATION_DATE				EVENT_TIME,
		NR_NEWS_DISCOVERY.IS_COMMUNITY_STORY			IS_STORY_COMM,
		0										IS_BROADCAST				
	FROM 	HOMEPAGE.NR_NEWS_DISCOVERY NR_NEWS_DISCOVERY, 
			HOMEPAGE.NR_SRC_STORIES_COM NR_SRC_STORIES_COM
	WHERE 	NR_NEWS_DISCOVERY.NEWS_STORY_ID =  NR_SRC_STORIES_COM.STORY_ID
);

COMMIT;

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE,     
		CREATION_DATE,  STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST
	)

SELECT * FROM HOMEPAGE.DISCOVERY;

IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE,     
		CREATION_DATE,  STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_DISCOVERY_VIEW 
	(	
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE,     
		CREATION_DATE,  STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST
	);
COMMIT;

DROP VIEW HOMEPAGE.DISCOVERY;

COMMIT;

-- 4 WIKIS
CREATE VIEW HOMEPAGE.DISCOVERY AS (
	SELECT 	NR_NEWS_DISCOVERY.NEWS_RECORDS_ID 				CATEGORY_READER_ID,
		'00000000-0000-0000-0000-000000000001'			READER_ID,
		17										CATEGORY_TYPE,
		NR_NEWS_DISCOVERY.SOURCE						SOURCE,
		NR_NEWS_DISCOVERY.CONTAINER_ID				CONTAINER_ID,
		NR_NEWS_DISCOVERY.ITEM_ID					ITEM_ID,
		0										RESOURCE_TYPE,
		NR_NEWS_DISCOVERY.CREATION_DATE				CREATION_DATE,
		NR_NEWS_DISCOVERY.NEWS_STORY_ID				STORY_ID,
		NR_NEWS_DISCOVERY.SOURCE_TYPE					SOURCE_TYPE,
		0										USE_IN_ROLLUP,
		0										IS_NETWORK,
		0										IS_FOLLOWER,
		NR_NEWS_DISCOVERY.CREATION_DATE				EVENT_TIME,
		NR_NEWS_DISCOVERY.IS_COMMUNITY_STORY			IS_STORY_COMM,
		0										IS_BROADCAST				
	FROM 	HOMEPAGE.NR_NEWS_DISCOVERY NR_NEWS_DISCOVERY, 
			HOMEPAGE.NR_SRC_STORIES_WIK NR_SRC_STORIES_WIK
	WHERE 	NR_NEWS_DISCOVERY.NEWS_STORY_ID =  NR_SRC_STORIES_WIK.STORY_ID
);

COMMIT;

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE,     
		CREATION_DATE,  STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST
	)

SELECT * FROM HOMEPAGE.DISCOVERY;

IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE,     
		CREATION_DATE,  STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_DISCOVERY_VIEW 
	(	
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE,     
		CREATION_DATE,  STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST
	);
COMMIT;

DROP VIEW HOMEPAGE.DISCOVERY;

COMMIT;

-- 5 PROFILES
CREATE VIEW HOMEPAGE.DISCOVERY AS (
	SELECT 	NR_NEWS_DISCOVERY.NEWS_RECORDS_ID 				CATEGORY_READER_ID,
		'00000000-0000-0000-0000-000000000001'			READER_ID,
		17										CATEGORY_TYPE,
		NR_NEWS_DISCOVERY.SOURCE						SOURCE,
		NR_NEWS_DISCOVERY.CONTAINER_ID				CONTAINER_ID,
		NR_NEWS_DISCOVERY.ITEM_ID					ITEM_ID,
		0										RESOURCE_TYPE,
		NR_NEWS_DISCOVERY.CREATION_DATE				CREATION_DATE,
		NR_NEWS_DISCOVERY.NEWS_STORY_ID				STORY_ID,
		NR_NEWS_DISCOVERY.SOURCE_TYPE					SOURCE_TYPE,
		0										USE_IN_ROLLUP,
		0										IS_NETWORK,
		0										IS_FOLLOWER,
		NR_NEWS_DISCOVERY.CREATION_DATE				EVENT_TIME,
		NR_NEWS_DISCOVERY.IS_COMMUNITY_STORY			IS_STORY_COMM,
		0										IS_BROADCAST				
	FROM 	HOMEPAGE.NR_NEWS_DISCOVERY NR_NEWS_DISCOVERY, 
			HOMEPAGE.NR_SRC_STORIES_PRF NR_SRC_STORIES_PRF
	WHERE 	NR_NEWS_DISCOVERY.NEWS_STORY_ID =  NR_SRC_STORIES_PRF.STORY_ID
);

COMMIT;

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE,     
		CREATION_DATE,  STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST
	)

SELECT * FROM HOMEPAGE.DISCOVERY;

IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE,     
		CREATION_DATE,  STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_DISCOVERY_VIEW 
	(	
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE,     
		CREATION_DATE,  STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST
	);
COMMIT;

DROP VIEW HOMEPAGE.DISCOVERY;

COMMIT;

-- 6 HOMEPAGE
CREATE VIEW HOMEPAGE.DISCOVERY AS (
	SELECT 	NR_NEWS_DISCOVERY.NEWS_RECORDS_ID 				CATEGORY_READER_ID,
		'00000000-0000-0000-0000-000000000001'			READER_ID,
		17										CATEGORY_TYPE,
		NR_NEWS_DISCOVERY.SOURCE						SOURCE,
		NR_NEWS_DISCOVERY.CONTAINER_ID				CONTAINER_ID,
		NR_NEWS_DISCOVERY.ITEM_ID					ITEM_ID,
		0										RESOURCE_TYPE,
		NR_NEWS_DISCOVERY.CREATION_DATE				CREATION_DATE,
		NR_NEWS_DISCOVERY.NEWS_STORY_ID				STORY_ID,
		NR_NEWS_DISCOVERY.SOURCE_TYPE					SOURCE_TYPE,
		0										USE_IN_ROLLUP,
		0										IS_NETWORK,
		0										IS_FOLLOWER,
		NR_NEWS_DISCOVERY.CREATION_DATE				EVENT_TIME,
		NR_NEWS_DISCOVERY.IS_COMMUNITY_STORY			IS_STORY_COMM,
		0										IS_BROADCAST				
	FROM 	HOMEPAGE.NR_NEWS_DISCOVERY NR_NEWS_DISCOVERY, 
			HOMEPAGE.NR_SRC_STORIES_HP NR_SRC_STORIES_HP
	WHERE 	NR_NEWS_DISCOVERY.NEWS_STORY_ID =  NR_SRC_STORIES_HP.STORY_ID
);

COMMIT;

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE,     
		CREATION_DATE,  STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST
	)

SELECT * FROM HOMEPAGE.DISCOVERY;

IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE,     
		CREATION_DATE,  STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_DISCOVERY_VIEW 
	(	
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE,     
		CREATION_DATE,  STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST
	);
COMMIT;

DROP VIEW HOMEPAGE.DISCOVERY;

COMMIT;

-- 7 DOGEAR
CREATE VIEW HOMEPAGE.DISCOVERY AS (
	SELECT 	NR_NEWS_DISCOVERY.NEWS_RECORDS_ID 				CATEGORY_READER_ID,
		'00000000-0000-0000-0000-000000000001'			READER_ID,
		17										CATEGORY_TYPE,
		NR_NEWS_DISCOVERY.SOURCE						SOURCE,
		NR_NEWS_DISCOVERY.CONTAINER_ID				CONTAINER_ID,
		NR_NEWS_DISCOVERY.ITEM_ID					ITEM_ID,
		0										RESOURCE_TYPE,
		NR_NEWS_DISCOVERY.CREATION_DATE				CREATION_DATE,
		NR_NEWS_DISCOVERY.NEWS_STORY_ID				STORY_ID,
		NR_NEWS_DISCOVERY.SOURCE_TYPE					SOURCE_TYPE,
		0										USE_IN_ROLLUP,
		0										IS_NETWORK,
		0										IS_FOLLOWER,
		NR_NEWS_DISCOVERY.CREATION_DATE				EVENT_TIME,
		NR_NEWS_DISCOVERY.IS_COMMUNITY_STORY			IS_STORY_COMM,
		0										IS_BROADCAST				
	FROM 	HOMEPAGE.NR_NEWS_DISCOVERY NR_NEWS_DISCOVERY, 
			HOMEPAGE.NR_SRC_STORIES_DGR NR_SRC_STORIES_DGR
	WHERE 	NR_NEWS_DISCOVERY.NEWS_STORY_ID =  NR_SRC_STORIES_DGR.STORY_ID
);

COMMIT;

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE,     
		CREATION_DATE,  STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST
	)

SELECT * FROM HOMEPAGE.DISCOVERY;

IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE,     
		CREATION_DATE,  STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_DISCOVERY_VIEW 
	(	
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE,     
		CREATION_DATE,  STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST
	);
COMMIT;

DROP VIEW HOMEPAGE.DISCOVERY;

COMMIT;

-- 8  FILES
CREATE VIEW HOMEPAGE.DISCOVERY AS (
	SELECT 	NR_NEWS_DISCOVERY.NEWS_RECORDS_ID 				CATEGORY_READER_ID,
		'00000000-0000-0000-0000-000000000001'			READER_ID,
		17										CATEGORY_TYPE,
		NR_NEWS_DISCOVERY.SOURCE						SOURCE,
		NR_NEWS_DISCOVERY.CONTAINER_ID				CONTAINER_ID,
		NR_NEWS_DISCOVERY.ITEM_ID					ITEM_ID,
		0										RESOURCE_TYPE,
		NR_NEWS_DISCOVERY.CREATION_DATE				CREATION_DATE,
		NR_NEWS_DISCOVERY.NEWS_STORY_ID				STORY_ID,
		NR_NEWS_DISCOVERY.SOURCE_TYPE					SOURCE_TYPE,
		0										USE_IN_ROLLUP,
		0										IS_NETWORK,
		0										IS_FOLLOWER,
		NR_NEWS_DISCOVERY.CREATION_DATE				EVENT_TIME,
		NR_NEWS_DISCOVERY.IS_COMMUNITY_STORY			IS_STORY_COMM,
		0										IS_BROADCAST				
	FROM 	HOMEPAGE.NR_NEWS_DISCOVERY NR_NEWS_DISCOVERY, 
			HOMEPAGE.NR_SRC_STORIES_FILE NR_SRC_STORIES_FILE
	WHERE 	NR_NEWS_DISCOVERY.NEWS_STORY_ID =  NR_SRC_STORIES_FILE.STORY_ID
);

COMMIT;

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE,     
		CREATION_DATE,  STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST
	)

SELECT * FROM HOMEPAGE.DISCOVERY;

IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE,     
		CREATION_DATE,  STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_DISCOVERY_VIEW 
	(	
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE,     
		CREATION_DATE,  STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST
	);
COMMIT;

DROP VIEW HOMEPAGE.DISCOVERY;

COMMIT;

-- 9  FORUMS
CREATE VIEW HOMEPAGE.DISCOVERY AS (
	SELECT 	NR_NEWS_DISCOVERY.NEWS_RECORDS_ID 				CATEGORY_READER_ID,
		'00000000-0000-0000-0000-000000000001'			READER_ID,
		17										CATEGORY_TYPE,
		NR_NEWS_DISCOVERY.SOURCE						SOURCE,
		NR_NEWS_DISCOVERY.CONTAINER_ID				CONTAINER_ID,
		NR_NEWS_DISCOVERY.ITEM_ID					ITEM_ID,
		0										RESOURCE_TYPE,
		NR_NEWS_DISCOVERY.CREATION_DATE				CREATION_DATE,
		NR_NEWS_DISCOVERY.NEWS_STORY_ID				STORY_ID,
		NR_NEWS_DISCOVERY.SOURCE_TYPE					SOURCE_TYPE,
		0										USE_IN_ROLLUP,
		0										IS_NETWORK,
		0										IS_FOLLOWER,
		NR_NEWS_DISCOVERY.CREATION_DATE				EVENT_TIME,
		NR_NEWS_DISCOVERY.IS_COMMUNITY_STORY			IS_STORY_COMM,
		0										IS_BROADCAST				
	FROM 	HOMEPAGE.NR_NEWS_DISCOVERY NR_NEWS_DISCOVERY, 
			HOMEPAGE.NR_SRC_STORIES_FRM NR_SRC_STORIES_FRM
	WHERE 	NR_NEWS_DISCOVERY.NEWS_STORY_ID =  NR_SRC_STORIES_FRM.STORY_ID
);

COMMIT;

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE,     
		CREATION_DATE,  STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST
	)

SELECT * FROM HOMEPAGE.DISCOVERY;

IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE,     
		CREATION_DATE,  STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_DISCOVERY_VIEW 
	(	
		CATEGORY_READER_ID, READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE,     
		CREATION_DATE,  STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP, IS_NETWORK, IS_FOLLOWER, EVENT_TIME, IS_STORY_COMM, IS_BROADCAST
	);
COMMIT;

DROP VIEW HOMEPAGE.DISCOVERY;

COMMIT;



set integrity for HOMEPAGE.NR_DISCOVERY_VIEW all immediate unchecked; 
commit;

------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------
--	[END] DISCOVERY MIGRATION
------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------


------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------
--	[START] SAVED MIGRATION
------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------

-- A) INSERT ENTRIES
-- B) INSERT STORIES
-- C) INSERT ACTIONABLE

-- 1) ACT ENTRIES
CREATE VIEW HOMEPAGE.TMP_ENTRIES AS (
	SELECT 
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	FROM (
		SELECT 	NR_NEWS_SAVED.ITEM_ID ENTRY_ID,
				NR_NEWS_SAVED.SOURCE,
				NR_NEWS_SAVED.SOURCE_TYPE,
				NR_NEWS_SAVED.CONTAINER_ID,
				NR_NEWS_SAVED.CONTAINER_NAME,
				NR_NEWS_SAVED.CONTAINER_URL,
				NR_NEWS_SAVED.ITEM_ID,
				NR_NEWS_SAVED.ENTRY_NAME	ITEM_NAME,
				NR_NEWS_SAVED.ENTRY_URL ITEM_URL,			
				NR_NEWS_SAVED.CREATION_DATE,
				NR_NEWS_SAVED.CREATION_DATE UPDATE_DATE,
				NR_NEWS_SAVED.TAGS,
				NR_NEWS_SAVED.N_COMMENTS,
				NR_NEWS_SAVED.N_RECOMMANDATIONS,
				0 N_ATTACHMENTS, -- N_ATTACHMENTS
				NR_NEWS_SAVED.BRIEF_DESC
		FROM 	HOMEPAGE.NR_NEWS_SAVED NR_NEWS_SAVED,
			(
				SELECT 	ITEM_ID, NEWS_STORY_ID STORY_ID, MAX(CREATION_DATE) CREATION_DATE
				FROM 	HOMEPAGE.NR_NEWS_SAVED
				WHERE 	ITEM_ID IS NOT NULL AND SOURCE_TYPE = 1
				GROUP	BY ITEM_ID, NEWS_STORY_ID
			) TEMP
		WHERE 	NR_NEWS_SAVED.NEWS_STORY_ID = TEMP.STORY_ID AND NR_NEWS_SAVED.CREATION_DATE = TEMP.CREATION_DATE
		) TEMP_STORIES 
	WHERE TEMP_STORIES.ENTRY_ID NOT IN (	
									SELECT 	ENTRY_ID
									FROM 	HOMEPAGE.NR_ENTRIES_ACT
								)
);

COMMIT;

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	)

SELECT * FROM HOMEPAGE.TMP_ENTRIES;

IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_ENTRIES_ACT 
	(	
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	);
COMMIT;

DROP VIEW HOMEPAGE.TMP_ENTRIES;

COMMIT;

-- 2) BLG ENTRIES
CREATE VIEW HOMEPAGE.TMP_ENTRIES AS (
	SELECT 
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	FROM (
		SELECT 	NR_NEWS_SAVED.ITEM_ID ENTRY_ID,
				NR_NEWS_SAVED.SOURCE,
				NR_NEWS_SAVED.SOURCE_TYPE,
				NR_NEWS_SAVED.CONTAINER_ID,
				NR_NEWS_SAVED.CONTAINER_NAME,
				NR_NEWS_SAVED.CONTAINER_URL,
				NR_NEWS_SAVED.ITEM_ID,
				NR_NEWS_SAVED.ENTRY_NAME	ITEM_NAME,
				NR_NEWS_SAVED.ENTRY_URL ITEM_URL,			
				NR_NEWS_SAVED.CREATION_DATE,
				NR_NEWS_SAVED.CREATION_DATE UPDATE_DATE,
				NR_NEWS_SAVED.TAGS,
				NR_NEWS_SAVED.N_COMMENTS,
				NR_NEWS_SAVED.N_RECOMMANDATIONS,
				0 N_ATTACHMENTS, -- N_ATTACHMENTS
				NR_NEWS_SAVED.BRIEF_DESC
		FROM 	HOMEPAGE.NR_NEWS_SAVED NR_NEWS_SAVED,
			(
				SELECT 	ITEM_ID, NEWS_STORY_ID STORY_ID, MAX(CREATION_DATE) CREATION_DATE
				FROM 	HOMEPAGE.NR_NEWS_SAVED
				WHERE 	ITEM_ID IS NOT NULL AND SOURCE_TYPE = 2
				GROUP	BY ITEM_ID, NEWS_STORY_ID
			) TEMP
		WHERE 	NR_NEWS_SAVED.NEWS_STORY_ID = TEMP.STORY_ID AND NR_NEWS_SAVED.CREATION_DATE = TEMP.CREATION_DATE
		) TEMP_STORIES  
	WHERE TEMP_STORIES.ENTRY_ID NOT IN (	
									SELECT 	ENTRY_ID
									FROM 	HOMEPAGE.NR_ENTRIES_BLG
								)
);

COMMIT;

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	)

SELECT * FROM HOMEPAGE.TMP_ENTRIES;

IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_ENTRIES_BLG 
	(	
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	);
COMMIT;

DROP VIEW HOMEPAGE.TMP_ENTRIES;

COMMIT;

-- 3) COM ENTRIES
CREATE VIEW HOMEPAGE.TMP_ENTRIES AS (
	SELECT 
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	FROM (
		SELECT 	NR_NEWS_SAVED.ITEM_ID ENTRY_ID,
				NR_NEWS_SAVED.SOURCE,
				NR_NEWS_SAVED.SOURCE_TYPE,
				NR_NEWS_SAVED.CONTAINER_ID,
				NR_NEWS_SAVED.CONTAINER_NAME,
				NR_NEWS_SAVED.CONTAINER_URL,
				NR_NEWS_SAVED.ITEM_ID,
				NR_NEWS_SAVED.ENTRY_NAME	ITEM_NAME,
				NR_NEWS_SAVED.ENTRY_URL ITEM_URL,			
				NR_NEWS_SAVED.CREATION_DATE,
				NR_NEWS_SAVED.CREATION_DATE UPDATE_DATE,
				NR_NEWS_SAVED.TAGS,
				NR_NEWS_SAVED.N_COMMENTS,
				NR_NEWS_SAVED.N_RECOMMANDATIONS,
				0 N_ATTACHMENTS, -- N_ATTACHMENTS
				NR_NEWS_SAVED.BRIEF_DESC
		FROM 	HOMEPAGE.NR_NEWS_SAVED NR_NEWS_SAVED,
			(
				SELECT 	ITEM_ID, NEWS_STORY_ID STORY_ID, MAX(CREATION_DATE) CREATION_DATE
				FROM 	HOMEPAGE.NR_NEWS_SAVED
				WHERE 	ITEM_ID IS NOT NULL AND SOURCE_TYPE = 3
				GROUP	BY ITEM_ID, NEWS_STORY_ID
			) TEMP
		WHERE 	NR_NEWS_SAVED.NEWS_STORY_ID = TEMP.STORY_ID AND NR_NEWS_SAVED.CREATION_DATE = TEMP.CREATION_DATE
		) TEMP_STORIES 
	WHERE TEMP_STORIES.ENTRY_ID NOT IN (	
									SELECT 	ENTRY_ID
									FROM 	HOMEPAGE.NR_ENTRIES_COM
								)
);

COMMIT;

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	)

SELECT * FROM HOMEPAGE.TMP_ENTRIES;

IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_ENTRIES_COM 
	(	
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	);
COMMIT;

DROP VIEW HOMEPAGE.TMP_ENTRIES;

COMMIT;

-- 4) WIK ENTRIES
CREATE VIEW HOMEPAGE.TMP_ENTRIES AS (
	SELECT 
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	FROM (
		SELECT 	NR_NEWS_SAVED.ITEM_ID ENTRY_ID,
				NR_NEWS_SAVED.SOURCE,
				NR_NEWS_SAVED.SOURCE_TYPE,
				NR_NEWS_SAVED.CONTAINER_ID,
				NR_NEWS_SAVED.CONTAINER_NAME,
				NR_NEWS_SAVED.CONTAINER_URL,
				NR_NEWS_SAVED.ITEM_ID,
				NR_NEWS_SAVED.ENTRY_NAME	ITEM_NAME,
				NR_NEWS_SAVED.ENTRY_URL ITEM_URL,			
				NR_NEWS_SAVED.CREATION_DATE,
				NR_NEWS_SAVED.CREATION_DATE UPDATE_DATE,
				NR_NEWS_SAVED.TAGS,
				NR_NEWS_SAVED.N_COMMENTS,
				NR_NEWS_SAVED.N_RECOMMANDATIONS,
				0 N_ATTACHMENTS, -- N_ATTACHMENTS
				NR_NEWS_SAVED.BRIEF_DESC
		FROM 	HOMEPAGE.NR_NEWS_SAVED NR_NEWS_SAVED,
			(
				SELECT 	ITEM_ID, NEWS_STORY_ID STORY_ID, MAX(CREATION_DATE) CREATION_DATE
				FROM 	HOMEPAGE.NR_NEWS_SAVED
				WHERE 	ITEM_ID IS NOT NULL AND SOURCE_TYPE = 4
				GROUP	BY ITEM_ID, NEWS_STORY_ID
			) TEMP
		WHERE 	NR_NEWS_SAVED.NEWS_STORY_ID = TEMP.STORY_ID AND NR_NEWS_SAVED.CREATION_DATE = TEMP.CREATION_DATE
		) TEMP_STORIES  
	WHERE TEMP_STORIES.ENTRY_ID NOT IN (	
									SELECT 	ENTRY_ID
									FROM 	HOMEPAGE.NR_ENTRIES_WIK
								)
);

COMMIT;

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	)

SELECT * FROM HOMEPAGE.TMP_ENTRIES;

IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_ENTRIES_WIK 
	(	
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	);
COMMIT;

DROP VIEW HOMEPAGE.TMP_ENTRIES;

COMMIT;

-- 5 PRF ENTRIES
CREATE VIEW HOMEPAGE.TMP_ENTRIES AS (
	SELECT 
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	FROM (
		SELECT 	NR_NEWS_SAVED.ITEM_ID ENTRY_ID,
				NR_NEWS_SAVED.SOURCE,
				NR_NEWS_SAVED.SOURCE_TYPE,
				NR_NEWS_SAVED.CONTAINER_ID,
				NR_NEWS_SAVED.CONTAINER_NAME,
				NR_NEWS_SAVED.CONTAINER_URL,
				NR_NEWS_SAVED.ITEM_ID,
				NR_NEWS_SAVED.ENTRY_NAME	ITEM_NAME,
				NR_NEWS_SAVED.ENTRY_URL ITEM_URL,			
				NR_NEWS_SAVED.CREATION_DATE,
				NR_NEWS_SAVED.CREATION_DATE UPDATE_DATE,
				NR_NEWS_SAVED.TAGS,
				NR_NEWS_SAVED.N_COMMENTS,
				NR_NEWS_SAVED.N_RECOMMANDATIONS,
				0 N_ATTACHMENTS, -- N_ATTACHMENTS
				NR_NEWS_SAVED.BRIEF_DESC
		FROM 	HOMEPAGE.NR_NEWS_SAVED NR_NEWS_SAVED,
			(
				SELECT 	ITEM_ID, NEWS_STORY_ID STORY_ID, MAX(CREATION_DATE) CREATION_DATE
				FROM 	HOMEPAGE.NR_NEWS_SAVED
				WHERE 	ITEM_ID IS NOT NULL AND SOURCE_TYPE = 5
				GROUP	BY ITEM_ID, NEWS_STORY_ID
			) TEMP
		WHERE 	NR_NEWS_SAVED.NEWS_STORY_ID = TEMP.STORY_ID AND NR_NEWS_SAVED.CREATION_DATE = TEMP.CREATION_DATE
		) TEMP_STORIES  
	WHERE TEMP_STORIES.ENTRY_ID NOT IN (	
									SELECT 	ENTRY_ID
									FROM 	HOMEPAGE.NR_ENTRIES_PRF
								)
);

COMMIT;

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	)

SELECT * FROM HOMEPAGE.TMP_ENTRIES;

IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_ENTRIES_PRF 
	(	
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	);
COMMIT;

DROP VIEW HOMEPAGE.TMP_ENTRIES;

COMMIT;

-- 6) HP ENTRIES
CREATE VIEW HOMEPAGE.TMP_ENTRIES AS (
	SELECT 
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	FROM (
		SELECT 	NR_NEWS_SAVED.ITEM_ID ENTRY_ID,
				NR_NEWS_SAVED.SOURCE,
				NR_NEWS_SAVED.SOURCE_TYPE,
				NR_NEWS_SAVED.CONTAINER_ID,
				NR_NEWS_SAVED.CONTAINER_NAME,
				NR_NEWS_SAVED.CONTAINER_URL,
				NR_NEWS_SAVED.ITEM_ID,
				NR_NEWS_SAVED.ENTRY_NAME	ITEM_NAME,
				NR_NEWS_SAVED.ENTRY_URL ITEM_URL,			
				NR_NEWS_SAVED.CREATION_DATE,
				NR_NEWS_SAVED.CREATION_DATE UPDATE_DATE,
				NR_NEWS_SAVED.TAGS,
				NR_NEWS_SAVED.N_COMMENTS,
				NR_NEWS_SAVED.N_RECOMMANDATIONS,
				0 N_ATTACHMENTS, -- N_ATTACHMENTS
				NR_NEWS_SAVED.BRIEF_DESC
		FROM 	HOMEPAGE.NR_NEWS_SAVED NR_NEWS_SAVED,
			(
				SELECT 	ITEM_ID, NEWS_STORY_ID STORY_ID, MAX(CREATION_DATE) CREATION_DATE
				FROM 	HOMEPAGE.NR_NEWS_SAVED
				WHERE 	ITEM_ID IS NOT NULL AND SOURCE_TYPE = 6
				GROUP	BY ITEM_ID, NEWS_STORY_ID
			) TEMP
		WHERE 	NR_NEWS_SAVED.NEWS_STORY_ID = TEMP.STORY_ID AND NR_NEWS_SAVED.CREATION_DATE = TEMP.CREATION_DATE
		) TEMP_STORIES  
	WHERE TEMP_STORIES.ENTRY_ID NOT IN (	
									SELECT 	ENTRY_ID
									FROM 	HOMEPAGE.NR_ENTRIES_HP
								)
);

COMMIT;

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	)

SELECT * FROM HOMEPAGE.TMP_ENTRIES;

IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_ENTRIES_HP 
	(	
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	);
COMMIT;

DROP VIEW HOMEPAGE.TMP_ENTRIES;

COMMIT;

-- 7) DGR ENTRIES
CREATE VIEW HOMEPAGE.TMP_ENTRIES AS (
	SELECT 
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	FROM (
		SELECT 	NR_NEWS_SAVED.ITEM_ID ENTRY_ID,
				NR_NEWS_SAVED.SOURCE,
				NR_NEWS_SAVED.SOURCE_TYPE,
				NR_NEWS_SAVED.CONTAINER_ID,
				NR_NEWS_SAVED.CONTAINER_NAME,
				NR_NEWS_SAVED.CONTAINER_URL,
				NR_NEWS_SAVED.ITEM_ID,
				NR_NEWS_SAVED.ENTRY_NAME	ITEM_NAME,
				NR_NEWS_SAVED.ENTRY_URL ITEM_URL,			
				NR_NEWS_SAVED.CREATION_DATE,
				NR_NEWS_SAVED.CREATION_DATE UPDATE_DATE,
				NR_NEWS_SAVED.TAGS,
				NR_NEWS_SAVED.N_COMMENTS,
				NR_NEWS_SAVED.N_RECOMMANDATIONS,
				0 N_ATTACHMENTS, -- N_ATTACHMENTS
				NR_NEWS_SAVED.BRIEF_DESC
		FROM 	HOMEPAGE.NR_NEWS_SAVED NR_NEWS_SAVED,
			(
				SELECT 	ITEM_ID, NEWS_STORY_ID STORY_ID, MAX(CREATION_DATE) CREATION_DATE
				FROM 	HOMEPAGE.NR_NEWS_SAVED
				WHERE 	ITEM_ID IS NOT NULL AND SOURCE_TYPE = 7
				GROUP	BY ITEM_ID, NEWS_STORY_ID
			) TEMP
		WHERE 	NR_NEWS_SAVED.NEWS_STORY_ID = TEMP.STORY_ID AND NR_NEWS_SAVED.CREATION_DATE = TEMP.CREATION_DATE
		) TEMP_STORIES  
	WHERE TEMP_STORIES.ENTRY_ID NOT IN (	
									SELECT 	ENTRY_ID
									FROM 	HOMEPAGE.NR_ENTRIES_DGR
								)
);

COMMIT;

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	)

SELECT * FROM HOMEPAGE.TMP_ENTRIES;

IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_ENTRIES_DGR 
	(	
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	);
COMMIT;

DROP VIEW HOMEPAGE.TMP_ENTRIES;

COMMIT;

-- 8) FILES ENTRIES
CREATE VIEW HOMEPAGE.TMP_ENTRIES AS (
	SELECT 
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	FROM (
		SELECT 	NR_NEWS_SAVED.ITEM_ID ENTRY_ID,
				NR_NEWS_SAVED.SOURCE,
				NR_NEWS_SAVED.SOURCE_TYPE,
				NR_NEWS_SAVED.CONTAINER_ID,
				NR_NEWS_SAVED.CONTAINER_NAME,
				NR_NEWS_SAVED.CONTAINER_URL,
				NR_NEWS_SAVED.ITEM_ID,
				NR_NEWS_SAVED.ENTRY_NAME	ITEM_NAME,
				NR_NEWS_SAVED.ENTRY_URL ITEM_URL,			
				NR_NEWS_SAVED.CREATION_DATE,
				NR_NEWS_SAVED.CREATION_DATE UPDATE_DATE,
				NR_NEWS_SAVED.TAGS,
				NR_NEWS_SAVED.N_COMMENTS,
				NR_NEWS_SAVED.N_RECOMMANDATIONS,
				0 N_ATTACHMENTS, -- N_ATTACHMENTS
				NR_NEWS_SAVED.BRIEF_DESC
		FROM 	HOMEPAGE.NR_NEWS_SAVED NR_NEWS_SAVED,
			(
				SELECT 	ITEM_ID, NEWS_STORY_ID STORY_ID, MAX(CREATION_DATE) CREATION_DATE
				FROM 	HOMEPAGE.NR_NEWS_SAVED
				WHERE 	ITEM_ID IS NOT NULL AND SOURCE_TYPE = 8
				GROUP	BY ITEM_ID, NEWS_STORY_ID
			) TEMP
		WHERE 	NR_NEWS_SAVED.NEWS_STORY_ID = TEMP.STORY_ID AND NR_NEWS_SAVED.CREATION_DATE = TEMP.CREATION_DATE
		) TEMP_STORIES  
	WHERE TEMP_STORIES.ENTRY_ID NOT IN (	
									SELECT 	ENTRY_ID
									FROM 	HOMEPAGE.NR_ENTRIES_FILE
								)
);

COMMIT;

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	)

SELECT * FROM HOMEPAGE.TMP_ENTRIES;

IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_ENTRIES_FILE 
	(	
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	);
COMMIT;

DROP VIEW HOMEPAGE.TMP_ENTRIES;

COMMIT;

-- 9) FRM ENTRIES
CREATE VIEW HOMEPAGE.TMP_ENTRIES AS (
	SELECT 
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	FROM (
		SELECT 	NR_NEWS_SAVED.ITEM_ID ENTRY_ID,
				NR_NEWS_SAVED.SOURCE,
				NR_NEWS_SAVED.SOURCE_TYPE,
				NR_NEWS_SAVED.CONTAINER_ID,
				NR_NEWS_SAVED.CONTAINER_NAME,
				NR_NEWS_SAVED.CONTAINER_URL,
				NR_NEWS_SAVED.ITEM_ID,
				NR_NEWS_SAVED.ENTRY_NAME	ITEM_NAME,
				NR_NEWS_SAVED.ENTRY_URL ITEM_URL,			
				NR_NEWS_SAVED.CREATION_DATE,
				NR_NEWS_SAVED.CREATION_DATE UPDATE_DATE,
				NR_NEWS_SAVED.TAGS,
				NR_NEWS_SAVED.N_COMMENTS,
				NR_NEWS_SAVED.N_RECOMMANDATIONS,
				0 N_ATTACHMENTS, -- N_ATTACHMENTS
				NR_NEWS_SAVED.BRIEF_DESC
		FROM 	HOMEPAGE.NR_NEWS_SAVED NR_NEWS_SAVED,
			(
				SELECT 	ITEM_ID, NEWS_STORY_ID STORY_ID, MAX(CREATION_DATE) CREATION_DATE
				FROM 	HOMEPAGE.NR_NEWS_SAVED
				WHERE 	ITEM_ID IS NOT NULL AND SOURCE_TYPE = 9
				GROUP	BY ITEM_ID, NEWS_STORY_ID
			) TEMP
		WHERE 	NR_NEWS_SAVED.NEWS_STORY_ID = TEMP.STORY_ID AND NR_NEWS_SAVED.CREATION_DATE = TEMP.CREATION_DATE
		) TEMP_STORIES  
	WHERE TEMP_STORIES.ENTRY_ID NOT IN (	
									SELECT 	ENTRY_ID
									FROM 	HOMEPAGE.NR_ENTRIES_FRM
								)
);

COMMIT;

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	)

SELECT * FROM HOMEPAGE.TMP_ENTRIES;

IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_ENTRIES_FRM
	(	
		ENTRY_ID, SOURCE, SOURCE_TYPE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ID,     
		ITEM_NAME,  ITEM_URL, CREATION_DATE, UPDATE_DATE, TAGS, N_COMMENTS, N_RECOMMANDATIONS, N_ATTACHMENTS, BRIEF_DESC
	);
COMMIT;

DROP VIEW HOMEPAGE.TMP_ENTRIES;

COMMIT;

set integrity for HOMEPAGE.NR_ENTRIES_ACT all immediate unchecked; 
commit;
set integrity for HOMEPAGE.NR_ENTRIES_BLG all immediate unchecked; 
commit;
set integrity for HOMEPAGE.NR_ENTRIES_COM all immediate unchecked; 
commit;
set integrity for HOMEPAGE.NR_ENTRIES_DGR all immediate unchecked; 
commit;
set integrity for HOMEPAGE.NR_ENTRIES_FILE all immediate unchecked; 
commit;
set integrity for HOMEPAGE.NR_ENTRIES_FRM all immediate unchecked; 
commit;
set integrity for HOMEPAGE.NR_ENTRIES_HP all immediate unchecked; 
commit;
set integrity for HOMEPAGE.NR_ENTRIES_PRF all immediate unchecked; 
commit;
set integrity for HOMEPAGE.NR_ENTRIES_WIK all immediate unchecked; 
commit;
				


----------------------------------------------------
----- STORIES
----------------------------------------------------

-- 1 ACT STORIES
CREATE VIEW HOMEPAGE.STORIES AS (
	SELECT 		NEWS_STORY_ID		STORY_ID,
				EVENT_NAME			EVENT_NAME,
				SOURCE				SOURCE,
				CONTAINER_ID		CONTAINER_ID,
				CONTAINER_NAME		CONTAINER_NAME,
				CONTAINER_URL		CONTAINER_URL,
				ENTRY_ATOM_URL		ITEM_ATOM_URL,
				ITEM_CORRELATION_ID	ITEM_CORRELATION_ID,
				CREATION_DATE		CREATION_DATE,
				BRIEF_DESC			BRIEF_DESC,
				ACTOR_UUID			ACTOR_UUID,
				EVENT_RECORD_UUID	EVENT_RECORD_UUID,
				TAGS				TAGS,
				META_TEMPLATE		META_TEMPLATE,
				TEXT_META_TEMPLATE	TEXT_META_TEMPLATE,
				IS_COMMUNITY_STORY	IS_COMMUNITY_STORY,
				SOURCE_TYPE			SOURCE_TYPE,
				0					HAS_ATTACHMENT,			
				ITEM_ID				ENTRY_ID,
				CREATION_DATE		EVENT_TIME
		FROM HOMEPAGE.NR_NEWS_SAVED NR_NEWS_SAVED,
			(
				SELECT NEWS_STORY_ID STORY_ID, MAX (CREATION_DATE) MAX_CREATION_DATE
				FROM HOMEPAGE.NR_NEWS_SAVED
				WHERE SOURCE_TYPE = 1
				GROUP BY NEWS_STORY_ID
			) TEMP
		WHERE 	NR_NEWS_SAVED.SOURCE_TYPE = 1 AND 	NR_NEWS_SAVED.CREATION_DATE = TEMP.MAX_CREATION_DATE AND NEWS_STORY_ID NOT IN 	(	SELECT STORY_ID
												 			FROM HOMEPAGE.NR_SRC_STORIES_ACT
												)
);

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		STORY_ID, EVENT_NAME, SOURCE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ATOM_URL, ITEM_CORRELATION_ID, CREATION_DATE, BRIEF_DESC,
		ACTOR_UUID, EVENT_RECORD_UUID, TAGS, META_TEMPLATE, TEXT_META_TEMPLATE, IS_COMMUNITY_STORY,
		SOURCE_TYPE, HAS_ATTACHMENT, ENTRY_ID, EVENT_TIME
	)

SELECT * FROM HOMEPAGE.STORIES;	
	
IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		STORY_ID, EVENT_NAME, SOURCE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ATOM_URL, ITEM_CORRELATION_ID, CREATION_DATE, BRIEF_DESC,
		ACTOR_UUID, EVENT_RECORD_UUID, TAGS, META_TEMPLATE, TEXT_META_TEMPLATE, IS_COMMUNITY_STORY,
		SOURCE_TYPE, HAS_ATTACHMENT, ENTRY_ID, EVENT_TIME
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_SRC_STORIES_ACT
	(	
		STORY_ID, EVENT_NAME, SOURCE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ATOM_URL, ITEM_CORRELATION_ID, CREATION_DATE, BRIEF_DESC,
		ACTOR_UUID, EVENT_RECORD_UUID, TAGS, META_TEMPLATE, TEXT_META_TEMPLATE, IS_COMMUNITY_STORY,
		SOURCE_TYPE, HAS_ATTACHMENT, ENTRY_ID, EVENT_TIME
	);
	
COMMIT;

DROP VIEW HOMEPAGE.STORIES;

COMMIT;

-- 2 BLG STORIES
CREATE VIEW HOMEPAGE.STORIES AS (
	SELECT 		NEWS_STORY_ID		STORY_ID,
				EVENT_NAME			EVENT_NAME,
				SOURCE				SOURCE,
				CONTAINER_ID		CONTAINER_ID,
				CONTAINER_NAME		CONTAINER_NAME,
				CONTAINER_URL		CONTAINER_URL,
				ENTRY_ATOM_URL		ITEM_ATOM_URL,
				ITEM_CORRELATION_ID	ITEM_CORRELATION_ID,
				CREATION_DATE		CREATION_DATE,
				BRIEF_DESC			BRIEF_DESC,
				ACTOR_UUID			ACTOR_UUID,
				EVENT_RECORD_UUID	EVENT_RECORD_UUID,
				TAGS				TAGS,
				META_TEMPLATE		META_TEMPLATE,
				TEXT_META_TEMPLATE	TEXT_META_TEMPLATE,
				IS_COMMUNITY_STORY	IS_COMMUNITY_STORY,
				SOURCE_TYPE			SOURCE_TYPE,
				0					HAS_ATTACHMENT,			
				ITEM_ID				ENTRY_ID,
				CREATION_DATE		EVENT_TIME
		FROM HOMEPAGE.NR_NEWS_SAVED NR_NEWS_SAVED,
			(
				SELECT NEWS_STORY_ID STORY_ID, MAX (CREATION_DATE) MAX_CREATION_DATE
				FROM HOMEPAGE.NR_NEWS_SAVED
				WHERE SOURCE_TYPE = 2
				GROUP BY NEWS_STORY_ID
			) TEMP
		WHERE 	NR_NEWS_SAVED.SOURCE_TYPE = 2 AND 	NR_NEWS_SAVED.CREATION_DATE = TEMP.MAX_CREATION_DATE AND NEWS_STORY_ID NOT IN 	(	SELECT STORY_ID
												 			FROM HOMEPAGE.NR_SRC_STORIES_BLG
												)
);

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		STORY_ID, EVENT_NAME, SOURCE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ATOM_URL, ITEM_CORRELATION_ID, CREATION_DATE, BRIEF_DESC,
		ACTOR_UUID, EVENT_RECORD_UUID, TAGS, META_TEMPLATE, TEXT_META_TEMPLATE, IS_COMMUNITY_STORY,
		SOURCE_TYPE, HAS_ATTACHMENT, ENTRY_ID, EVENT_TIME
	)

SELECT * FROM HOMEPAGE.STORIES;	
	
IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		STORY_ID, EVENT_NAME, SOURCE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ATOM_URL, ITEM_CORRELATION_ID, CREATION_DATE, BRIEF_DESC,
		ACTOR_UUID, EVENT_RECORD_UUID, TAGS, META_TEMPLATE, TEXT_META_TEMPLATE, IS_COMMUNITY_STORY,
		SOURCE_TYPE, HAS_ATTACHMENT, ENTRY_ID, EVENT_TIME
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_SRC_STORIES_BLG
	(	
		STORY_ID, EVENT_NAME, SOURCE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ATOM_URL, ITEM_CORRELATION_ID, CREATION_DATE, BRIEF_DESC,
		ACTOR_UUID, EVENT_RECORD_UUID, TAGS, META_TEMPLATE, TEXT_META_TEMPLATE, IS_COMMUNITY_STORY,
		SOURCE_TYPE, HAS_ATTACHMENT, ENTRY_ID, EVENT_TIME
	);
	
COMMIT;

DROP VIEW HOMEPAGE.STORIES;

COMMIT;

-- 3 COM STORIES
CREATE VIEW HOMEPAGE.STORIES AS (
	SELECT 		NEWS_STORY_ID		STORY_ID,
				EVENT_NAME			EVENT_NAME,
				SOURCE				SOURCE,
				CONTAINER_ID		CONTAINER_ID,
				CONTAINER_NAME		CONTAINER_NAME,
				CONTAINER_URL		CONTAINER_URL,
				ENTRY_ATOM_URL		ITEM_ATOM_URL,
				ITEM_CORRELATION_ID	ITEM_CORRELATION_ID,
				CREATION_DATE		CREATION_DATE,
				BRIEF_DESC			BRIEF_DESC,
				ACTOR_UUID			ACTOR_UUID,
				EVENT_RECORD_UUID	EVENT_RECORD_UUID,
				TAGS				TAGS,
				META_TEMPLATE		META_TEMPLATE,
				TEXT_META_TEMPLATE	TEXT_META_TEMPLATE,
				IS_COMMUNITY_STORY	IS_COMMUNITY_STORY,
				SOURCE_TYPE			SOURCE_TYPE,
				0					HAS_ATTACHMENT,			
				ITEM_ID				ENTRY_ID,
				CREATION_DATE		EVENT_TIME
		FROM HOMEPAGE.NR_NEWS_SAVED NR_NEWS_SAVED,
			(
				SELECT NEWS_STORY_ID STORY_ID, MAX (CREATION_DATE) MAX_CREATION_DATE
				FROM HOMEPAGE.NR_NEWS_SAVED
				WHERE SOURCE_TYPE = 3
				GROUP BY NEWS_STORY_ID
			) TEMP
		WHERE 	NR_NEWS_SAVED.SOURCE_TYPE = 3 AND 	NR_NEWS_SAVED.CREATION_DATE = TEMP.MAX_CREATION_DATE AND NEWS_STORY_ID NOT IN 	(	SELECT STORY_ID
												 			FROM HOMEPAGE.NR_SRC_STORIES_COM
												)
);

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		STORY_ID, EVENT_NAME, SOURCE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ATOM_URL, ITEM_CORRELATION_ID, CREATION_DATE, BRIEF_DESC,
		ACTOR_UUID, EVENT_RECORD_UUID, TAGS, META_TEMPLATE, TEXT_META_TEMPLATE, IS_COMMUNITY_STORY,
		SOURCE_TYPE, HAS_ATTACHMENT, ENTRY_ID, EVENT_TIME
	)

SELECT * FROM HOMEPAGE.STORIES;	
	
IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		STORY_ID, EVENT_NAME, SOURCE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ATOM_URL, ITEM_CORRELATION_ID, CREATION_DATE, BRIEF_DESC,
		ACTOR_UUID, EVENT_RECORD_UUID, TAGS, META_TEMPLATE, TEXT_META_TEMPLATE, IS_COMMUNITY_STORY,
		SOURCE_TYPE, HAS_ATTACHMENT, ENTRY_ID, EVENT_TIME
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_SRC_STORIES_COM
	(	
		STORY_ID, EVENT_NAME, SOURCE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ATOM_URL, ITEM_CORRELATION_ID, CREATION_DATE, BRIEF_DESC,
		ACTOR_UUID, EVENT_RECORD_UUID, TAGS, META_TEMPLATE, TEXT_META_TEMPLATE, IS_COMMUNITY_STORY,
		SOURCE_TYPE, HAS_ATTACHMENT, ENTRY_ID, EVENT_TIME
	);
	
COMMIT;

DROP VIEW HOMEPAGE.STORIES;

COMMIT;

-- 4 WIK STORIES
CREATE VIEW HOMEPAGE.STORIES AS (
	SELECT 		NEWS_STORY_ID		STORY_ID,
				EVENT_NAME			EVENT_NAME,
				SOURCE				SOURCE,
				CONTAINER_ID		CONTAINER_ID,
				CONTAINER_NAME		CONTAINER_NAME,
				CONTAINER_URL		CONTAINER_URL,
				ENTRY_ATOM_URL		ITEM_ATOM_URL,
				ITEM_CORRELATION_ID	ITEM_CORRELATION_ID,
				CREATION_DATE		CREATION_DATE,
				BRIEF_DESC			BRIEF_DESC,
				ACTOR_UUID			ACTOR_UUID,
				EVENT_RECORD_UUID	EVENT_RECORD_UUID,
				TAGS				TAGS,
				META_TEMPLATE		META_TEMPLATE,
				TEXT_META_TEMPLATE	TEXT_META_TEMPLATE,
				IS_COMMUNITY_STORY	IS_COMMUNITY_STORY,
				SOURCE_TYPE			SOURCE_TYPE,
				0					HAS_ATTACHMENT,			
				ITEM_ID				ENTRY_ID,
				CREATION_DATE		EVENT_TIME
		FROM HOMEPAGE.NR_NEWS_SAVED NR_NEWS_SAVED,
			(
				SELECT NEWS_STORY_ID STORY_ID, MAX (CREATION_DATE) MAX_CREATION_DATE
				FROM HOMEPAGE.NR_NEWS_SAVED
				WHERE SOURCE_TYPE = 4
				GROUP BY NEWS_STORY_ID
			) TEMP
		WHERE 	NR_NEWS_SAVED.SOURCE_TYPE = 4 AND 	NR_NEWS_SAVED.CREATION_DATE = TEMP.MAX_CREATION_DATE AND NEWS_STORY_ID NOT IN 	(	SELECT STORY_ID
												 			FROM HOMEPAGE.NR_SRC_STORIES_WIK
												)
);

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		STORY_ID, EVENT_NAME, SOURCE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ATOM_URL, ITEM_CORRELATION_ID, CREATION_DATE, BRIEF_DESC,
		ACTOR_UUID, EVENT_RECORD_UUID, TAGS, META_TEMPLATE, TEXT_META_TEMPLATE, IS_COMMUNITY_STORY,
		SOURCE_TYPE, HAS_ATTACHMENT, ENTRY_ID, EVENT_TIME
	)

SELECT * FROM HOMEPAGE.STORIES;	
	
IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		STORY_ID, EVENT_NAME, SOURCE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ATOM_URL, ITEM_CORRELATION_ID, CREATION_DATE, BRIEF_DESC,
		ACTOR_UUID, EVENT_RECORD_UUID, TAGS, META_TEMPLATE, TEXT_META_TEMPLATE, IS_COMMUNITY_STORY,
		SOURCE_TYPE, HAS_ATTACHMENT, ENTRY_ID, EVENT_TIME
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_SRC_STORIES_WIK
	(	
		STORY_ID, EVENT_NAME, SOURCE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ATOM_URL, ITEM_CORRELATION_ID, CREATION_DATE, BRIEF_DESC,
		ACTOR_UUID, EVENT_RECORD_UUID, TAGS, META_TEMPLATE, TEXT_META_TEMPLATE, IS_COMMUNITY_STORY,
		SOURCE_TYPE, HAS_ATTACHMENT, ENTRY_ID, EVENT_TIME
	);
	
COMMIT;

DROP VIEW HOMEPAGE.STORIES;

COMMIT;

-- 5 PRF STORIES
CREATE VIEW HOMEPAGE.STORIES AS (
	SELECT 		NEWS_STORY_ID		STORY_ID,
				EVENT_NAME			EVENT_NAME,
				SOURCE				SOURCE,
				CONTAINER_ID		CONTAINER_ID,
				CONTAINER_NAME		CONTAINER_NAME,
				CONTAINER_URL		CONTAINER_URL,
				ENTRY_ATOM_URL		ITEM_ATOM_URL,
				ITEM_CORRELATION_ID	ITEM_CORRELATION_ID,
				CREATION_DATE		CREATION_DATE,
				BRIEF_DESC			BRIEF_DESC,
				ACTOR_UUID			ACTOR_UUID,
				EVENT_RECORD_UUID	EVENT_RECORD_UUID,
				TAGS				TAGS,
				META_TEMPLATE		META_TEMPLATE,
				TEXT_META_TEMPLATE	TEXT_META_TEMPLATE,
				IS_COMMUNITY_STORY	IS_COMMUNITY_STORY,
				SOURCE_TYPE			SOURCE_TYPE,
				0					HAS_ATTACHMENT,			
				ITEM_ID				ENTRY_ID,
				CREATION_DATE		EVENT_TIME
		FROM HOMEPAGE.NR_NEWS_SAVED NR_NEWS_SAVED,
			(
				SELECT NEWS_STORY_ID STORY_ID, MAX (CREATION_DATE) MAX_CREATION_DATE
				FROM HOMEPAGE.NR_NEWS_SAVED
				WHERE SOURCE_TYPE = 5
				GROUP BY NEWS_STORY_ID
			) TEMP
		WHERE 	NR_NEWS_SAVED.SOURCE_TYPE = 5 AND 	NR_NEWS_SAVED.CREATION_DATE = TEMP.MAX_CREATION_DATE AND NEWS_STORY_ID NOT IN 	(	SELECT STORY_ID
												 			FROM HOMEPAGE.NR_SRC_STORIES_PRF
												)
);

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		STORY_ID, EVENT_NAME, SOURCE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ATOM_URL, ITEM_CORRELATION_ID, CREATION_DATE, BRIEF_DESC,
		ACTOR_UUID, EVENT_RECORD_UUID, TAGS, META_TEMPLATE, TEXT_META_TEMPLATE, IS_COMMUNITY_STORY,
		SOURCE_TYPE, HAS_ATTACHMENT, ENTRY_ID, EVENT_TIME
	)

SELECT * FROM HOMEPAGE.STORIES;	
	
IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		STORY_ID, EVENT_NAME, SOURCE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ATOM_URL, ITEM_CORRELATION_ID, CREATION_DATE, BRIEF_DESC,
		ACTOR_UUID, EVENT_RECORD_UUID, TAGS, META_TEMPLATE, TEXT_META_TEMPLATE, IS_COMMUNITY_STORY,
		SOURCE_TYPE, HAS_ATTACHMENT, ENTRY_ID, EVENT_TIME
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_SRC_STORIES_PRF
	(	
		STORY_ID, EVENT_NAME, SOURCE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ATOM_URL, ITEM_CORRELATION_ID, CREATION_DATE, BRIEF_DESC,
		ACTOR_UUID, EVENT_RECORD_UUID, TAGS, META_TEMPLATE, TEXT_META_TEMPLATE, IS_COMMUNITY_STORY,
		SOURCE_TYPE, HAS_ATTACHMENT, ENTRY_ID, EVENT_TIME
	);
	
COMMIT;

DROP VIEW HOMEPAGE.STORIES;

COMMIT;

-- 6 HP STORIES
CREATE VIEW HOMEPAGE.STORIES AS (
	SELECT 		NEWS_STORY_ID		STORY_ID,
				EVENT_NAME			EVENT_NAME,
				SOURCE				SOURCE,
				CONTAINER_ID		CONTAINER_ID,
				CONTAINER_NAME		CONTAINER_NAME,
				CONTAINER_URL		CONTAINER_URL,
				ENTRY_ATOM_URL		ITEM_ATOM_URL,
				ITEM_CORRELATION_ID	ITEM_CORRELATION_ID,
				CREATION_DATE		CREATION_DATE,
				BRIEF_DESC			BRIEF_DESC,
				ACTOR_UUID			ACTOR_UUID,
				EVENT_RECORD_UUID	EVENT_RECORD_UUID,
				TAGS				TAGS,
				META_TEMPLATE		META_TEMPLATE,
				TEXT_META_TEMPLATE	TEXT_META_TEMPLATE,
				IS_COMMUNITY_STORY	IS_COMMUNITY_STORY,
				SOURCE_TYPE			SOURCE_TYPE,
				0					HAS_ATTACHMENT,			
				ITEM_ID				ENTRY_ID,
				CREATION_DATE		EVENT_TIME
		FROM HOMEPAGE.NR_NEWS_SAVED NR_NEWS_SAVED,
			(
				SELECT NEWS_STORY_ID STORY_ID, MAX (CREATION_DATE) MAX_CREATION_DATE
				FROM HOMEPAGE.NR_NEWS_SAVED
				WHERE SOURCE_TYPE = 6
				GROUP BY NEWS_STORY_ID
			) TEMP
		WHERE 	NR_NEWS_SAVED.SOURCE_TYPE = 6 AND 	NR_NEWS_SAVED.CREATION_DATE = TEMP.MAX_CREATION_DATE AND NEWS_STORY_ID NOT IN 	(	SELECT STORY_ID
												 			FROM HOMEPAGE.NR_SRC_STORIES_HP
												)
);

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		STORY_ID, EVENT_NAME, SOURCE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ATOM_URL, ITEM_CORRELATION_ID, CREATION_DATE, BRIEF_DESC,
		ACTOR_UUID, EVENT_RECORD_UUID, TAGS, META_TEMPLATE, TEXT_META_TEMPLATE, IS_COMMUNITY_STORY,
		SOURCE_TYPE, HAS_ATTACHMENT, ENTRY_ID, EVENT_TIME
	)

SELECT * FROM HOMEPAGE.STORIES;	
	
IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		STORY_ID, EVENT_NAME, SOURCE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ATOM_URL, ITEM_CORRELATION_ID, CREATION_DATE, BRIEF_DESC,
		ACTOR_UUID, EVENT_RECORD_UUID, TAGS, META_TEMPLATE, TEXT_META_TEMPLATE, IS_COMMUNITY_STORY,
		SOURCE_TYPE, HAS_ATTACHMENT, ENTRY_ID, EVENT_TIME
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_SRC_STORIES_HP
	(	
		STORY_ID, EVENT_NAME, SOURCE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ATOM_URL, ITEM_CORRELATION_ID, CREATION_DATE, BRIEF_DESC,
		ACTOR_UUID, EVENT_RECORD_UUID, TAGS, META_TEMPLATE, TEXT_META_TEMPLATE, IS_COMMUNITY_STORY,
		SOURCE_TYPE, HAS_ATTACHMENT, ENTRY_ID, EVENT_TIME
	);
	
COMMIT;

DROP VIEW HOMEPAGE.STORIES;

COMMIT;

-- 7 DGR STORIES
CREATE VIEW HOMEPAGE.STORIES AS (
	SELECT 		NEWS_STORY_ID		STORY_ID,
				EVENT_NAME			EVENT_NAME,
				SOURCE				SOURCE,
				CONTAINER_ID		CONTAINER_ID,
				CONTAINER_NAME		CONTAINER_NAME,
				CONTAINER_URL		CONTAINER_URL,
				ENTRY_ATOM_URL		ITEM_ATOM_URL,
				ITEM_CORRELATION_ID	ITEM_CORRELATION_ID,
				CREATION_DATE		CREATION_DATE,
				BRIEF_DESC			BRIEF_DESC,
				ACTOR_UUID			ACTOR_UUID,
				EVENT_RECORD_UUID	EVENT_RECORD_UUID,
				TAGS				TAGS,
				META_TEMPLATE		META_TEMPLATE,
				TEXT_META_TEMPLATE	TEXT_META_TEMPLATE,
				IS_COMMUNITY_STORY	IS_COMMUNITY_STORY,
				SOURCE_TYPE			SOURCE_TYPE,
				0					HAS_ATTACHMENT,			
				ITEM_ID				ENTRY_ID,
				CREATION_DATE		EVENT_TIME
		FROM HOMEPAGE.NR_NEWS_SAVED NR_NEWS_SAVED,
			(
				SELECT NEWS_STORY_ID STORY_ID, MAX (CREATION_DATE) MAX_CREATION_DATE
				FROM HOMEPAGE.NR_NEWS_SAVED
				WHERE SOURCE_TYPE = 7
				GROUP BY NEWS_STORY_ID
			) TEMP
		WHERE 	NR_NEWS_SAVED.SOURCE_TYPE = 7 AND 	NR_NEWS_SAVED.CREATION_DATE = TEMP.MAX_CREATION_DATE AND NEWS_STORY_ID NOT IN 	(	SELECT STORY_ID
												 			FROM HOMEPAGE.NR_SRC_STORIES_DGR
												)
);

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		STORY_ID, EVENT_NAME, SOURCE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ATOM_URL, ITEM_CORRELATION_ID, CREATION_DATE, BRIEF_DESC,
		ACTOR_UUID, EVENT_RECORD_UUID, TAGS, META_TEMPLATE, TEXT_META_TEMPLATE, IS_COMMUNITY_STORY,
		SOURCE_TYPE, HAS_ATTACHMENT, ENTRY_ID, EVENT_TIME
	)

SELECT * FROM HOMEPAGE.STORIES;	
	
IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		STORY_ID, EVENT_NAME, SOURCE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ATOM_URL, ITEM_CORRELATION_ID, CREATION_DATE, BRIEF_DESC,
		ACTOR_UUID, EVENT_RECORD_UUID, TAGS, META_TEMPLATE, TEXT_META_TEMPLATE, IS_COMMUNITY_STORY,
		SOURCE_TYPE, HAS_ATTACHMENT, ENTRY_ID, EVENT_TIME
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_SRC_STORIES_DGR
	(	
		STORY_ID, EVENT_NAME, SOURCE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ATOM_URL, ITEM_CORRELATION_ID, CREATION_DATE, BRIEF_DESC,
		ACTOR_UUID, EVENT_RECORD_UUID, TAGS, META_TEMPLATE, TEXT_META_TEMPLATE, IS_COMMUNITY_STORY,
		SOURCE_TYPE, HAS_ATTACHMENT, ENTRY_ID, EVENT_TIME
	);
	
COMMIT;

DROP VIEW HOMEPAGE.STORIES;

COMMIT;

-- 8 FILE STORIES
CREATE VIEW HOMEPAGE.STORIES AS (
	SELECT 		NEWS_STORY_ID		STORY_ID,
				EVENT_NAME			EVENT_NAME,
				SOURCE				SOURCE,
				CONTAINER_ID		CONTAINER_ID,
				CONTAINER_NAME		CONTAINER_NAME,
				CONTAINER_URL		CONTAINER_URL,
				ENTRY_ATOM_URL		ITEM_ATOM_URL,
				ITEM_CORRELATION_ID	ITEM_CORRELATION_ID,
				CREATION_DATE		CREATION_DATE,
				BRIEF_DESC			BRIEF_DESC,
				ACTOR_UUID			ACTOR_UUID,
				EVENT_RECORD_UUID	EVENT_RECORD_UUID,
				TAGS				TAGS,
				META_TEMPLATE		META_TEMPLATE,
				TEXT_META_TEMPLATE	TEXT_META_TEMPLATE,
				IS_COMMUNITY_STORY	IS_COMMUNITY_STORY,
				SOURCE_TYPE			SOURCE_TYPE,
				0					HAS_ATTACHMENT,			
				ITEM_ID				ENTRY_ID,
				CREATION_DATE		EVENT_TIME
		FROM HOMEPAGE.NR_NEWS_SAVED NR_NEWS_SAVED,
			(
				SELECT NEWS_STORY_ID STORY_ID, MAX (CREATION_DATE) MAX_CREATION_DATE
				FROM HOMEPAGE.NR_NEWS_SAVED
				WHERE SOURCE_TYPE = 8
				GROUP BY NEWS_STORY_ID
			) TEMP
		WHERE 	NR_NEWS_SAVED.SOURCE_TYPE = 8 AND 	NR_NEWS_SAVED.CREATION_DATE = TEMP.MAX_CREATION_DATE AND NEWS_STORY_ID NOT IN 	(	SELECT STORY_ID
												 			FROM HOMEPAGE.NR_SRC_STORIES_FILE
												)
);

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		STORY_ID, EVENT_NAME, SOURCE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ATOM_URL, ITEM_CORRELATION_ID, CREATION_DATE, BRIEF_DESC,
		ACTOR_UUID, EVENT_RECORD_UUID, TAGS, META_TEMPLATE, TEXT_META_TEMPLATE, IS_COMMUNITY_STORY,
		SOURCE_TYPE, HAS_ATTACHMENT, ENTRY_ID, EVENT_TIME
	)

SELECT * FROM HOMEPAGE.STORIES;	
	
IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		STORY_ID, EVENT_NAME, SOURCE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ATOM_URL, ITEM_CORRELATION_ID, CREATION_DATE, BRIEF_DESC,
		ACTOR_UUID, EVENT_RECORD_UUID, TAGS, META_TEMPLATE, TEXT_META_TEMPLATE, IS_COMMUNITY_STORY,
		SOURCE_TYPE, HAS_ATTACHMENT, ENTRY_ID, EVENT_TIME
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_SRC_STORIES_FILE
	(	
		STORY_ID, EVENT_NAME, SOURCE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ATOM_URL, ITEM_CORRELATION_ID, CREATION_DATE, BRIEF_DESC,
		ACTOR_UUID, EVENT_RECORD_UUID, TAGS, META_TEMPLATE, TEXT_META_TEMPLATE, IS_COMMUNITY_STORY,
		SOURCE_TYPE, HAS_ATTACHMENT, ENTRY_ID, EVENT_TIME
	);
	
COMMIT;

DROP VIEW HOMEPAGE.STORIES;

COMMIT;

-- 9 FRM STORIES
CREATE VIEW HOMEPAGE.STORIES AS (
	SELECT 		NEWS_STORY_ID		STORY_ID,
				EVENT_NAME			EVENT_NAME,
				SOURCE				SOURCE,
				CONTAINER_ID		CONTAINER_ID,
				CONTAINER_NAME		CONTAINER_NAME,
				CONTAINER_URL		CONTAINER_URL,
				ENTRY_ATOM_URL		ITEM_ATOM_URL,
				ITEM_CORRELATION_ID	ITEM_CORRELATION_ID,
				CREATION_DATE		CREATION_DATE,
				BRIEF_DESC			BRIEF_DESC,
				ACTOR_UUID			ACTOR_UUID,
				EVENT_RECORD_UUID	EVENT_RECORD_UUID,
				TAGS				TAGS,
				META_TEMPLATE		META_TEMPLATE,
				TEXT_META_TEMPLATE	TEXT_META_TEMPLATE,
				IS_COMMUNITY_STORY	IS_COMMUNITY_STORY,
				SOURCE_TYPE			SOURCE_TYPE,
				0					HAS_ATTACHMENT,			
				ITEM_ID				ENTRY_ID,
				CREATION_DATE		EVENT_TIME
		FROM HOMEPAGE.NR_NEWS_SAVED NR_NEWS_SAVED,
			(
				SELECT NEWS_STORY_ID STORY_ID, MAX (CREATION_DATE) MAX_CREATION_DATE
				FROM HOMEPAGE.NR_NEWS_SAVED
				WHERE SOURCE_TYPE = 9
				GROUP BY NEWS_STORY_ID
			) TEMP
		WHERE 	NR_NEWS_SAVED.SOURCE_TYPE = 9 AND 	NR_NEWS_SAVED.CREATION_DATE = TEMP.MAX_CREATION_DATE AND NEWS_STORY_ID NOT IN 	(	SELECT STORY_ID
												 			FROM HOMEPAGE.NR_SRC_STORIES_FRM
												)
);

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		STORY_ID, EVENT_NAME, SOURCE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ATOM_URL, ITEM_CORRELATION_ID, CREATION_DATE, BRIEF_DESC,
		ACTOR_UUID, EVENT_RECORD_UUID, TAGS, META_TEMPLATE, TEXT_META_TEMPLATE, IS_COMMUNITY_STORY,
		SOURCE_TYPE, HAS_ATTACHMENT, ENTRY_ID, EVENT_TIME
	)

SELECT * FROM HOMEPAGE.STORIES;	
	
IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		STORY_ID, EVENT_NAME, SOURCE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ATOM_URL, ITEM_CORRELATION_ID, CREATION_DATE, BRIEF_DESC,
		ACTOR_UUID, EVENT_RECORD_UUID, TAGS, META_TEMPLATE, TEXT_META_TEMPLATE, IS_COMMUNITY_STORY,
		SOURCE_TYPE, HAS_ATTACHMENT, ENTRY_ID, EVENT_TIME
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_SRC_STORIES_FRM
	(	
		STORY_ID, EVENT_NAME, SOURCE, CONTAINER_ID, CONTAINER_NAME, CONTAINER_URL, ITEM_ATOM_URL, ITEM_CORRELATION_ID, CREATION_DATE, BRIEF_DESC,
		ACTOR_UUID, EVENT_RECORD_UUID, TAGS, META_TEMPLATE, TEXT_META_TEMPLATE, IS_COMMUNITY_STORY,
		SOURCE_TYPE, HAS_ATTACHMENT, ENTRY_ID, EVENT_TIME
	);
	
COMMIT;

DROP VIEW HOMEPAGE.STORIES;

COMMIT;


--------------------------------------------------------------------------
-- READERS
--------------------------------------------------------------------------

-- 1 READERS
CREATE VIEW HOMEPAGE.READERS AS (
	SELECT 	NR_NEWS_SAVED.READER_ID						READER_ID,
			13										CATEGORY_TYPE,
			NR_NEWS_SAVED.SOURCE						SOURCE,
			NR_NEWS_SAVED.CONTAINER_ID					CONTAINER_ID,
			NR_NEWS_SAVED.ITEM_ID						ITEM_ID,
			0										RESOURCE_TYPE,
			NR_NEWS_SAVED.CREATION_DATE					CREATION_DATE,
			NR_NEWS_SAVED.NEWS_STORY_ID					STORY_ID,
			NR_NEWS_SAVED.SOURCE_TYPE					SOURCE_TYPE,
			0										USE_IN_ROLLUP,				
			0										IS_NETWORK,
			0										IS_FOLLOWER,
			NR_NEWS_SAVED.CREATION_DATE					EVENT_TIME,
			NR_NEWS_SAVED.NEWS_RECORDS_ID 				CATEGORY_READER_ID,
			NR_NEWS_SAVED.IS_COMMUNITY_STORY				IS_STORY_COMM,
			0										IS_BROADCAST
	FROM 	HOMEPAGE.NR_NEWS_SAVED NR_NEWS_SAVED
	WHERE 	SOURCE_TYPE = 1
);

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE, CREATION_DATE, STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP,	IS_NETWORK,
		IS_FOLLOWER,  EVENT_TIME,  CATEGORY_READER_ID, IS_STORY_COMM, IS_BROADCAST
	)

SELECT * FROM HOMEPAGE.READERS;	
	
IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE, CREATION_DATE, STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP,	IS_NETWORK,
		IS_FOLLOWER,  EVENT_TIME,  CATEGORY_READER_ID, IS_STORY_COMM, IS_BROADCAST
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_ACTIONABLE_READERS
	(	
		READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE, CREATION_DATE, STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP,	IS_NETWORK,
		IS_FOLLOWER,  EVENT_TIME,  CATEGORY_READER_ID, IS_STORY_COMM, IS_BROADCAST
	);
	
COMMIT;

DROP VIEW HOMEPAGE.READERS;

COMMIT;

-- 2 READERS
CREATE VIEW HOMEPAGE.READERS AS (
	SELECT 	NR_NEWS_SAVED.READER_ID						READER_ID,
			13										CATEGORY_TYPE,
			NR_NEWS_SAVED.SOURCE						SOURCE,
			NR_NEWS_SAVED.CONTAINER_ID					CONTAINER_ID,
			NR_NEWS_SAVED.ITEM_ID						ITEM_ID,
			0										RESOURCE_TYPE,
			NR_NEWS_SAVED.CREATION_DATE					CREATION_DATE,
			NR_NEWS_SAVED.NEWS_STORY_ID					STORY_ID,
			NR_NEWS_SAVED.SOURCE_TYPE					SOURCE_TYPE,
			0										USE_IN_ROLLUP,				
			0										IS_NETWORK,
			0										IS_FOLLOWER,
			NR_NEWS_SAVED.CREATION_DATE					EVENT_TIME,
			NR_NEWS_SAVED.NEWS_RECORDS_ID 				CATEGORY_READER_ID,
			NR_NEWS_SAVED.IS_COMMUNITY_STORY				IS_STORY_COMM,
			0										IS_BROADCAST
	FROM 	HOMEPAGE.NR_NEWS_SAVED NR_NEWS_SAVED
	WHERE 	SOURCE_TYPE = 2
);

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE, CREATION_DATE, STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP,	IS_NETWORK,
		IS_FOLLOWER,  EVENT_TIME,  CATEGORY_READER_ID, IS_STORY_COMM, IS_BROADCAST
	)

SELECT * FROM HOMEPAGE.READERS;	
	
IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE, CREATION_DATE, STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP,	IS_NETWORK,
		IS_FOLLOWER,  EVENT_TIME,  CATEGORY_READER_ID, IS_STORY_COMM, IS_BROADCAST
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_ACTIONABLE_READERS
	(	
		READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE, CREATION_DATE, STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP,	IS_NETWORK,
		IS_FOLLOWER,  EVENT_TIME,  CATEGORY_READER_ID, IS_STORY_COMM, IS_BROADCAST
	);
	
COMMIT;

DROP VIEW HOMEPAGE.READERS;

COMMIT;

-- 3 READERS
CREATE VIEW HOMEPAGE.READERS AS (
	SELECT 	NR_NEWS_SAVED.READER_ID						READER_ID,
			13										CATEGORY_TYPE,
			NR_NEWS_SAVED.SOURCE						SOURCE,
			NR_NEWS_SAVED.CONTAINER_ID					CONTAINER_ID,
			NR_NEWS_SAVED.ITEM_ID						ITEM_ID,
			0										RESOURCE_TYPE,
			NR_NEWS_SAVED.CREATION_DATE					CREATION_DATE,
			NR_NEWS_SAVED.NEWS_STORY_ID					STORY_ID,
			NR_NEWS_SAVED.SOURCE_TYPE					SOURCE_TYPE,
			0										USE_IN_ROLLUP,				
			0										IS_NETWORK,
			0										IS_FOLLOWER,
			NR_NEWS_SAVED.CREATION_DATE					EVENT_TIME,
			NR_NEWS_SAVED.NEWS_RECORDS_ID 				CATEGORY_READER_ID,
			NR_NEWS_SAVED.IS_COMMUNITY_STORY				IS_STORY_COMM,
			0										IS_BROADCAST
	FROM 	HOMEPAGE.NR_NEWS_SAVED NR_NEWS_SAVED
	WHERE 	SOURCE_TYPE = 3
);

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE, CREATION_DATE, STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP,	IS_NETWORK,
		IS_FOLLOWER,  EVENT_TIME,  CATEGORY_READER_ID, IS_STORY_COMM, IS_BROADCAST
	)

SELECT * FROM HOMEPAGE.READERS;	
	
IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE, CREATION_DATE, STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP,	IS_NETWORK,
		IS_FOLLOWER,  EVENT_TIME,  CATEGORY_READER_ID, IS_STORY_COMM, IS_BROADCAST
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_ACTIONABLE_READERS
	(	
		READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE, CREATION_DATE, STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP,	IS_NETWORK,
		IS_FOLLOWER,  EVENT_TIME,  CATEGORY_READER_ID, IS_STORY_COMM, IS_BROADCAST
	);
	
COMMIT;

DROP VIEW HOMEPAGE.READERS;

COMMIT;

-- 4 READERS
CREATE VIEW HOMEPAGE.READERS AS (
	SELECT 	NR_NEWS_SAVED.READER_ID						READER_ID,
			13										CATEGORY_TYPE,
			NR_NEWS_SAVED.SOURCE						SOURCE,
			NR_NEWS_SAVED.CONTAINER_ID					CONTAINER_ID,
			NR_NEWS_SAVED.ITEM_ID						ITEM_ID,
			0										RESOURCE_TYPE,
			NR_NEWS_SAVED.CREATION_DATE					CREATION_DATE,
			NR_NEWS_SAVED.NEWS_STORY_ID					STORY_ID,
			NR_NEWS_SAVED.SOURCE_TYPE					SOURCE_TYPE,
			0										USE_IN_ROLLUP,				
			0										IS_NETWORK,
			0										IS_FOLLOWER,
			NR_NEWS_SAVED.CREATION_DATE					EVENT_TIME,
			NR_NEWS_SAVED.NEWS_RECORDS_ID 				CATEGORY_READER_ID,
			NR_NEWS_SAVED.IS_COMMUNITY_STORY				IS_STORY_COMM,
			0										IS_BROADCAST
	FROM 	HOMEPAGE.NR_NEWS_SAVED NR_NEWS_SAVED
	WHERE 	SOURCE_TYPE = 4
);

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE, CREATION_DATE, STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP,	IS_NETWORK,
		IS_FOLLOWER,  EVENT_TIME,  CATEGORY_READER_ID, IS_STORY_COMM, IS_BROADCAST
	)

SELECT * FROM HOMEPAGE.READERS;	
	
IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE, CREATION_DATE, STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP,	IS_NETWORK,
		IS_FOLLOWER,  EVENT_TIME,  CATEGORY_READER_ID, IS_STORY_COMM, IS_BROADCAST
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_ACTIONABLE_READERS
	(	
		READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE, CREATION_DATE, STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP,	IS_NETWORK,
		IS_FOLLOWER,  EVENT_TIME,  CATEGORY_READER_ID, IS_STORY_COMM, IS_BROADCAST
	);
	
COMMIT;

DROP VIEW HOMEPAGE.READERS;

COMMIT;

-- 5 READERS
CREATE VIEW HOMEPAGE.READERS AS (
	SELECT 	NR_NEWS_SAVED.READER_ID						READER_ID,
			13										CATEGORY_TYPE,
			NR_NEWS_SAVED.SOURCE						SOURCE,
			NR_NEWS_SAVED.CONTAINER_ID					CONTAINER_ID,
			NR_NEWS_SAVED.ITEM_ID						ITEM_ID,
			0										RESOURCE_TYPE,
			NR_NEWS_SAVED.CREATION_DATE					CREATION_DATE,
			NR_NEWS_SAVED.NEWS_STORY_ID					STORY_ID,
			NR_NEWS_SAVED.SOURCE_TYPE					SOURCE_TYPE,
			0										USE_IN_ROLLUP,				
			0										IS_NETWORK,
			0										IS_FOLLOWER,
			NR_NEWS_SAVED.CREATION_DATE					EVENT_TIME,
			NR_NEWS_SAVED.NEWS_RECORDS_ID 				CATEGORY_READER_ID,
			NR_NEWS_SAVED.IS_COMMUNITY_STORY				IS_STORY_COMM,
			0										IS_BROADCAST
	FROM 	HOMEPAGE.NR_NEWS_SAVED NR_NEWS_SAVED
	WHERE 	SOURCE_TYPE = 5
);

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE, CREATION_DATE, STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP,	IS_NETWORK,
		IS_FOLLOWER,  EVENT_TIME,  CATEGORY_READER_ID, IS_STORY_COMM, IS_BROADCAST
	)

SELECT * FROM HOMEPAGE.READERS;	
	
IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE, CREATION_DATE, STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP,	IS_NETWORK,
		IS_FOLLOWER,  EVENT_TIME,  CATEGORY_READER_ID, IS_STORY_COMM, IS_BROADCAST
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_ACTIONABLE_READERS
	(	
		READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE, CREATION_DATE, STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP,	IS_NETWORK,
		IS_FOLLOWER,  EVENT_TIME,  CATEGORY_READER_ID, IS_STORY_COMM, IS_BROADCAST
	);
	
COMMIT;

DROP VIEW HOMEPAGE.READERS;

COMMIT;

-- 6 READERS
CREATE VIEW HOMEPAGE.READERS AS (
	SELECT 	NR_NEWS_SAVED.READER_ID						READER_ID,
			13										CATEGORY_TYPE,
			NR_NEWS_SAVED.SOURCE						SOURCE,
			NR_NEWS_SAVED.CONTAINER_ID					CONTAINER_ID,
			NR_NEWS_SAVED.ITEM_ID						ITEM_ID,
			0										RESOURCE_TYPE,
			NR_NEWS_SAVED.CREATION_DATE					CREATION_DATE,
			NR_NEWS_SAVED.NEWS_STORY_ID					STORY_ID,
			NR_NEWS_SAVED.SOURCE_TYPE					SOURCE_TYPE,
			0										USE_IN_ROLLUP,				
			0										IS_NETWORK,
			0										IS_FOLLOWER,
			NR_NEWS_SAVED.CREATION_DATE					EVENT_TIME,
			NR_NEWS_SAVED.NEWS_RECORDS_ID 				CATEGORY_READER_ID,
			NR_NEWS_SAVED.IS_COMMUNITY_STORY				IS_STORY_COMM,
			0										IS_BROADCAST
	FROM 	HOMEPAGE.NR_NEWS_SAVED NR_NEWS_SAVED
	WHERE 	SOURCE_TYPE = 6
);

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE, CREATION_DATE, STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP,	IS_NETWORK,
		IS_FOLLOWER,  EVENT_TIME,  CATEGORY_READER_ID, IS_STORY_COMM, IS_BROADCAST
	)

SELECT * FROM HOMEPAGE.READERS;	
	
IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE, CREATION_DATE, STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP,	IS_NETWORK,
		IS_FOLLOWER,  EVENT_TIME,  CATEGORY_READER_ID, IS_STORY_COMM, IS_BROADCAST
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_ACTIONABLE_READERS
	(	
		READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE, CREATION_DATE, STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP,	IS_NETWORK,
		IS_FOLLOWER,  EVENT_TIME,  CATEGORY_READER_ID, IS_STORY_COMM, IS_BROADCAST
	);
	
COMMIT;

DROP VIEW HOMEPAGE.READERS;

COMMIT;

-- 7 READERS
CREATE VIEW HOMEPAGE.READERS AS (
	SELECT 	NR_NEWS_SAVED.READER_ID						READER_ID,
			13										CATEGORY_TYPE,
			NR_NEWS_SAVED.SOURCE						SOURCE,
			NR_NEWS_SAVED.CONTAINER_ID					CONTAINER_ID,
			NR_NEWS_SAVED.ITEM_ID						ITEM_ID,
			0										RESOURCE_TYPE,
			NR_NEWS_SAVED.CREATION_DATE					CREATION_DATE,
			NR_NEWS_SAVED.NEWS_STORY_ID					STORY_ID,
			NR_NEWS_SAVED.SOURCE_TYPE					SOURCE_TYPE,
			0										USE_IN_ROLLUP,				
			0										IS_NETWORK,
			0										IS_FOLLOWER,
			NR_NEWS_SAVED.CREATION_DATE					EVENT_TIME,
			NR_NEWS_SAVED.NEWS_RECORDS_ID 				CATEGORY_READER_ID,
			NR_NEWS_SAVED.IS_COMMUNITY_STORY				IS_STORY_COMM,
			0										IS_BROADCAST
	FROM 	HOMEPAGE.NR_NEWS_SAVED NR_NEWS_SAVED
	WHERE 	SOURCE_TYPE = 7
);

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE, CREATION_DATE, STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP,	IS_NETWORK,
		IS_FOLLOWER,  EVENT_TIME,  CATEGORY_READER_ID, IS_STORY_COMM, IS_BROADCAST
	)

SELECT * FROM HOMEPAGE.READERS;	
	
IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE, CREATION_DATE, STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP,	IS_NETWORK,
		IS_FOLLOWER,  EVENT_TIME,  CATEGORY_READER_ID, IS_STORY_COMM, IS_BROADCAST
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_ACTIONABLE_READERS
	(	
		READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE, CREATION_DATE, STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP,	IS_NETWORK,
		IS_FOLLOWER,  EVENT_TIME,  CATEGORY_READER_ID, IS_STORY_COMM, IS_BROADCAST
	);
	
COMMIT;

DROP VIEW HOMEPAGE.READERS;

COMMIT;

-- 8 READERS
CREATE VIEW HOMEPAGE.READERS AS (
	SELECT 	NR_NEWS_SAVED.READER_ID						READER_ID,
			13										CATEGORY_TYPE,
			NR_NEWS_SAVED.SOURCE						SOURCE,
			NR_NEWS_SAVED.CONTAINER_ID					CONTAINER_ID,
			NR_NEWS_SAVED.ITEM_ID						ITEM_ID,
			0										RESOURCE_TYPE,
			NR_NEWS_SAVED.CREATION_DATE					CREATION_DATE,
			NR_NEWS_SAVED.NEWS_STORY_ID					STORY_ID,
			NR_NEWS_SAVED.SOURCE_TYPE					SOURCE_TYPE,
			0										USE_IN_ROLLUP,				
			0										IS_NETWORK,
			0										IS_FOLLOWER,
			NR_NEWS_SAVED.CREATION_DATE					EVENT_TIME,
			NR_NEWS_SAVED.NEWS_RECORDS_ID 				CATEGORY_READER_ID,
			NR_NEWS_SAVED.IS_COMMUNITY_STORY				IS_STORY_COMM,
			0										IS_BROADCAST
	FROM 	HOMEPAGE.NR_NEWS_SAVED NR_NEWS_SAVED
	WHERE 	SOURCE_TYPE = 8
);

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE, CREATION_DATE, STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP,	IS_NETWORK,
		IS_FOLLOWER,  EVENT_TIME,  CATEGORY_READER_ID, IS_STORY_COMM, IS_BROADCAST
	)

SELECT * FROM HOMEPAGE.READERS;	
	
IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE, CREATION_DATE, STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP,	IS_NETWORK,
		IS_FOLLOWER,  EVENT_TIME,  CATEGORY_READER_ID, IS_STORY_COMM, IS_BROADCAST
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_ACTIONABLE_READERS
	(	
		READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE, CREATION_DATE, STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP,	IS_NETWORK,
		IS_FOLLOWER,  EVENT_TIME,  CATEGORY_READER_ID, IS_STORY_COMM, IS_BROADCAST
	);
	
COMMIT;

DROP VIEW HOMEPAGE.READERS;

COMMIT;


-- 9 READERS
CREATE VIEW HOMEPAGE.READERS AS (
	SELECT 	NR_NEWS_SAVED.READER_ID						READER_ID,
			13										CATEGORY_TYPE,
			NR_NEWS_SAVED.SOURCE						SOURCE,
			NR_NEWS_SAVED.CONTAINER_ID					CONTAINER_ID,
			NR_NEWS_SAVED.ITEM_ID						ITEM_ID,
			0										RESOURCE_TYPE,
			NR_NEWS_SAVED.CREATION_DATE					CREATION_DATE,
			NR_NEWS_SAVED.NEWS_STORY_ID					STORY_ID,
			NR_NEWS_SAVED.SOURCE_TYPE					SOURCE_TYPE,
			0										USE_IN_ROLLUP,				
			0										IS_NETWORK,
			0										IS_FOLLOWER,
			NR_NEWS_SAVED.CREATION_DATE					EVENT_TIME,
			NR_NEWS_SAVED.NEWS_RECORDS_ID 				CATEGORY_READER_ID,
			NR_NEWS_SAVED.IS_COMMUNITY_STORY				IS_STORY_COMM,
			0										IS_BROADCAST
	FROM 	HOMEPAGE.NR_NEWS_SAVED NR_NEWS_SAVED
	WHERE 	SOURCE_TYPE = 9
);

EXPORT TO data.tmp.ixf OF IXF METHOD N 
	(	
		READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE, CREATION_DATE, STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP,	IS_NETWORK,
		IS_FOLLOWER,  EVENT_TIME,  CATEGORY_READER_ID, IS_STORY_COMM, IS_BROADCAST
	)

SELECT * FROM HOMEPAGE.READERS;	
	
IMPORT FROM data.tmp.ixf OF IXF METHOD N 
	(	
		READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE, CREATION_DATE, STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP,	IS_NETWORK,
		IS_FOLLOWER,  EVENT_TIME,  CATEGORY_READER_ID, IS_STORY_COMM, IS_BROADCAST
	)
COMMITCOUNT 1000	
INSERT INTO HOMEPAGE.NR_ACTIONABLE_READERS
	(	
		READER_ID, CATEGORY_TYPE, SOURCE, CONTAINER_ID, ITEM_ID, RESOURCE_TYPE, CREATION_DATE, STORY_ID, SOURCE_TYPE, USE_IN_ROLLUP,	IS_NETWORK,
		IS_FOLLOWER,  EVENT_TIME,  CATEGORY_READER_ID, IS_STORY_COMM, IS_BROADCAST
	);
	
COMMIT;

DROP VIEW HOMEPAGE.READERS;

COMMIT;


set integrity for HOMEPAGE.NR_ACTIONABLE_READERS all immediate unchecked; 
commit;



------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------
--	[END] SAVED MIGRATION
------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------
