-- ***************************************************************** 
--                                                                   
-- IBM Confidential                                                  
--                                                                   
-- OCO Source Materials                                              
--                                                                   
-- Copyright IBM Corp. 2007, 2015                                    
--                                                                   
-- The source code for this program is not published or otherwise    
-- divested of its trade secrets, irrespective of what has been      
-- deposited with the U.S. Copyright Office.                         
--                                                                   
-- ***************************************************************** 

-- {COPYRIGHT}

---------------------------------------------------
-- 111057: Remove table references from SQL init code in sn.homepage
---------------------------------------------------
ALTER TABLE HOMEPAGE.NR_RESOURCE DROP CONSTRAINT HOMEPAGE.FK_RES_RES_TYPE;
COMMIT;	
ALTER TABLE HOMEPAGE.NR_RESOURCE DROP CONSTRAINT HOMEPAGE.FK_RES_CAT_TYPE;
COMMIT;
ALTER TABLE HOMEPAGE.EMD_RESOURCE_PREF DROP CONSTRAINT HOMEPAGE.FK_RES_FRQ_TYPE;
COMMIT;

DROP TABLE HOMEPAGE.NR_RESOURCE_TYPE;
COMMIT;
DROP TABLE HOMEPAGE.NR_CATEGORY_TYPE;
COMMIT;
DROP TABLE HOMEPAGE.EMD_FREQUENCY_TYPE;
COMMIT;

-- 113337: [fixup468] [db2] add an UPDATE to fix a template
UPDATE HOMEPAGE.NR_TEMPLATE SET DATA_SOURCE_STRING = 'rollupName;rollupHtmlPath' WHERE NAME = 'topicEntryName';
COMMIT;

--112212: [fixup468] Remove OLD_CONTENT BLOB field
ALTER TABLE HOMEPAGE.NR_NEWS_STATUS_CONTENT DROP COLUMN OLD_CONTENT;
COMMIT;
--REORG TABLE HOMEPAGE.NR_NEWS_STATUS_CONTENT;
--COMMIT;

ALTER TABLE HOMEPAGE.NR_NEWS_COMMENT_CONTENT DROP COLUMN OLD_CONTENT;
COMMIT;
--REORG TABLE HOMEPAGE.NR_NEWS_COMMENT_CONTENT;
--COMMIT;

ALTER TABLE HOMEPAGE.NR_STORIES_CONTENT DROP COLUMN OLD_CONTENT;
COMMIT;
--REORG TABLE HOMEPAGE.NR_STORIES_CONTENT;
--COMMIT;

ALTER TABLE HOMEPAGE.BOARD_ENTRIES DROP COLUMN OLD_CONTENT;
COMMIT;
--REORG TABLE HOMEPAGE.BOARD_ENTRIES;
--COMMIT;

ALTER TABLE HOMEPAGE.BOARD_COMMENTS DROP COLUMN OLD_CONTENT;
COMMIT;
--REORG TABLE HOMEPAGE.BOARD_COMMENTS;
--COMMIT;














CREATE  INDEX HOMEPAGE.AGGREGATED_READERS_CONT_IDX 
 	ON HOMEPAGE.NR_AGGREGATED_READERS (CONTAINER_ID); 
COMMIT;
--


CREATE  INDEX HOMEPAGE.RESPONSES_READERS_CONT_IDX 
 	ON HOMEPAGE.NR_RESPONSES_READERS (CONTAINER_ID); 
COMMIT;
--


CREATE  INDEX HOMEPAGE.PROFILES_READERS_CONT_IDX 
 	ON HOMEPAGE.NR_PROFILES_READERS (CONTAINER_ID); 
COMMIT;
--


CREATE  INDEX HOMEPAGE.COMM_READERS_CONT_IDX 
 	ON HOMEPAGE.NR_COMMUNITIES_READERS (CONTAINER_ID); 
COMMIT;
--


CREATE  INDEX HOMEPAGE.ACTIVITIES_READERS_CONT_IDX 
 	ON HOMEPAGE.NR_ACTIVITIES_READERS (CONTAINER_ID); 
COMMIT;
--


CREATE  INDEX HOMEPAGE.BLOGS_READERS_CONT_IDX 
 	ON HOMEPAGE.NR_BLOGS_READERS (CONTAINER_ID); 
COMMIT;
--


CREATE  INDEX HOMEPAGE.BOOKMARKS_READERS_CONT_IDX 
 	ON HOMEPAGE.NR_BOOKMARKS_READERS (CONTAINER_ID); 
COMMIT;
--


CREATE  INDEX HOMEPAGE.FILES_READERS_CONT_IDX 
 	ON HOMEPAGE.NR_FILES_READERS (CONTAINER_ID); 
COMMIT;
--


CREATE  INDEX HOMEPAGE.FORUMS_READERS_CONT_IDX 
 	ON HOMEPAGE.NR_FORUMS_READERS (CONTAINER_ID); 
COMMIT;
--


CREATE  INDEX HOMEPAGE.WIKIS_READERS_CONT_IDX 
 	ON HOMEPAGE.NR_WIKIS_READERS (CONTAINER_ID); 
COMMIT;
--


CREATE  INDEX HOMEPAGE.TAGS_READERS_CONT_IDX 
 	ON HOMEPAGE.NR_TAGS_READERS (CONTAINER_ID); 
COMMIT;
--


CREATE  INDEX HOMEPAGE.STATUS_READERS_CONT_IDX 
 	ON HOMEPAGE.NR_STATUS_UPDATE_READERS (CONTAINER_ID); 
COMMIT;
--


CREATE  INDEX HOMEPAGE.EXTERNAL_READERS_CONT_IDX 
 	ON HOMEPAGE.NR_EXTERNAL_READERS (CONTAINER_ID); 
COMMIT;
--


CREATE  INDEX HOMEPAGE.ACTIONABLE_READERS_CONT_IDX 
 	ON HOMEPAGE.NR_ACTIONABLE_READERS (CONTAINER_ID); 
COMMIT;
--
COMMIT;

CREATE  INDEX HOMEPAGE.DISCOVERY_VIEW_CONT_IDX 
 	ON HOMEPAGE.NR_DISCOVERY_VIEW (CONTAINER_ID); 
COMMIT;
--
COMMIT;

CREATE  INDEX HOMEPAGE.PROFILES_VIEW_CONT_IDX 
 	ON HOMEPAGE.NR_PROFILES_VIEW (CONTAINER_ID); 
COMMIT;
--


CREATE  INDEX HOMEPAGE.NOTIFICA_READERS_CONT_IDX 
 	ON HOMEPAGE.NR_NOTIFICATION_SENT_READERS (CONTAINER_ID); 
COMMIT;
--


CREATE  INDEX HOMEPAGE.NOT_REC_READERS_CONT_IDX 
 	ON HOMEPAGE.NR_NOTIFICATION_RECEIV_READERS (CONTAINER_ID); 
COMMIT;
--


CREATE  INDEX HOMEPAGE.SAVED_READERS_CONT_IDX 
 	ON HOMEPAGE.NR_SAVED_READERS (CONTAINER_ID); 
COMMIT;
--


CREATE  INDEX HOMEPAGE.TOPICS_READERS_CONT_IDX 
 	ON HOMEPAGE.NR_TOPICS_READERS (CONTAINER_ID); 
COMMIT;
--


CREATE  INDEX HOMEPAGE.MENTIONS_READERS_CONT_IDX 
 	ON HOMEPAGE.NR_MENTIONS_READERS (CONTAINER_ID); 
COMMIT;


--------------------------------------------------------------------------------------------
-- 113510: [fixup468] Add COMMUNITY_ID in READER|VIEW tables
--------------------------------------------------------------------------------------------
ALTER TABLE HOMEPAGE.NR_AGGREGATED_READERS ADD COLUMN COMMUNITY_ID VARCHAR(36) CCSID 1208;
COMMIT;

ALTER TABLE HOMEPAGE.NR_RESPONSES_READERS ADD COLUMN COMMUNITY_ID VARCHAR(36) CCSID 1208;
COMMIT;

ALTER TABLE HOMEPAGE.NR_PROFILES_READERS ADD COLUMN COMMUNITY_ID VARCHAR(36) CCSID 1208;
COMMIT;

ALTER TABLE HOMEPAGE.NR_COMMUNITIES_READERS ADD COLUMN COMMUNITY_ID VARCHAR(36) CCSID 1208;
COMMIT;

ALTER TABLE HOMEPAGE.NR_ACTIVITIES_READERS ADD COLUMN COMMUNITY_ID VARCHAR(36) CCSID 1208;
COMMIT;

ALTER TABLE HOMEPAGE.NR_BLOGS_READERS ADD COLUMN COMMUNITY_ID VARCHAR(36) CCSID 1208;
COMMIT;

ALTER TABLE HOMEPAGE.NR_BOOKMARKS_READERS ADD COLUMN COMMUNITY_ID VARCHAR(36) CCSID 1208;
COMMIT;

ALTER TABLE HOMEPAGE.NR_FILES_READERS ADD COLUMN COMMUNITY_ID VARCHAR(36) CCSID 1208;
COMMIT;

ALTER TABLE HOMEPAGE.NR_FORUMS_READERS ADD COLUMN COMMUNITY_ID VARCHAR(36) CCSID 1208;
COMMIT;

ALTER TABLE HOMEPAGE.NR_WIKIS_READERS ADD COLUMN COMMUNITY_ID VARCHAR(36) CCSID 1208;
COMMIT;

ALTER TABLE HOMEPAGE.NR_TAGS_READERS ADD COLUMN COMMUNITY_ID VARCHAR(36) CCSID 1208;
COMMIT;

ALTER TABLE HOMEPAGE.NR_STATUS_UPDATE_READERS ADD COLUMN COMMUNITY_ID VARCHAR(36) CCSID 1208;
COMMIT;

ALTER TABLE HOMEPAGE.NR_EXTERNAL_READERS ADD COLUMN COMMUNITY_ID VARCHAR(36) CCSID 1208;
COMMIT;

ALTER TABLE HOMEPAGE.NR_ACTIONABLE_READERS ADD COLUMN COMMUNITY_ID VARCHAR(36) CCSID 1208;
COMMIT;

ALTER TABLE HOMEPAGE.NR_NOTIFICATION_SENT_READERS ADD COLUMN COMMUNITY_ID VARCHAR(36) CCSID 1208;
COMMIT;

ALTER TABLE HOMEPAGE.NR_NOTIFICATION_RECEIV_READERS ADD COLUMN COMMUNITY_ID VARCHAR(36) CCSID 1208;
COMMIT;

ALTER TABLE HOMEPAGE.NR_SAVED_READERS ADD COLUMN COMMUNITY_ID VARCHAR(36) CCSID 1208;
COMMIT;

ALTER TABLE HOMEPAGE.NR_TOPICS_READERS ADD COLUMN COMMUNITY_ID VARCHAR(36) CCSID 1208;
COMMIT;

ALTER TABLE HOMEPAGE.NR_MENTIONS_READERS ADD COLUMN COMMUNITY_ID VARCHAR(36) CCSID 1208;
COMMIT;

ALTER TABLE HOMEPAGE.NR_DISCOVERY_VIEW ADD COLUMN COMMUNITY_ID VARCHAR(36) CCSID 1208;
COMMIT;

ALTER TABLE HOMEPAGE.NR_PROFILES_VIEW ADD COLUMN COMMUNITY_ID VARCHAR(36) CCSID 1208;
COMMIT;

/*
REORG TABLE HOMEPAGE.NR_AGGREGATED_READERS;
COMMIT;
REORG TABLE HOMEPAGE.NR_RESPONSES_READERS;
COMMIT;
REORG TABLE HOMEPAGE.NR_PROFILES_READERS;
COMMIT;
REORG TABLE HOMEPAGE.NR_COMMUNITIES_READERS;
COMMIT;
REORG TABLE HOMEPAGE.NR_ACTIVITIES_READERS;
COMMIT;
REORG TABLE HOMEPAGE.NR_BLOGS_READERS;
COMMIT;
REORG TABLE HOMEPAGE.NR_BOOKMARKS_READERS;
COMMIT;
REORG TABLE HOMEPAGE.NR_FILES_READERS;
COMMIT;
REORG TABLE HOMEPAGE.NR_FORUMS_READERS;
COMMIT;
REORG TABLE HOMEPAGE.NR_WIKIS_READERS;
COMMIT;
REORG TABLE HOMEPAGE.NR_TAGS_READERS;
COMMIT;
REORG TABLE HOMEPAGE.NR_STATUS_UPDATE_READERS;
COMMIT;
REORG TABLE HOMEPAGE.NR_EXTERNAL_READERS;
COMMIT;
REORG TABLE HOMEPAGE.NR_ACTIONABLE_READERS;
COMMIT;
REORG TABLE HOMEPAGE.NR_NOTIFICATION_SENT_READERS;
COMMIT;
REORG TABLE HOMEPAGE.NR_NOTIFICATION_RECEIV_READERS;
COMMIT;
REORG TABLE HOMEPAGE.NR_SAVED_READERS;
COMMIT;
REORG TABLE HOMEPAGE.NR_TOPICS_READERS;
COMMIT;
REORG TABLE HOMEPAGE.NR_MENTIONS_READERS;
COMMIT;
REORG TABLE HOMEPAGE.NR_DISCOVERY_VIEW;
COMMIT;
REORG TABLE HOMEPAGE.NR_PROFILES_VIEW;
COMMIT;



runstats on table HOMEPAGE.NR_AGGREGATED_READERS with distribution and detailed indexes all allow write access;
COMMIT;
runstats on table HOMEPAGE.NR_RESPONSES_READERS with distribution and detailed indexes all allow write access;
COMMIT;
runstats on table HOMEPAGE.NR_PROFILES_READERS with distribution and detailed indexes all allow write access;
COMMIT;
runstats on table HOMEPAGE.NR_COMMUNITIES_READERS with distribution and detailed indexes all allow write access;
COMMIT;
runstats on table HOMEPAGE.NR_ACTIVITIES_READERS with distribution and detailed indexes all allow write access;
COMMIT;
runstats on table HOMEPAGE.NR_BLOGS_READERS with distribution and detailed indexes all allow write access;
COMMIT;
runstats on table HOMEPAGE.NR_BOOKMARKS_READERS with distribution and detailed indexes all allow write access;
COMMIT;
runstats on table HOMEPAGE.NR_FILES_READERS with distribution and detailed indexes all allow write access;
COMMIT;
runstats on table HOMEPAGE.NR_FORUMS_READERS with distribution and detailed indexes all allow write access;
COMMIT;
runstats on table HOMEPAGE.NR_WIKIS_READERS with distribution and detailed indexes all allow write access;
COMMIT;
runstats on table HOMEPAGE.NR_TAGS_READERS with distribution and detailed indexes all allow write access;
COMMIT;
runstats on table HOMEPAGE.NR_STATUS_UPDATE_READERS with distribution and detailed indexes all allow write access;
COMMIT;
runstats on table HOMEPAGE.NR_EXTERNAL_READERS with distribution and detailed indexes all allow write access;
COMMIT;
runstats on table HOMEPAGE.NR_ACTIONABLE_READERS with distribution and detailed indexes all allow write access;
COMMIT;
runstats on table HOMEPAGE.NR_NOTIFICATION_SENT_READERS with distribution and detailed indexes all allow write access;
COMMIT;
runstats on table HOMEPAGE.NR_NOTIFICATION_RECEIV_READERS with distribution and detailed indexes all allow write access;
COMMIT;
runstats on table HOMEPAGE.NR_SAVED_READERS with distribution and detailed indexes all allow write access;
COMMIT;
runstats on table HOMEPAGE.NR_TOPICS_READERS with distribution and detailed indexes all allow write access;
COMMIT;
runstats on table HOMEPAGE.NR_MENTIONS_READERS with distribution and detailed indexes all allow write access;
COMMIT;
runstats on table HOMEPAGE.NR_DISCOVERY_VIEW with distribution and detailed indexes all allow write access;
COMMIT;
runstats on table HOMEPAGE.NR_PROFILES_VIEW with distribution and detailed indexes all allow write access;
COMMIT;
*/