-- ***************************************************************** 
--                                                                   
-- IBM Confidential                                                  
--                                                                   
-- OCO Source Materials                                              
--                                                                   
-- Copyright IBM Corp. 2007, 2015                                    
--                                                                   
-- The source code for this program is not published or otherwise    
-- divested of its trade secrets, irrespective of what has been      
-- deposited with the U.S. Copyright Office.                         
--                                                                   
-- ***************************************************************** 

-- {COPYRIGHT}


-- DROPing the fk
ALTER TABLE HOMEPAGE.NR_AGGREGATED_READERS DROP CONSTRAINT FK_AGG_READERS_STR;
COMMIT;
ALTER TABLE HOMEPAGE.NR_RESPONSES_READERS DROP CONSTRAINT FK_RES_READERS_STR;
COMMIT;
ALTER TABLE HOMEPAGE.NR_PROFILES_READERS DROP CONSTRAINT FK_PRF_READERS_STR;
COMMIT;		
ALTER TABLE HOMEPAGE.NR_COMMUNITIES_READERS DROP CONSTRAINT FK_COM_READERS_STR;
COMMIT;	 
ALTER TABLE HOMEPAGE.NR_ACTIVITIES_READERS DROP CONSTRAINT FK_ACI_READERS_STR;
COMMIT;
ALTER TABLE HOMEPAGE.NR_BLOGS_READERS DROP CONSTRAINT FK_BLG_READERS_STR;
COMMIT;	 
ALTER TABLE HOMEPAGE.NR_BOOKMARKS_READERS DROP CONSTRAINT FK_BKM_READERS_STR;
COMMIT;	 
ALTER TABLE HOMEPAGE.NR_FILES_READERS DROP CONSTRAINT FK_FIL_READERS_STR;
COMMIT;
ALTER TABLE HOMEPAGE.NR_FORUMS_READERS DROP CONSTRAINT FK_FRM_READERS_STR;
COMMIT;	 
ALTER TABLE HOMEPAGE.NR_WIKIS_READERS DROP CONSTRAINT FK_WIK_READERS_STR;
COMMIT;
ALTER TABLE HOMEPAGE.NR_TAGS_READERS DROP CONSTRAINT FK_TAG_READERS_STR;
COMMIT;
ALTER TABLE HOMEPAGE.NR_STATUS_UPDATE_READERS DROP CONSTRAINT FK_STA_READERS_STR;
COMMIT;	 
ALTER TABLE HOMEPAGE.NR_EXTERNAL_READERS DROP CONSTRAINT FK_EXT_READERS_STR;
COMMIT;	
ALTER TABLE HOMEPAGE.NR_ACTIONABLE_READERS DROP CONSTRAINT FK_ACT_READERS_STR;
COMMIT;		
ALTER TABLE HOMEPAGE.NR_SAVED_READERS DROP CONSTRAINT FK_SAV_READERS_STR;
COMMIT;	 
ALTER TABLE HOMEPAGE.NR_DISCOVERY_VIEW DROP CONSTRAINT FK_DIS_READERS_STR;
COMMIT;
ALTER TABLE HOMEPAGE.NR_PROFILES_VIEW DROP CONSTRAINT FK_PRO_READERS_STR;
COMMIT;	 
ALTER TABLE HOMEPAGE.NR_NOTIFICATION_SENT_READERS DROP CONSTRAINT FK_NOT_READERS_STR;
COMMIT;
ALTER TABLE HOMEPAGE.NR_NOTIFICATION_RECEIV_READERS DROP CONSTRAINT FK_REC_READERS_STR;
COMMIT;
ALTER TABLE HOMEPAGE.NR_TOPICS_READERS DROP CONSTRAINT  FK_TOP_READERS_STR;
COMMIT;
ALTER TABLE HOMEPAGE.NR_MENTIONS_READERS DROP CONSTRAINT  FK_MEN_READERS_STR;
COMMIT;


ALTER TABLE HOMEPAGE.NR_STORIES DROP CONSTRAINT FK_ENTRY_ID;
COMMIT;

ALTER TABLE HOMEPAGE.NR_STORIES DROP CONSTRAINT FK_STORIES_ORG_ID;
COMMIT;


ALTER TABLE HOMEPAGE.BOARD_COMMENTS DROP FOREIGN KEY FK_BRD_COM_ENTRY;
COMMIT;
ALTER TABLE HOMEPAGE.BOARD_OBJECT_REFERENCE DROP CONSTRAINT FK_BRD_OBJ_ENTRY;
COMMIT;
ALTER TABLE HOMEPAGE.BOARD_OBJECT_REFERENCE DROP CONSTRAINT FK_BRD_AUTHOR_ID;
COMMIT;
ALTER TABLE HOMEPAGE.BOARD_CURRENT_STATUS DROP FOREIGN KEY FK_CUR_ST_ACTOR_ID;
COMMIT;
ALTER TABLE HOMEPAGE.BOARD_CURRENT_STATUS DROP FOREIGN KEY FK_CUR_ST_ENTRY_ID;
COMMIT;

ALTER TABLE HOMEPAGE.BOARD DROP CONSTRAINT FK_BRD_OWNER;
COMMIT;
ALTER TABLE HOMEPAGE.BOARD DROP CONSTRAINT FK_BRD_CREATED;
COMMIT;
ALTER TABLE HOMEPAGE.BOARD DROP CONSTRAINT FK_BRD_LASTUPDATE;
COMMIT;
ALTER TABLE HOMEPAGE.BOARD_ENTRIES DROP CONSTRAINT FK_CONTAINER_ID;
COMMIT;
ALTER TABLE HOMEPAGE.BOARD_RECOMMENDATIONS 	DROP CONSTRAINT FK_BRD_RECOMMENDER;
COMMIT;


-- NR_NEWS_COMMENT_CONTENT
ALTER TABLE HOMEPAGE.NR_NEWS_COMMENT_CONTENT DROP FOREIGN KEY "FK_C_COMMENT_ID";
COMMIT;

-----------------------------
TRUNCATE HOMEPAGE.NR_ENTRIES IMMEDIATE;
COMMIT;
TRUNCATE HOMEPAGE.NR_ENTRIES_ARCHIVE IMMEDIATE;
COMMIT;

TRUNCATE HOMEPAGE.NR_STORIES IMMEDIATE;
COMMIT;
TRUNCATE HOMEPAGE.NR_STORIES_CONTENT IMMEDIATE;
COMMIT;
TRUNCATE HOMEPAGE.DELETED_STORIES_QUEUE IMMEDIATE;
COMMIT;


TRUNCATE HOMEPAGE.NR_AGGREGATED_READERS IMMEDIATE;
COMMIT;
TRUNCATE HOMEPAGE.NR_RESPONSES_READERS IMMEDIATE;
COMMIT;
TRUNCATE HOMEPAGE.NR_PROFILES_READERS IMMEDIATE;
COMMIT;
TRUNCATE HOMEPAGE.NR_COMMUNITIES_READERS IMMEDIATE;
COMMIT;
TRUNCATE HOMEPAGE.NR_ACTIVITIES_READERS IMMEDIATE;
COMMIT;
TRUNCATE HOMEPAGE.NR_BLOGS_READERS IMMEDIATE;
COMMIT;
TRUNCATE HOMEPAGE.NR_BOOKMARKS_READERS IMMEDIATE;
COMMIT;
TRUNCATE HOMEPAGE.NR_FILES_READERS IMMEDIATE;
COMMIT;
TRUNCATE HOMEPAGE.NR_FORUMS_READERS IMMEDIATE;
COMMIT;
TRUNCATE HOMEPAGE.NR_WIKIS_READERS IMMEDIATE;
COMMIT;
TRUNCATE HOMEPAGE.NR_TAGS_READERS IMMEDIATE;
COMMIT;
TRUNCATE HOMEPAGE.NR_STATUS_UPDATE_READERS IMMEDIATE;
COMMIT;
TRUNCATE HOMEPAGE.NR_EXTERNAL_READERS IMMEDIATE;
COMMIT;
TRUNCATE HOMEPAGE.NR_DISCOVERY_VIEW IMMEDIATE;
COMMIT;
TRUNCATE HOMEPAGE.NR_PROFILES_VIEW IMMEDIATE;
COMMIT;
TRUNCATE HOMEPAGE.NR_ACTIONABLE_READERS IMMEDIATE;
COMMIT;

TRUNCATE HOMEPAGE.NR_NOTIFICATION_SENT_READERS IMMEDIATE;
COMMIT;
TRUNCATE HOMEPAGE.NR_NOTIFICATION_RECEIV_READERS IMMEDIATE;
COMMIT;
TRUNCATE HOMEPAGE.NR_TOPICS_READERS IMMEDIATE;
COMMIT;
TRUNCATE HOMEPAGE.NR_MENTIONS_READERS IMMEDIATE;
COMMIT;
TRUNCATE HOMEPAGE.NR_SAVED_READERS IMMEDIATE;
COMMIT;


TRUNCATE HOMEPAGE.BOARD_MENTIONS IMMEDIATE;
COMMIT;
TRUNCATE HOMEPAGE.BOARD_CURRENT_STATUS IMMEDIATE;
COMMIT;
TRUNCATE HOMEPAGE.BOARD_OBJECT_REFERENCE IMMEDIATE;   
COMMIT;
TRUNCATE HOMEPAGE.BOARD_RECOMMENDATIONS IMMEDIATE;
COMMIT;
TRUNCATE HOMEPAGE.BOARD_COMMENTS IMMEDIATE;   
COMMIT;
TRUNCATE HOMEPAGE.BOARD_ENTRIES IMMEDIATE;
COMMIT;
TRUNCATE HOMEPAGE.BOARD IMMEDIATE;
COMMIT;

TRUNCATE HOMEPAGE.NR_NEWS_COMMENT_CONTENT IMMEDIATE;
COMMIT;
TRUNCATE HOMEPAGE.NR_NEWS_STATUS_CONTENT IMMEDIATE;
COMMIT;
TRUNCATE HOMEPAGE.NR_NEWS_STATUS_COMMENT IMMEDIATE;
COMMIT;
TRUNCATE HOMEPAGE.NR_NEWS_STATUS_NETWORK IMMEDIATE;
COMMIT;

--------------------------------------------


-- FK ENTRIES
ALTER TABLE HOMEPAGE.NR_STORIES
  	ADD CONSTRAINT FK_ENTRY_ID FOREIGN KEY (ENTRY_ID)
	REFERENCES HOMEPAGE.NR_ENTRIES (ENTRY_ID);   
COMMIT;

ALTER TABLE HOMEPAGE.NR_STORIES 
	ADD CONSTRAINT FK_STORIES_ORG_ID FOREIGN KEY (ORGANIZATION_ID) 
	REFERENCES HOMEPAGE.MT_ORGANIZATION (ORGANIZATION_ID);
COMMIT;

-- BOARD_RECOMMENDATIONS
ALTER TABLE HOMEPAGE.BOARD_RECOMMENDATIONS
	ADD CONSTRAINT FK_BRD_RECOMMENDER FOREIGN KEY (RECOMMENDER_ID)
	REFERENCES HOMEPAGE.PERSON (PERSON_ID);

-- BOARD tables	
ALTER TABLE HOMEPAGE.BOARD_COMMENTS
        ADD CONSTRAINT FK_BRD_COM_ENTRY FOREIGN KEY (ENTRY_ID)
        REFERENCES HOMEPAGE.BOARD_ENTRIES (ENTRY_ID);

ALTER TABLE HOMEPAGE.BOARD_OBJECT_REFERENCE
	ADD CONSTRAINT FK_BRD_OBJ_ENTRY FOREIGN KEY (ENTRY_ID)
	REFERENCES HOMEPAGE.BOARD_ENTRIES (ENTRY_ID);

ALTER TABLE HOMEPAGE.BOARD_OBJECT_REFERENCE
	ADD CONSTRAINT FK_BRD_AUTHOR_ID FOREIGN KEY (AUTHOR_ID)
	REFERENCES HOMEPAGE.PERSON (PERSON_ID);

ALTER TABLE HOMEPAGE.BOARD_CURRENT_STATUS
	ADD CONSTRAINT FK_CUR_ST_ACTOR_ID FOREIGN KEY (ACTOR_UUID)
	REFERENCES HOMEPAGE.PERSON(PERSON_ID);

ALTER TABLE HOMEPAGE.BOARD_CURRENT_STATUS
	ADD CONSTRAINT FK_CUR_ST_ENTRY_ID FOREIGN KEY (ENTRY_ID)
	REFERENCES HOMEPAGE.BOARD_ENTRIES(ENTRY_ID);

ALTER TABLE HOMEPAGE.BOARD 
	ADD CONSTRAINT FK_BRD_OWNER FOREIGN KEY (BOARD_OWNER_ASSOC_ID) 
	REFERENCES HOMEPAGE.PERSON (PERSON_ID);

ALTER TABLE HOMEPAGE.BOARD 
	ADD CONSTRAINT FK_BRD_CREATED FOREIGN KEY (CREATED_BY) 
	REFERENCES HOMEPAGE.PERSON (PERSON_ID);	

ALTER TABLE HOMEPAGE.BOARD 
	ADD CONSTRAINT FK_BRD_LASTUPDATE FOREIGN KEY (LASTUPDATE_BY) 
	REFERENCES HOMEPAGE.PERSON (PERSON_ID);

ALTER TABLE HOMEPAGE.BOARD_ENTRIES
	ADD CONSTRAINT FK_CONTAINER_ID FOREIGN KEY (CONTAINER_ID) 
	REFERENCES HOMEPAGE.BOARD (BOARD_CONTAINER_ID);

ALTER TABLE HOMEPAGE.NR_NEWS_COMMENT_CONTENT
  	ADD CONSTRAINT "FK_C_COMMENT_ID" FOREIGN KEY ("NEWS_STATUS_COMMENT_ID")
	REFERENCES HOMEPAGE.NR_NEWS_STATUS_COMMENT("NEWS_STATUS_COMMENT_ID");

COMMIT;

-----------------------------------------------------------------------------------
-- [START] FK KEY FROM READERS TO STORIES TABLE
-----------------------------------------------------------------------------------
-- adding the fk
ALTER TABLE HOMEPAGE.NR_AGGREGATED_READERS 
	ADD CONSTRAINT FK_AGG_READERS_STR FOREIGN KEY (STORY_ID)
	REFERENCES HOMEPAGE.NR_STORIES (STORY_ID);
COMMIT;

ALTER TABLE HOMEPAGE.NR_RESPONSES_READERS 
	ADD CONSTRAINT FK_RES_READERS_STR FOREIGN KEY (STORY_ID)
	REFERENCES HOMEPAGE.NR_STORIES (STORY_ID);
COMMIT;

ALTER TABLE HOMEPAGE.NR_PROFILES_READERS 
	ADD CONSTRAINT FK_PRF_READERS_STR FOREIGN KEY (STORY_ID)
	REFERENCES HOMEPAGE.NR_STORIES (STORY_ID);
COMMIT;	
	
ALTER TABLE HOMEPAGE.NR_COMMUNITIES_READERS
	ADD CONSTRAINT FK_COM_READERS_STR FOREIGN KEY (STORY_ID)
	REFERENCES HOMEPAGE.NR_STORIES (STORY_ID);
COMMIT;
	 
ALTER TABLE HOMEPAGE.NR_ACTIVITIES_READERS
	ADD CONSTRAINT FK_ACI_READERS_STR FOREIGN KEY (STORY_ID)
	REFERENCES HOMEPAGE.NR_STORIES (STORY_ID);
COMMIT;
	 
ALTER TABLE HOMEPAGE.NR_BLOGS_READERS
	ADD CONSTRAINT FK_BLG_READERS_STR FOREIGN KEY (STORY_ID)
	REFERENCES HOMEPAGE.NR_STORIES (STORY_ID);
COMMIT;
	 
ALTER TABLE HOMEPAGE.NR_BOOKMARKS_READERS
	ADD CONSTRAINT FK_BKM_READERS_STR FOREIGN KEY (STORY_ID)
	REFERENCES HOMEPAGE.NR_STORIES (STORY_ID);
COMMIT;
	 
ALTER TABLE HOMEPAGE.NR_FILES_READERS
	ADD CONSTRAINT FK_FIL_READERS_STR FOREIGN KEY (STORY_ID)
	REFERENCES HOMEPAGE.NR_STORIES (STORY_ID);
COMMIT;

ALTER TABLE HOMEPAGE.NR_FORUMS_READERS
	ADD CONSTRAINT FK_FRM_READERS_STR FOREIGN KEY (STORY_ID)
	REFERENCES HOMEPAGE.NR_STORIES (STORY_ID);
COMMIT;
	 
ALTER TABLE HOMEPAGE.NR_WIKIS_READERS
	ADD CONSTRAINT FK_WIK_READERS_STR FOREIGN KEY (STORY_ID)
	REFERENCES HOMEPAGE.NR_STORIES (STORY_ID);
COMMIT;

ALTER TABLE HOMEPAGE.NR_TAGS_READERS
	ADD CONSTRAINT FK_TAG_READERS_STR FOREIGN KEY (STORY_ID)
	REFERENCES HOMEPAGE.NR_STORIES (STORY_ID);
COMMIT;

ALTER TABLE HOMEPAGE.NR_STATUS_UPDATE_READERS
	ADD CONSTRAINT FK_STA_READERS_STR FOREIGN KEY (STORY_ID)
	REFERENCES HOMEPAGE.NR_STORIES (STORY_ID);
COMMIT;	
	 
ALTER TABLE HOMEPAGE.NR_EXTERNAL_READERS
	ADD CONSTRAINT FK_EXT_READERS_STR FOREIGN KEY (STORY_ID)
	REFERENCES HOMEPAGE.NR_STORIES (STORY_ID);
COMMIT;	
	
ALTER TABLE HOMEPAGE.NR_ACTIONABLE_READERS
	ADD CONSTRAINT FK_ACT_READERS_STR FOREIGN KEY (STORY_ID)
	REFERENCES HOMEPAGE.NR_STORIES (STORY_ID);
COMMIT;	
	
ALTER TABLE HOMEPAGE.NR_SAVED_READERS
	ADD CONSTRAINT FK_SAV_READERS_STR FOREIGN KEY (STORY_ID)
	REFERENCES HOMEPAGE.NR_STORIES (STORY_ID);
COMMIT;
	 
ALTER TABLE HOMEPAGE.NR_DISCOVERY_VIEW
	ADD CONSTRAINT FK_DIS_READERS_STR FOREIGN KEY (STORY_ID)
	REFERENCES HOMEPAGE.NR_STORIES (STORY_ID);
COMMIT;

ALTER TABLE HOMEPAGE.NR_PROFILES_VIEW
	ADD CONSTRAINT FK_PRO_READERS_STR FOREIGN KEY (STORY_ID)
	REFERENCES HOMEPAGE.NR_STORIES (STORY_ID);
COMMIT;
	 
ALTER TABLE HOMEPAGE.NR_NOTIFICATION_SENT_READERS
	ADD CONSTRAINT FK_NOT_READERS_STR FOREIGN KEY (STORY_ID)
	REFERENCES HOMEPAGE.NR_STORIES (STORY_ID);
COMMIT;

ALTER TABLE HOMEPAGE.NR_NOTIFICATION_RECEIV_READERS
	ADD CONSTRAINT FK_REC_READERS_STR FOREIGN KEY (STORY_ID)
	REFERENCES HOMEPAGE.NR_STORIES (STORY_ID);    
COMMIT;

ALTER TABLE HOMEPAGE.NR_TOPICS_READERS
	ADD CONSTRAINT FK_TOP_READERS_STR FOREIGN KEY (STORY_ID)
	REFERENCES HOMEPAGE.NR_STORIES (STORY_ID); 
COMMIT;	

ALTER TABLE HOMEPAGE.NR_MENTIONS_READERS
	ADD CONSTRAINT FK_MEN_READERS_STR FOREIGN KEY (STORY_ID)
	REFERENCES HOMEPAGE.NR_STORIES (STORY_ID); 
COMMIT;	




