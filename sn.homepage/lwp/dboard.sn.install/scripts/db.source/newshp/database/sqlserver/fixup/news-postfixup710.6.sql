-- ***************************************************************** 
--                                                                   
-- IBM Confidential                                                  
--                                                                   
-- OCO Source Materials                                              
--                                                                   
-- Copyright IBM Corp. 2016, 2017                             
--                                                                   
-- The source code for this program is not published or otherwise    
-- divested of its trade secrets, irrespective of what has been      
-- deposited with the U.S. Copyright Office.                         
--                                                                   
-- ***************************************************************** 

-- {COPYRIGHT}

-- SQL Server changes DATETIME to DATETIME2(3) only

-- NR_SOURCE_TYPE_DEFAULT

ALTER TABLE HOMEPAGE.NR_SOURCE_TYPE_DEFAULT ALTER COLUMN PUBLISHED DATETIME2(3);
ALTER TABLE HOMEPAGE.NR_SOURCE_TYPE_DEFAULT ALTER COLUMN UPDATED DATETIME2(3);
GO

-- NR_SOURCE_TYPE

ALTER TABLE HOMEPAGE.NR_SOURCE_TYPE ALTER COLUMN PUBLISHED DATETIME2(3);
ALTER TABLE HOMEPAGE.NR_SOURCE_TYPE ALTER COLUMN UPDATED DATETIME2(3);
GO

-- NR_NEWS_STATUS_NETWORK

DROP INDEX NR_NEWS_SN_READER_FOLL ON HOMEPAGE.NR_NEWS_STATUS_NETWORK;
DROP INDEX NR_NEWS_SN_READER_NETW ON HOMEPAGE.NR_NEWS_STATUS_NETWORK;
DROP INDEX NEWS_STATUS_NET_R_U ON HOMEPAGE.NR_NEWS_STATUS_NETWORK;
DROP INDEX NR_STATUS_NETWORK_DATE ON HOMEPAGE.NR_NEWS_STATUS_NETWORK;
DROP INDEX NR_STATUS_UPDATE_IX ON HOMEPAGE.NR_NEWS_STATUS_NETWORK;
GO

ALTER TABLE HOMEPAGE.NR_NEWS_STATUS_NETWORK ALTER COLUMN CREATION_DATE DATETIME2(3);
ALTER TABLE HOMEPAGE.NR_NEWS_STATUS_NETWORK ALTER COLUMN UPDATE_DATE DATETIME2(3);
GO

CREATE INDEX NR_NEWS_SN_READER_FOLL
    ON HOMEPAGE.NR_NEWS_STATUS_NETWORK (UPDATE_DATE DESC, READER_ID, IS_FOLLOW_NEWS);
CREATE INDEX NR_NEWS_SN_READER_NETW
    ON HOMEPAGE.NR_NEWS_STATUS_NETWORK (UPDATE_DATE DESC, READER_ID, IS_NETWORK_NEWS);
CREATE INDEX NEWS_STATUS_NET_R_U 
	ON HOMEPAGE.NR_NEWS_STATUS_NETWORK (READER_ID, UPDATE_DATE DESC);
CREATE INDEX NR_STATUS_NETWORK_DATE
    ON HOMEPAGE.NR_NEWS_STATUS_NETWORK (UPDATE_DATE ASC);
CREATE INDEX NR_STATUS_UPDATE_IX
	ON HOMEPAGE.NR_NEWS_STATUS_NETWORK (READER_ID, UPDATE_DATE ASC, CREATION_DATE ASC, ITEM_ID, ACTOR_UUID);
GO

-- NR_NEWS_STATUS_COMMENT

DROP INDEX NR_STATUS_COMMENT_DATE ON HOMEPAGE.NR_NEWS_STATUS_COMMENT;
GO

ALTER TABLE HOMEPAGE.NR_NEWS_STATUS_COMMENT ALTER COLUMN CREATION_DATE DATETIME2(3);
GO

CREATE INDEX NR_STATUS_COMMENT_DATE
    ON HOMEPAGE.NR_NEWS_STATUS_COMMENT (CREATION_DATE ASC);
GO

-- NR_NEWS_STATUS_CONTENT

DROP INDEX NR_NEWS_SC_CD ON HOMEPAGE.NR_NEWS_STATUS_CONTENT;
DROP INDEX NR_SC_UDATE ON HOMEPAGE.NR_NEWS_STATUS_CONTENT;
GO

ALTER TABLE HOMEPAGE.NR_NEWS_STATUS_CONTENT ALTER COLUMN CREATION_DATE DATETIME2(3);
ALTER TABLE HOMEPAGE.NR_NEWS_STATUS_CONTENT ALTER COLUMN UPDATE_DATE DATETIME2(3);
GO

CREATE INDEX NR_NEWS_SC_CD
    ON HOMEPAGE.NR_NEWS_STATUS_CONTENT (CREATION_DATE ASC);

CREATE INDEX NR_SC_UDATE
    ON HOMEPAGE.NR_NEWS_STATUS_CONTENT (UPDATE_DATE ASC);     
GO

-- NR_RESOURCE

DROP INDEX NR_RES_LU_UIDX ON HOMEPAGE.NR_RESOURCE;
GO

ALTER TABLE HOMEPAGE.NR_RESOURCE ALTER COLUMN LAST_UPDATE DATETIME2(3);
GO

CREATE UNIQUE INDEX NR_RES_LU_UIDX
	ON HOMEPAGE.NR_RESOURCE (RESOURCE_ID, RESOURCE_TYPE, LAST_UPDATE DESC, CONTAINER_NAME DESC);
GO

-- NR_STORIES_CONTENT

DROP INDEX NR_STORIES_CONTENT_DATE ON HOMEPAGE.NR_STORIES_CONTENT;
GO

ALTER TABLE HOMEPAGE.NR_STORIES_CONTENT ALTER COLUMN CREATION_DATE DATETIME2(3) NOT NULL;
GO

CREATE INDEX NR_STORIES_CONTENT_DATE
    ON HOMEPAGE.NR_STORIES_CONTENT (CREATION_DATE ASC);
GO

-- EMD_TRANCHE

ALTER TABLE HOMEPAGE.EMD_TRANCHE ALTER COLUMN LAST_PROCESSED_DAILY DATETIME2(3);
ALTER TABLE HOMEPAGE.EMD_TRANCHE ALTER COLUMN LAST_PROCESSED_WEEKLY DATETIME2(3);
ALTER TABLE HOMEPAGE.EMD_TRANCHE ALTER COLUMN LAST_STARTED_DAILY DATETIME2(3);
ALTER TABLE HOMEPAGE.EMD_TRANCHE ALTER COLUMN LAST_STARTED_WEEKLY DATETIME2(3);
GO

-- NR_ENTRIES

ALTER TABLE HOMEPAGE.NR_ENTRIES ALTER COLUMN ITEM_CREATION_DATE DATETIME2(3);
ALTER TABLE HOMEPAGE.NR_ENTRIES ALTER COLUMN ITEM_UPDATE_DATE DATETIME2(3);
ALTER TABLE HOMEPAGE.NR_ENTRIES ALTER COLUMN LAST_DATE_COMMENT DATETIME2(3);
ALTER TABLE HOMEPAGE.NR_ENTRIES ALTER COLUMN PREV_DATE_COMMENT DATETIME2(3);
ALTER TABLE HOMEPAGE.NR_ENTRIES ALTER COLUMN LAST_UPDATE_DATE_COMMENT DATETIME2(3);
ALTER TABLE HOMEPAGE.NR_ENTRIES ALTER COLUMN PREV_UPDATE_DATE_COMMENT DATETIME2(3);
ALTER TABLE HOMEPAGE.NR_ENTRIES ALTER COLUMN LAST_UPDATE_RECORD DATETIME2(3);
ALTER TABLE HOMEPAGE.NR_ENTRIES ALTER COLUMN ITEM_CORRELATION_CREATION_DATE DATETIME2(3);
GO

-- NR_STORIES

DROP INDEX NR_STORIES_DATE ON HOMEPAGE.NR_STORIES;
DROP INDEX NR_STORY_CD_IDX ON HOMEPAGE.NR_STORIES;
GO

ALTER TABLE HOMEPAGE.NR_STORIES ALTER COLUMN CREATION_DATE DATETIME2(3) NOT NULL;
ALTER TABLE HOMEPAGE.NR_STORIES ALTER COLUMN EVENT_TIME DATETIME2(3);
ALTER TABLE HOMEPAGE.NR_STORIES ALTER COLUMN ITEM_UPDATE_DATE DATETIME2(3);
ALTER TABLE HOMEPAGE.NR_STORIES ALTER COLUMN ITEM_CORRELATION_UPDATE_DATE DATETIME2(3);
ALTER TABLE HOMEPAGE.NR_STORIES ALTER COLUMN ITEM_CREATION_DATE DATETIME2(3);
ALTER TABLE HOMEPAGE.NR_STORIES ALTER COLUMN ITEM_CORRELATION_CREATION_DATE DATETIME2(3);
GO

CREATE INDEX NR_STORIES_DATE
	ON HOMEPAGE.NR_STORIES (CREATION_DATE DESC);
CREATE INDEX NR_STORY_CD_IDX 
	ON HOMEPAGE.NR_STORIES (CREATION_DATE ASC, STORY_ID);    
GO

-- NR_ENTRIES_ARCHIVE

ALTER TABLE HOMEPAGE.NR_ENTRIES_ARCHIVE ALTER COLUMN ITEM_CREATION_DATE DATETIME2(3);
ALTER TABLE HOMEPAGE.NR_ENTRIES_ARCHIVE ALTER COLUMN ITEM_UPDATE_DATE DATETIME2(3);
ALTER TABLE HOMEPAGE.NR_ENTRIES_ARCHIVE ALTER COLUMN LAST_DATE_COMMENT DATETIME2(3);
ALTER TABLE HOMEPAGE.NR_ENTRIES_ARCHIVE ALTER COLUMN PREV_DATE_COMMENT DATETIME2(3);
ALTER TABLE HOMEPAGE.NR_ENTRIES_ARCHIVE ALTER COLUMN LAST_UPDATE_DATE_COMMENT DATETIME2(3);
ALTER TABLE HOMEPAGE.NR_ENTRIES_ARCHIVE ALTER COLUMN PREV_UPDATE_DATE_COMMENT DATETIME2(3);
ALTER TABLE HOMEPAGE.NR_ENTRIES_ARCHIVE ALTER COLUMN LAST_UPDATE_RECORD DATETIME2(3);
ALTER TABLE HOMEPAGE.NR_ENTRIES_ARCHIVE ALTER COLUMN ITEM_CORRELATION_CREATION_DATE DATETIME2(3);
GO

-- NR_AGGREGATED_READERS 

DROP INDEX AGGREGATED_READERS_CD_IX ON HOMEPAGE.NR_AGGREGATED_READERS;
DROP INDEX AGGREGATED_READERS_RLL_IIX ON HOMEPAGE.NR_AGGREGATED_READERS;
DROP INDEX AGGREGATED_READERS_DEL_SERV_IX ON HOMEPAGE.NR_AGGREGATED_READERS;
DROP INDEX MPM_AGG_READERS_1B ON HOMEPAGE.NR_AGGREGATED_READERS;
DROP INDEX MWC_AGG_READERS_1B ON HOMEPAGE.NR_AGGREGATED_READERS;
GO

ALTER TABLE HOMEPAGE.NR_AGGREGATED_READERS ALTER COLUMN CREATION_DATE DATETIME2(3) NOT NULL;
ALTER TABLE HOMEPAGE.NR_AGGREGATED_READERS ALTER COLUMN EVENT_TIME DATETIME2(3);
GO

CREATE INDEX AGGREGATED_READERS_CD_IX 
 	ON HOMEPAGE.NR_AGGREGATED_READERS (STORY_ID, CREATION_DATE DESC); 
CREATE INDEX AGGREGATED_READERS_RLL_IIX 
 	ON HOMEPAGE.NR_AGGREGATED_READERS (READER_ID, CATEGORY_TYPE, IS_VISIBLE, ORGANIZATION_ID, CREATION_DATE DESC); 
CREATE INDEX AGGREGATED_READERS_DEL_SERV_IX 
 	ON HOMEPAGE.NR_AGGREGATED_READERS (CREATION_DATE DESC, IS_BROADCAST); 
CREATE INDEX MPM_AGG_READERS_1B 
	ON HOMEPAGE.NR_AGGREGATED_READERS (READER_ID, CATEGORY_TYPE, IS_VISIBLE, USE_IN_ROLLUP, ORGANIZATION_ID, CREATION_DATE, SOURCE_TYPE);
CREATE INDEX MWC_AGG_READERS_1B
    ON HOMEPAGE.NR_AGGREGATED_READERS (ROLLUP_ENTRY_ID, CATEGORY_TYPE, READER_ID, USE_IN_ROLLUP, ORGANIZATION_ID, CREATION_DATE);
GO

-- NR_STATUS_UPDATE_READERS 

DROP INDEX STATUS_READERS_CD_IX ON HOMEPAGE.NR_STATUS_UPDATE_READERS;
DROP INDEX STATUS_READERS_RLL_IIX ON HOMEPAGE.NR_STATUS_UPDATE_READERS;
DROP INDEX STATUS_READERS_DEL_SERV_IX ON HOMEPAGE.NR_STATUS_UPDATE_READERS;
GO

ALTER TABLE HOMEPAGE.NR_STATUS_UPDATE_READERS ALTER COLUMN CREATION_DATE DATETIME2(3) NOT NULL;
ALTER TABLE HOMEPAGE.NR_STATUS_UPDATE_READERS ALTER COLUMN EVENT_TIME DATETIME2(3);
GO

CREATE INDEX STATUS_READERS_CD_IX 
 	ON HOMEPAGE.NR_STATUS_UPDATE_READERS (STORY_ID, CREATION_DATE DESC); 
CREATE INDEX STATUS_READERS_RLL_IIX 
 	ON HOMEPAGE.NR_STATUS_UPDATE_READERS (READER_ID, CATEGORY_TYPE, IS_VISIBLE, ORGANIZATION_ID, CREATION_DATE DESC); 
CREATE INDEX STATUS_READERS_DEL_SERV_IX 
 	ON HOMEPAGE.NR_STATUS_UPDATE_READERS (CREATION_DATE DESC, IS_STORY_COMM); 
GO

-- NR_EXTERNAL_READERS 

DROP INDEX EXTERNAL_READERS_CD_IX ON HOMEPAGE.NR_EXTERNAL_READERS;
DROP INDEX EXTERNAL_READERS_RLL_IIX ON HOMEPAGE.NR_EXTERNAL_READERS;
DROP INDEX EXTERNAL_READERS_DEL_SERV_IX ON HOMEPAGE.NR_EXTERNAL_READERS;
GO

ALTER TABLE HOMEPAGE.NR_EXTERNAL_READERS ALTER COLUMN CREATION_DATE DATETIME2(3) NOT NULL;
ALTER TABLE HOMEPAGE.NR_EXTERNAL_READERS ALTER COLUMN EVENT_TIME DATETIME2(3);
GO

CREATE INDEX EXTERNAL_READERS_CD_IX 
 	ON HOMEPAGE.NR_EXTERNAL_READERS (STORY_ID, CREATION_DATE DESC); 
CREATE INDEX EXTERNAL_READERS_RLL_IIX 
 	ON HOMEPAGE.NR_EXTERNAL_READERS (READER_ID, CATEGORY_TYPE, IS_VISIBLE, ORGANIZATION_ID, CREATION_DATE DESC); 
CREATE INDEX EXTERNAL_READERS_DEL_SERV_IX 
 	ON HOMEPAGE.NR_EXTERNAL_READERS (CREATION_DATE DESC); 
GO

-- NR_ACTIONABLE_READERS 

DROP INDEX ACTIONABLE_READERS_CD_IX ON HOMEPAGE.NR_ACTIONABLE_READERS;
DROP INDEX ACTIONABLE_READERS_RLL_IIX ON HOMEPAGE.NR_ACTIONABLE_READERS;
DROP INDEX ACTIONABLE_READERS_DEL_SERV_IX ON HOMEPAGE.NR_ACTIONABLE_READERS;
GO

ALTER TABLE HOMEPAGE.NR_ACTIONABLE_READERS ALTER COLUMN CREATION_DATE DATETIME2(3) NOT NULL;
ALTER TABLE HOMEPAGE.NR_ACTIONABLE_READERS ALTER COLUMN EVENT_TIME DATETIME2(3);
GO

CREATE INDEX ACTIONABLE_READERS_CD_IX 
 	ON HOMEPAGE.NR_ACTIONABLE_READERS (STORY_ID, CREATION_DATE DESC); 
CREATE INDEX ACTIONABLE_READERS_RLL_IIX 
 	ON HOMEPAGE.NR_ACTIONABLE_READERS (READER_ID, CATEGORY_TYPE, IS_VISIBLE, ORGANIZATION_ID, CREATION_DATE DESC); 
CREATE INDEX ACTIONABLE_READERS_DEL_SERV_IX 
 	ON HOMEPAGE.NR_ACTIONABLE_READERS (CREATION_DATE DESC); 
GO

-- BOARD

ALTER TABLE HOMEPAGE.BOARD ALTER COLUMN CREATED DATETIME2(3) NOT NULL;
ALTER TABLE HOMEPAGE.BOARD ALTER COLUMN LASTUPDATE DATETIME2(3) NOT NULL;
GO

-- BOARD_ENTRIES

DROP INDEX NEWS_BRD_SL_UPDATE ON HOMEPAGE.BOARD_ENTRIES;
DROP INDEX CREATION_ITEM_IDX ON HOMEPAGE.BOARD_ENTRIES;
DROP INDEX BRD_SL_UPDATED_DEL ON HOMEPAGE.BOARD_ENTRIES;
DROP INDEX SEEDLIST_BRD_IDX ON HOMEPAGE.BOARD_ENTRIES;
DROP INDEX BRD_IS_DEL_CDATE_ACT_ENT ON HOMEPAGE.BOARD_ENTRIES;
GO

ALTER TABLE HOMEPAGE.BOARD_ENTRIES ALTER COLUMN CREATION_DATE DATETIME2(3) NOT NULL;
ALTER TABLE HOMEPAGE.BOARD_ENTRIES ALTER COLUMN UPDATE_DATE DATETIME2(3) NOT NULL;
ALTER TABLE HOMEPAGE.BOARD_ENTRIES ALTER COLUMN SL_UPDATE_DATE DATETIME2(3) NOT NULL;
ALTER TABLE HOMEPAGE.BOARD_ENTRIES ALTER COLUMN CREATION_DATE_DISPLAY DATETIME2(3);
ALTER TABLE HOMEPAGE.BOARD_ENTRIES ALTER COLUMN UPDATE_DATE_DISPLAY DATETIME2(3);
GO

CREATE INDEX NEWS_BRD_SL_UPDATE
    ON HOMEPAGE.BOARD_ENTRIES (SL_UPDATE_DATE ASC);
CREATE INDEX CREATION_ITEM_IDX 
	ON HOMEPAGE.BOARD_ENTRIES (CREATION_DATE_DISPLAY DESC, ITEM_ID DESC);
CREATE INDEX BRD_SL_UPDATED_DEL 
	ON HOMEPAGE.BOARD_ENTRIES (SL_UPDATE_DATE ASC, SL_IS_DELETED);
CREATE INDEX SEEDLIST_BRD_IDX 
	ON HOMEPAGE.BOARD_ENTRIES (SL_UPDATE_DATE ASC, ENTRY_ID);
CREATE INDEX BRD_IS_DEL_CDATE_ACT_ENT
	ON HOMEPAGE.BOARD_ENTRIES (SL_IS_DELETED, CREATION_DATE DESC, ACTOR_UUID, ENTRY_TYPE);	
GO

-- BOARD_COMMENTS

DROP INDEX CREATION_DATE_IDX ON HOMEPAGE.BOARD_COMMENTS;
DROP INDEX ITEM_CORR_CREATION_IDX ON HOMEPAGE.BOARD_COMMENTS;
DROP INDEX CREATION_DATE_ITEM_IDX ON HOMEPAGE.BOARD_COMMENTS;
GO

ALTER TABLE HOMEPAGE.BOARD_COMMENTS ALTER COLUMN CREATION_DATE DATETIME2(3) NOT NULL;
ALTER TABLE HOMEPAGE.BOARD_COMMENTS ALTER COLUMN UPDATE_DATE DATETIME2(3);
ALTER TABLE HOMEPAGE.BOARD_COMMENTS ALTER COLUMN CREATION_DATE_DISPLAY DATETIME2(3);
ALTER TABLE HOMEPAGE.BOARD_COMMENTS ALTER COLUMN UPDATE_DATE_DISPLAY DATETIME2(3);
GO

CREATE INDEX CREATION_DATE_IDX 
	ON HOMEPAGE.BOARD_COMMENTS (CREATION_DATE ASC);
CREATE INDEX ITEM_CORR_CREATION_IDX 
	ON HOMEPAGE.BOARD_COMMENTS (ENTRY_ID, CREATION_DATE ASC);
CREATE INDEX CREATION_DATE_ITEM_IDX
	ON HOMEPAGE.BOARD_COMMENTS (CREATION_DATE ASC, ITEM_ID);    
GO

-- BOARD_OBJECT_REFERENCE

ALTER TABLE HOMEPAGE.BOARD_OBJECT_REFERENCE ALTER COLUMN CREATION_DATE DATETIME2(3);
GO

-- BOARD_RECOMMENDATIONS

ALTER TABLE HOMEPAGE.BOARD_RECOMMENDATIONS ALTER COLUMN CREATION_DATE DATETIME2(3);
ALTER TABLE HOMEPAGE.BOARD_RECOMMENDATIONS ALTER COLUMN CREATION_DATE_DISPLAY DATETIME2(3);
GO

-- BOARD_CURRENT_STATUS

DROP INDEX CURRENT_STATUS_INDEX ON HOMEPAGE.BOARD_CURRENT_STATUS;
GO

ALTER TABLE HOMEPAGE.BOARD_CURRENT_STATUS ALTER COLUMN CURRENT_STATUS_SET DATETIME2(3) NOT NULL;
GO

CREATE INDEX CURRENT_STATUS_INDEX 
	ON HOMEPAGE.BOARD_CURRENT_STATUS (ACTOR_UUID ASC, CURRENT_STATUS_SET ASC, CURRENT_STATUS_ID ASC, ENTRY_ID ASC);
GO

-- NR_PROFILES_VIEW 

DROP INDEX PROFILES_VIEW_CD_IX ON HOMEPAGE.NR_PROFILES_VIEW;
DROP INDEX PROFILES_VIEW_RLL_IIX ON HOMEPAGE.NR_PROFILES_VIEW;
DROP INDEX PROFILES_VIEW_DEL_SERV_IX ON HOMEPAGE.NR_PROFILES_VIEW;
DROP INDEX PROFILES_VIEW_ORG_IIDX ON HOMEPAGE.NR_PROFILES_VIEW;
GO

ALTER TABLE HOMEPAGE.NR_PROFILES_VIEW ALTER COLUMN CREATION_DATE DATETIME2(3) NOT NULL;
ALTER TABLE HOMEPAGE.NR_PROFILES_VIEW ALTER COLUMN EVENT_TIME DATETIME2(3);
GO

CREATE INDEX PROFILES_VIEW_CD_IX 
 	ON HOMEPAGE.NR_PROFILES_VIEW (STORY_ID, CREATION_DATE DESC); 
CREATE INDEX PROFILES_VIEW_RLL_IIX 
 	ON HOMEPAGE.NR_PROFILES_VIEW (READER_ID, CATEGORY_TYPE, IS_VISIBLE, ORGANIZATION_ID, CREATION_DATE DESC); 
CREATE INDEX PROFILES_VIEW_DEL_SERV_IX 
 	ON HOMEPAGE.NR_PROFILES_VIEW (CREATION_DATE DESC, IS_BROADCAST); 
CREATE INDEX PROFILES_VIEW_ORG_IIDX 
 	ON HOMEPAGE.NR_PROFILES_VIEW (ORGANIZATION_ID, IS_VISIBLE, IS_BROADCAST, ROLLUP_ENTRY_ID, CREATION_DATE DESC); 
GO

-- NR_NOTIFICATION_SENT_READERS 

DROP INDEX NOTIFICA_READERS_CD_IX ON HOMEPAGE.NR_NOTIFICATION_SENT_READERS;
DROP INDEX NOTIFICA_READERS_RLL_IIX ON HOMEPAGE.NR_NOTIFICATION_SENT_READERS;
DROP INDEX NOTIFICA_READERS_DEL_SERV_IX ON HOMEPAGE.NR_NOTIFICATION_SENT_READERS;
GO

ALTER TABLE HOMEPAGE.NR_NOTIFICATION_SENT_READERS ALTER COLUMN CREATION_DATE DATETIME2(3) NOT NULL;
ALTER TABLE HOMEPAGE.NR_NOTIFICATION_SENT_READERS ALTER COLUMN EVENT_TIME DATETIME2(3);
GO

CREATE INDEX NOTIFICA_READERS_CD_IX 
 	ON HOMEPAGE.NR_NOTIFICATION_SENT_READERS (STORY_ID, CREATION_DATE DESC); 
CREATE INDEX NOTIFICA_READERS_RLL_IIX 
 	ON HOMEPAGE.NR_NOTIFICATION_SENT_READERS (READER_ID, CATEGORY_TYPE, IS_VISIBLE, ORGANIZATION_ID, CREATION_DATE DESC); 
CREATE INDEX NOTIFICA_READERS_DEL_SERV_IX 
 	ON HOMEPAGE.NR_NOTIFICATION_SENT_READERS (CREATION_DATE DESC); 
GO

-- NR_NOTIFICATION_RECEIV_READERS 

DROP INDEX NOT_REC_READERS_CD_IX ON HOMEPAGE.NR_NOTIFICATION_RECEIV_READERS;
DROP INDEX NOT_REC_READERS_RLL_IIX ON HOMEPAGE.NR_NOTIFICATION_RECEIV_READERS;
DROP INDEX NOT_REC_READERS_DEL_SERV_IX ON HOMEPAGE.NR_NOTIFICATION_RECEIV_READERS;
DROP INDEX NOT_REC_READERS_ROLLUP_IIIX ON HOMEPAGE.NR_NOTIFICATION_RECEIV_READERS;
GO

ALTER TABLE HOMEPAGE.NR_NOTIFICATION_RECEIV_READERS ALTER COLUMN CREATION_DATE DATETIME2(3) NOT NULL;
ALTER TABLE HOMEPAGE.NR_NOTIFICATION_RECEIV_READERS ALTER COLUMN EVENT_TIME DATETIME2(3);
GO

CREATE INDEX NOT_REC_READERS_CD_IX 
 	ON HOMEPAGE.NR_NOTIFICATION_RECEIV_READERS (STORY_ID, CREATION_DATE DESC); 
CREATE INDEX NOT_REC_READERS_RLL_IIX 
 	ON HOMEPAGE.NR_NOTIFICATION_RECEIV_READERS (READER_ID, IS_VISIBLE, ORGANIZATION_ID, CREATION_DATE DESC); 
CREATE INDEX NOT_REC_READERS_DEL_SERV_IX 
 	ON HOMEPAGE.NR_NOTIFICATION_RECEIV_READERS (CREATION_DATE DESC); 
CREATE INDEX NOT_REC_READERS_ROLLUP_IIIX 
 	ON HOMEPAGE.NR_NOTIFICATION_RECEIV_READERS (ROLLUP_ENTRY_ID, READER_ID, IS_VISIBLE, CREATION_DATE DESC); 
GO

-- NR_SAVED_READERS 

DROP INDEX SAVED_READERS_CD_IX ON HOMEPAGE.NR_SAVED_READERS;
DROP INDEX SAVED_READERS_RLL_IIX ON HOMEPAGE.NR_SAVED_READERS;
DROP INDEX SAVED_READERS_DEL_SERV_IX ON HOMEPAGE.NR_SAVED_READERS;
GO

ALTER TABLE HOMEPAGE.NR_SAVED_READERS ALTER COLUMN CREATION_DATE DATETIME2(3) NOT NULL;
ALTER TABLE HOMEPAGE.NR_SAVED_READERS ALTER COLUMN EVENT_TIME DATETIME2(3);
GO

CREATE INDEX SAVED_READERS_CD_IX 
 	ON HOMEPAGE.NR_SAVED_READERS (STORY_ID, CREATION_DATE DESC); 
CREATE INDEX SAVED_READERS_RLL_IIX 
 	ON HOMEPAGE.NR_SAVED_READERS (READER_ID, CATEGORY_TYPE, IS_VISIBLE, ORGANIZATION_ID, CREATION_DATE DESC); 
CREATE INDEX SAVED_READERS_DEL_SERV_IX 
 	ON HOMEPAGE.NR_SAVED_READERS (CREATION_DATE DESC); 
GO

-- NR_TOPICS_READERS 

DROP INDEX TOPICS_READERS_CD_IX ON HOMEPAGE.NR_TOPICS_READERS;
DROP INDEX TOPICS_READERS_RLL_IIX ON HOMEPAGE.NR_TOPICS_READERS;
DROP INDEX TOPICS_READERS_DEL_SERV_IX ON HOMEPAGE.NR_TOPICS_READERS;
GO

ALTER TABLE HOMEPAGE.NR_TOPICS_READERS ALTER COLUMN CREATION_DATE DATETIME2(3) NOT NULL;
ALTER TABLE HOMEPAGE.NR_TOPICS_READERS ALTER COLUMN EVENT_TIME DATETIME2(3);
GO

CREATE INDEX TOPICS_READERS_CD_IX 
 	ON HOMEPAGE.NR_TOPICS_READERS (STORY_ID, CREATION_DATE DESC); 
CREATE INDEX TOPICS_READERS_RLL_IIX 
 	ON HOMEPAGE.NR_TOPICS_READERS (READER_ID, CATEGORY_TYPE, IS_VISIBLE, ORGANIZATION_ID, CREATION_DATE DESC); 
CREATE INDEX TOPICS_READERS_DEL_SERV_IX 
 	ON HOMEPAGE.NR_TOPICS_READERS (CREATION_DATE DESC); 
GO

-- NR_MENTIONS_READERS 

DROP INDEX MENTIONS_READERS_CD_IX ON HOMEPAGE.NR_MENTIONS_READERS;
DROP INDEX MENTIONS_READERS_RLL_IIX ON HOMEPAGE.NR_MENTIONS_READERS;
DROP INDEX MENTIONS_READERS_DEL_SERV_IX ON HOMEPAGE.NR_MENTIONS_READERS;
GO

ALTER TABLE HOMEPAGE.NR_MENTIONS_READERS ALTER COLUMN CREATION_DATE DATETIME2(3) NOT NULL;
ALTER TABLE HOMEPAGE.NR_MENTIONS_READERS ALTER COLUMN EVENT_TIME DATETIME2(3);
GO

CREATE INDEX MENTIONS_READERS_CD_IX 
 	ON HOMEPAGE.NR_MENTIONS_READERS (STORY_ID, CREATION_DATE DESC); 
CREATE INDEX MENTIONS_READERS_RLL_IIX 
 	ON HOMEPAGE.NR_MENTIONS_READERS (READER_ID, CATEGORY_TYPE, IS_VISIBLE, ORGANIZATION_ID, CREATION_DATE DESC); 
CREATE INDEX MENTIONS_READERS_DEL_SERV_IX 
 	ON HOMEPAGE.NR_MENTIONS_READERS (CREATION_DATE DESC); 
GO

-- NR_COMMUNITIES_VIEW 

DROP INDEX COMMUNITIES_VIEW_CD_IX ON HOMEPAGE.NR_COMMUNITIES_VIEW;
DROP INDEX COMMUNITIES_VIEW_RLL_IIX ON HOMEPAGE.NR_COMMUNITIES_VIEW;
DROP INDEX COMMUNITIES_VIEW_DEL_SERV_IX ON HOMEPAGE.NR_COMMUNITIES_VIEW;
GO

ALTER TABLE HOMEPAGE.NR_COMMUNITIES_VIEW ALTER COLUMN CREATION_DATE DATETIME2(3) NOT NULL;
ALTER TABLE HOMEPAGE.NR_COMMUNITIES_VIEW ALTER COLUMN EVENT_TIME DATETIME2(3);
GO

CREATE INDEX COMMUNITIES_VIEW_CD_IX 
 	ON HOMEPAGE.NR_COMMUNITIES_VIEW (STORY_ID, CREATION_DATE DESC); 
CREATE INDEX COMMUNITIES_VIEW_RLL_IIX 
 	ON HOMEPAGE.NR_COMMUNITIES_VIEW (READER_ID, CATEGORY_TYPE, IS_VISIBLE, ORGANIZATION_ID, CREATION_DATE DESC); 
CREATE INDEX COMMUNITIES_VIEW_DEL_SERV_IX 
 	ON HOMEPAGE.NR_COMMUNITIES_VIEW (CREATION_DATE DESC); 
GO

-- NR_AS_SEEDLIST 

DROP INDEX NR_SL_UD_DELETED_VIS ON HOMEPAGE.NR_AS_SEEDLIST;
DROP INDEX NR_SL_UD_DELETED ON HOMEPAGE.NR_AS_SEEDLIST;
DROP INDEX NR_SL_CD_DELETED ON HOMEPAGE.NR_AS_SEEDLIST;
DROP INDEX NR_SL_UD_STR ON HOMEPAGE.NR_AS_SEEDLIST;
DROP INDEX NR_SL_UD_STR_DELETED_VIS_DESC ON HOMEPAGE.NR_AS_SEEDLIST;
DROP INDEX NR_SL_UD_STR_DELETED_VIS_ASC ON HOMEPAGE.NR_AS_SEEDLIST;
DROP INDEX NR_SL_VIS_DELETED_US_STR ON HOMEPAGE.NR_AS_SEEDLIST;
GO

ALTER TABLE HOMEPAGE.NR_AS_SEEDLIST DROP CONSTRAINT NR_AS_SEEDLIST_UPDATE_DATE_DEFAULT;
GO

ALTER TABLE HOMEPAGE.NR_AS_SEEDLIST ALTER COLUMN CREATION_DATE DATETIME2(3) NOT NULL;
ALTER TABLE HOMEPAGE.NR_AS_SEEDLIST ALTER COLUMN UPDATE_DATE DATETIME2(3) NOT NULL;
GO

CREATE INDEX NR_SL_UD_DELETED_VIS
	ON HOMEPAGE.NR_AS_SEEDLIST (UPDATE_DATE DESC, IS_DELETED, IS_VISIBLE);
CREATE INDEX NR_SL_UD_DELETED
	ON HOMEPAGE.NR_AS_SEEDLIST (UPDATE_DATE DESC);
CREATE INDEX NR_SL_CD_DELETED
	ON HOMEPAGE.NR_AS_SEEDLIST (CREATION_DATE DESC);	
CREATE INDEX NR_SL_UD_STR
	ON HOMEPAGE.NR_AS_SEEDLIST (UPDATE_DATE ASC, STORY_ID);
CREATE INDEX NR_SL_UD_STR_DELETED_VIS_DESC
	ON HOMEPAGE.NR_AS_SEEDLIST (UPDATE_DATE DESC, STORY_ID, IS_DELETED, IS_VISIBLE);    
CREATE INDEX NR_SL_UD_STR_DELETED_VIS_ASC
	ON HOMEPAGE.NR_AS_SEEDLIST (UPDATE_DATE ASC, STORY_ID, IS_DELETED, IS_VISIBLE);	
CREATE INDEX NR_SL_VIS_DELETED_US_STR
	ON HOMEPAGE.NR_AS_SEEDLIST (IS_VISIBLE, IS_DELETED, UPDATE_DATE DESC, STORY_ID);
GO

ALTER TABLE HOMEPAGE.NR_AS_SEEDLIST
	ADD CONSTRAINT NR_AS_SEEDLIST_UPDATE_DATE_DEFAULT DEFAULT (getdate()) FOR UPDATE_DATE;
GO

-- NR_AS_CONTENT_INDEX_STATS 

ALTER TABLE HOMEPAGE.NR_AS_CONTENT_INDEX_STATS ALTER COLUMN STAT_UPDATE_DATE DATETIME2(3);
GO

-- IMG_CACHE 

DROP INDEX IMG_CACHE_DEL_BATCH_IDX ON HOMEPAGE.IMG_CACHE;
GO

ALTER TABLE HOMEPAGE.IMG_CACHE ALTER COLUMN CREATION_DATE DATETIME2(3);
ALTER TABLE HOMEPAGE.IMG_CACHE ALTER COLUMN LAST_REQUEST_DATE DATETIME2(3);
GO

CREATE INDEX IMG_CACHE_DEL_BATCH_IDX 
   	ON HOMEPAGE.IMG_CACHE (LAST_REQUEST_DATE ASC, NUM_REQUEST ASC, FILE_PATH, IMG_CACHE_ID);
GO

-- NR_AS_COUNTS

ALTER TABLE HOMEPAGE.NR_AS_COUNTS ALTER COLUMN CREATION_DATE DATETIME2(3) NOT NULL;
ALTER TABLE HOMEPAGE.NR_AS_COUNTS ALTER COLUMN UPDATE_DATE DATETIME2(3) NOT NULL;
GO

-- NR_CUSTOM_LIST

ALTER TABLE HOMEPAGE.NR_CUSTOM_LIST ALTER COLUMN CREATION_TIME DATETIME2(3) NOT NULL;
ALTER TABLE HOMEPAGE.NR_CUSTOM_LIST ALTER COLUMN UPDATE_TIME DATETIME2(3) NOT NULL;
GO

-- NR_CUSTOM_LIST_ITEM 

DROP INDEX NR_CUSTOM_LIST_ITEM_CRTIME_IDX ON HOMEPAGE.NR_CUSTOM_LIST_ITEM;
GO

ALTER TABLE HOMEPAGE.NR_CUSTOM_LIST_ITEM ALTER COLUMN CREATION_TIME DATETIME2(3) NOT NULL;
ALTER TABLE HOMEPAGE.NR_CUSTOM_LIST_ITEM ALTER COLUMN UPDATE_TIME DATETIME2(3) NOT NULL;
GO

CREATE INDEX NR_CUSTOM_LIST_ITEM_CRTIME_IDX
	ON HOMEPAGE.NR_CUSTOM_LIST_ITEM (CREATION_TIME);	
GO

-- NR_READ_STATUS 

ALTER TABLE HOMEPAGE.NR_READ_STATUS ALTER COLUMN CREATION_DATE DATETIME2(3) NOT NULL;
GO

-- NR_ENTRIES_ROLLUP_ACTION

DROP INDEX ENTR_ROLLUP_ACT_CDATE_IDX ON HOMEPAGE.NR_ENTRIES_ROLLUP_ACTION;
DROP INDEX ENTR_ROLLUP_ACT_UDATE_IDX ON HOMEPAGE.NR_ENTRIES_ROLLUP_ACTION;
GO

ALTER TABLE HOMEPAGE.NR_ENTRIES_ROLLUP_ACTION ALTER COLUMN CREATION_DATE DATETIME2(3) NOT NULL;
ALTER TABLE HOMEPAGE.NR_ENTRIES_ROLLUP_ACTION ALTER COLUMN UPDATE_DATE DATETIME2(3) NOT NULL;
GO

CREATE INDEX ENTR_ROLLUP_ACT_CDATE_IDX 
	ON HOMEPAGE.NR_ENTRIES_ROLLUP_ACTION (CREATION_DATE DESC);
CREATE INDEX ENTR_ROLLUP_ACT_UDATE_IDX 
	ON HOMEPAGE.NR_ENTRIES_ROLLUP_ACTION (UPDATE_DATE DESC);
GO

-- NR_ENTRIES_ROLLUP_PERSON

DROP INDEX ENTR_ROLLUP_PER_CDATE_IDX ON HOMEPAGE.NR_ENTRIES_ROLLUP_PERSON;
DROP INDEX ENTR_ROLLUP_PER_UDATE_IDX ON HOMEPAGE.NR_ENTRIES_ROLLUP_PERSON;
DROP INDEX ENTR_ROLLUP_PER_ENTRUDATE_IDX ON HOMEPAGE.NR_ENTRIES_ROLLUP_PERSON;
GO

ALTER TABLE HOMEPAGE.NR_ENTRIES_ROLLUP_PERSON ALTER COLUMN CREATION_DATE DATETIME2(3) NOT NULL;
ALTER TABLE HOMEPAGE.NR_ENTRIES_ROLLUP_PERSON ALTER COLUMN UPDATE_DATE DATETIME2(3) NOT NULL;
GO

CREATE INDEX ENTR_ROLLUP_PER_CDATE_IDX 
	ON HOMEPAGE.NR_ENTRIES_ROLLUP_PERSON (CREATION_DATE DESC);
CREATE INDEX ENTR_ROLLUP_PER_UDATE_IDX 
	ON HOMEPAGE.NR_ENTRIES_ROLLUP_PERSON (UPDATE_DATE DESC);
CREATE INDEX ENTR_ROLLUP_PER_ENTRUDATE_IDX 
	ON HOMEPAGE.NR_ENTRIES_ROLLUP_PERSON (ENTRY_ROLLUP_ACTION_ID, UPDATE_DATE DESC);
GO

-- L3T_COMPANIES

ALTER TABLE HOMEPAGE.L3T_COMPANIES ALTER COLUMN CREATED DATETIME2(3) NOT NULL;
ALTER TABLE HOMEPAGE.L3T_COMPANIES ALTER COLUMN MODIFIED DATETIME2(3) NOT NULL;
GO

-- L3T_USERS

ALTER TABLE HOMEPAGE.L3T_USERS ALTER COLUMN LOGGED_IN_TIME DATETIME2(3) NOT NULL;
ALTER TABLE HOMEPAGE.L3T_USERS ALTER COLUMN CREATED DATETIME2(3) NOT NULL;
ALTER TABLE HOMEPAGE.L3T_USERS ALTER COLUMN MODIFIED DATETIME2(3) NOT NULL;
GO

-- L3T_PACKAGES

ALTER TABLE HOMEPAGE.L3T_PACKAGES ALTER COLUMN CREATED DATETIME2(3) NOT NULL;
ALTER TABLE HOMEPAGE.L3T_PACKAGES ALTER COLUMN MODIFIED DATETIME2(3) NOT NULL;
GO

-- L3T_COMPANY_ENTITLEMENTS

ALTER TABLE HOMEPAGE.L3T_COMPANY_ENTITLEMENTS ALTER COLUMN CREATED DATETIME2(3) NOT NULL;
ALTER TABLE HOMEPAGE.L3T_COMPANY_ENTITLEMENTS ALTER COLUMN MODIFIED DATETIME2(3) NOT NULL;
GO

-- L3T_COMPANY_PKG_PREFS

ALTER TABLE HOMEPAGE.L3T_COMPANY_PKG_PREFS ALTER COLUMN CREATED DATETIME2(3) NOT NULL;
ALTER TABLE HOMEPAGE.L3T_COMPANY_PKG_PREFS ALTER COLUMN MODIFIED DATETIME2(3) NOT NULL;
GO

-- L3T_USER_ENTITLEMENTS

ALTER TABLE HOMEPAGE.L3T_USER_ENTITLEMENTS ALTER COLUMN CREATED DATETIME2(3) NOT NULL;
ALTER TABLE HOMEPAGE.L3T_USER_ENTITLEMENTS ALTER COLUMN MODIFIED DATETIME2(3) NOT NULL;
GO

-- L3T_USER_PKG_PREFS

ALTER TABLE HOMEPAGE.L3T_USER_PKG_PREFS ALTER COLUMN CREATED DATETIME2(3) NOT NULL;
ALTER TABLE HOMEPAGE.L3T_USER_PKG_PREFS ALTER COLUMN MODIFIED DATETIME2(3) NOT NULL;
GO

